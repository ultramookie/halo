import{A as q,y as ne,M as lt,u as de,h as M,s as A,a as re,b as Je,p as gt,c as Ve,q as st,g as yt,d as e,k as O,T as h,e as ke,f as Et,i as Cn,j as _e,L as mo,C as On,D as go,m as bo,n as Kn,o as Wt,r as pe,t as vo,v as Ue,w as _n,x as xi,_ as wt,z as hs,B as vd,E as fs,F as ps,G as yo,H as wo,I as at,J as ko,K as oi,N as So,O as bt,P as Co,Q as _o,R as ci,S as Mt,U as Qe,V as ms,W as gs,X as Io,Y as sn,Z as xo,$ as To,a0 as zn,a1 as Bn,a2 as Ao,a3 as Ti,a4 as Ro,a5 as Eo,a6 as Mo,a7 as ai,a8 as Ke,a9 as Lo,aa as $o,ab as Po,ac as Do}from"./useTitle-CCJyj9GW.js";import{u as ri,a as He,s as me,o as Ai,b as No,J as bs,c as vs,I as x,C as li,d as ys,M as Ye,e as Ze,S as rn,f as Se,g as Mn,R as It,n as ot,h as qe,A as ft,N as mt,i as rt,j as ut,L as be,l as At,k as ws,m as et,t as Ri,p as wd,q as it,r as zt,v as ht,w as Zn,x as ks,E as Ss,y as Xe,z as Ei,T as Cs,B as pt,D as di,F as je,G as _t,H as Oo,K as zo,O as Dt,P as ui,Q as _s,U as Bo,V as jt,W as Uo,X as Fo,Y as Is,Z as Ho,_ as Nt,$ as qo,a0 as xs,a1 as Yo,a2 as Ts,a3 as jo,a4 as Vo,a5 as Go,a6 as Ko,a7 as Zo,a8 as Mi,a9 as Wo,aa as Ft}from"./ScheduledAtField-C8V8wCav.js";var As=Xo;function Xo(n,i,s){var o=null,c=null,r=function(){o&&(clearTimeout(o),c=null,o=null)},u=function(){var d=c;r(),d&&d()},l=function(){if(!i)return n.apply(this,arguments);var d=this,a=arguments,m=s&&!o;if(r(),c=function(){n.apply(d,a)},o=setTimeout(function(){if(o=null,!m){var b=c;return c=null,b()}},i),m)return c()};return l.cancel=r,l.flush=u,l}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,i){"use strict";typeof n.CustomEvent!="function"&&(n.CustomEvent=function(p,f){f=f||{bubbles:!1,cancelable:!1,detail:void 0};var v=i.createEvent("CustomEvent");return v.initCustomEvent(p,f.bubbles,f.cancelable,f.detail),v},n.CustomEvent.prototype=n.Event.prototype),i.addEventListener("touchstart",m,!1),i.addEventListener("touchmove",b,!1),i.addEventListener("touchend",a,!1);var s=null,o=null,c=null,r=null,u=null,l=null,d=0;function a(p){if(l===p.target){var f=parseInt(g(l,"data-swipe-threshold","20"),10),v=g(l,"data-swipe-unit","px"),y=parseInt(g(l,"data-swipe-timeout","500"),10),w=Date.now()-u,C="",S=p.changedTouches||p.touches||[];if(v==="vh"&&(f=Math.round(f/100*i.documentElement.clientHeight)),v==="vw"&&(f=Math.round(f/100*i.documentElement.clientWidth)),Math.abs(c)>Math.abs(r)?Math.abs(c)>f&&w<y&&(c>0?C="swiped-left":C="swiped-right"):Math.abs(r)>f&&w<y&&(r>0?C="swiped-up":C="swiped-down"),C!==""){var k={dir:C.replace(/swiped-/,""),touchType:(S[0]||{}).touchType||"direct",fingers:d,xStart:parseInt(s,10),xEnd:parseInt((S[0]||{}).clientX||-1,10),yStart:parseInt(o,10),yEnd:parseInt((S[0]||{}).clientY||-1,10)};l.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:k})),l.dispatchEvent(new CustomEvent(C,{bubbles:!0,cancelable:!0,detail:k}))}s=null,o=null,u=null}}function m(p){p.target.getAttribute("data-swipe-ignore")!=="true"&&(l=p.target,u=Date.now(),s=p.touches[0].clientX,o=p.touches[0].clientY,c=0,r=0,d=p.touches.length)}function b(p){if(!(!s||!o)){var f=p.touches[0].clientX,v=p.touches[0].clientY;c=s-f,r=o-v}}function g(p,f,v){for(;p&&p!==i.documentElement;){var y=p.getAttribute(f);if(y)return y;p=p.parentNode}return v}})(window,document);function Vt(n=()=>{},i=[]){const s=q(n);ne(()=>{s.current=n},[i]),ne(()=>{const o=()=>{const c=document.hidden||document.visibilityState==="hidden";s.current(!c)};return document.addEventListener("visibilitychange",o),()=>document.removeEventListener("visibilitychange",o)},[])}const Jo=1e3*3,Li=2e4,Qo=lt(function({isLoggedIn:i}){const{_:s}=de(),[o,c]=M(!0),r=q();Vt(a=>{clearTimeout(r.current),a?c(!0):r.current=setTimeout(()=>{c(!1)},Li)});const u=async(a,m,b)=>{var g;if(A.notificationsLast){const p=a.v1.notifications.list({limit:1,sinceId:A.notificationsLast.id}),{value:f}=await p.next();if(f!=null&&f.length)if(b)A.notificationsShowNew=!0;else{let v;try{const y=await a.v1.markers.fetch({timeline:"notifications"});v=(g=y==null?void 0:y.notifications)==null?void 0:g.lastReadId}catch{}v?A.notificationsShowNew=f[0].id!==v:A.notificationsShowNew=!0}}};ne(()=>{let a,m,b;if(i&&o){const{masto:g,streaming:p,instance:f}=re();(async()=>{await u(g,f);let v=!1;p&&(m=setTimeout(()=>{(async()=>{try{v=!0,a=p.user.notification.subscribe();for await(const y of a){if(!a||!o)break;y.event==="notification"&&Je(y.payload,f,{skipThreading:!0}),A.notificationsShowNew=!0}}catch{v=!1}v||(b=setInterval(()=>{u(g,f,!0)},Li))})()},Jo))})()}return()=>{var g;(g=a==null?void 0:a.unsubscribe)==null||g.call(a),a=null,clearTimeout(m),clearInterval(b)}},[o,i]);const l=q(),d=()=>{l.current=Date.now(),fetch("./version.json").then(a=>a.json()).then(a=>{a&&(A.appVersion=a)}).catch(a=>{})};return ri(d,o&&1e3*60*30),Vt(a=>{a&&(l.current?Date.now()-l.current>1e3*60*60&&d():d())}),He("shift+alt+k",()=>{const a=A.settings.cloakMode;A.settings.cloakMode=!a,me({text:s(a?{id:"oguMwa"}:{id:"IXZLPs"})})}),null}),ec=gt(async(n,i)=>{const s=n.v1.accounts.$select(i).statuses.list({limit:3,exclude_replies:!0,exclude_reblogs:!0}),{value:o}=await s.next();return o||[]},{maxAge:6e4});function tc(){const{_:n}=de(),i=Ve(A),{masto:s}=re(),[o,c]=M(!1),[r,u]=M([]),[l,d]=M(!1),a=q(null),m=q(null);function b(v){if(i.composerState.minimized){A.composerState.minimized=!1,Ai();return}v.shiftKey?No()||(A.showCompose=!0):(Ai(),A.showCompose=!0)}He("c, shift+c",b,{ignoreEventWhen:v=>!!document.querySelector("#modal-container > *")});const g=bs(()=>{c(!0)},{threshold:600}),p=st(async()=>{try{d(!0);const v=yt();if(!v)return;const y=await ec(s,v);u(y)}catch{}finally{d(!1)}},[s]),f=st(v=>{vs({replyToStatus:v}),c(!1)},[]);return ne(()=>{o&&p()},[p,o]),e(O,{children:[e("button",{ref:a,type:"button",id:"compose-button",onClick:b,onContextMenu:v=>{v.preventDefault(),c(!0)},...g(),class:`${i.composerState.minimized?"min":""} ${i.composerState.publishing?"loading":""} ${i.composerState.publishingError?"error":""}`,children:e(x,{icon:"quill",size:"xl",alt:n({id:"QOhkyl"})})}),e(li,{ref:m,state:o?"open":void 0,anchorRef:a,onClose:()=>c(!1),direction:"top",gap:8,unmountOnClose:!0,portal:{target:document.body},boundingBoxPadding:ys(),containerProps:{style:{zIndex:101},onClick:()=>{var v,y;(y=(v=m.current)==null?void 0:v.closeMenu)==null||y.call(v)}},submenuOpenDelay:600,children:[e(Ye,{to:"/sp",children:[e(x,{icon:"schedule"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(Ze,{}),e(rn,{align:"end",direction:"top",shift:-8,disabled:l||r.length===0,label:e(O,{children:[e(x,{icon:"comment"})," ",e("span",{className:"menu-grow",children:e(h,{id:"LwOr4P"})}),l?"…":e(x,{icon:"chevron-right"})]}),children:r.length>0&&r.map(v=>{const y=new Date(v.createdAt),w=new Date().getTime()-y.getTime()<864e5;return e(Se,{onClick:()=>f(v),children:e("small",{children:[e("div",{class:"menu-post-text",children:Mn(v)}),e("span",{className:"more-insignificant",children:[w&&e(O,{children:[e(It,{datetime:y,format:"micro"})," ","‒"," "]}),e("time",{className:"created",dateTime:y.toISOString(),title:y.toLocaleString(),children:ot(v.createdAt)})]})]})},v.id)})})]})]})}const nc=lt(function(){const{_:i}=de(),s=Ve(A);function o(){A.showKeyboardShortcutsHelp=!1}return He("?, shift+?, shift+slash",c=>{A.showKeyboardShortcutsHelp=!0},{ignoreEventWhen:c=>/\/catchup/i.test(location.hash)}),!!s.showKeyboardShortcutsHelp&&e(qe,{onClose:o,children:e("div",{id:"keyboard-shortcuts-help-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"77Emn0"})})}),e("main",{children:e("table",{children:e("tbody",{children:[{action:i({id:"ulXSNi"}),keys:e("kbd",{children:"?"})},{action:i({id:"Gy9P9T"}),keys:e("kbd",{children:"j"})},{action:i({id:"6XYpYY"}),keys:e("kbd",{children:"k"})},{action:i({id:"DYowFe"}),keys:e(h,{id:"mzjGX4",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"S5ez7Y"}),keys:e(h,{id:"Fd8FaU",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"VkLESX"}),keys:e("kbd",{children:"."})},{action:i({id:"jsFF8C"}),keys:e(h,{id:"80sOCm",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:e(h,{id:"41gejM",components:{0:e("br",{})}}),keys:e("kbd",{children:"x"})},{action:i({id:"jAj8rv"}),keys:e(h,{id:"evz6c6",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"duF1lx"}),keys:e(h,{id:"nhpsIN",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"YrR3Co"}),keys:e("kbd",{children:"]"})},{action:i({id:"noxAFR"}),keys:e("kbd",{children:"["})},{action:i({id:"AIa/f7"}),keys:e("kbd",{children:"c"})},{action:i({id:"snPx8X"}),className:"insignificant",keys:e(h,{id:"+Cxvld",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"1pKapz"}),keys:e(h,{id:"py67WT",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{}),3:e("kbd",{})}})},{action:i({id:"A1taO8"}),keys:e("kbd",{children:"/"})},{action:i({id:"ImOQa9"}),keys:e("kbd",{children:"r"})},{action:i({id:"KFs8c6"}),className:"insignificant",keys:e(h,{id:"XpQLJF",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"cqi4Mx"}),keys:e(h,{id:"84WuL2",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"kulphB"}),keys:e(h,{id:"yrz6Ck",components:{0:e("kbd",{}),1:e("kbd",{})}})},{action:i({id:"PZlHt8"}),keys:e("kbd",{children:"d"})},{action:i({id:"C7ujRh"}),keys:e(h,{id:"v4TbMP",components:{0:e("kbd",{}),1:e("kbd",{}),2:e("kbd",{})}})}].map(({action:c,className:r,keys:u})=>e("tr",{children:[e("th",{class:r,children:c}),e("td",{children:u})]},c))})})})]})})}),Rs=new Set,ct=new WeakMap,Gt=new WeakMap,Ot=new WeakMap,Wn=new WeakMap,ic=new WeakMap,Kt=new WeakMap,In=new WeakMap,tn=new WeakSet;let Rt,hi=0,fi=0;const St="__aa_tgt",on="__aa_del",xn="__aa_new",sc=n=>{const i=dc(n);i&&i.forEach(s=>uc(s))},oc=n=>{n.forEach(i=>{i.target===Rt&&ac(),ct.has(i.target)&&Bt(i.target)})};function cc(n){const i=Wn.get(n);i==null||i.disconnect();let s=ct.get(n),o=0;const c=5;s||(s=Zt(n),ct.set(n,s));const{offsetWidth:r,offsetHeight:u}=Rt,d=[s.top-c,r-(s.left+c+s.width),u-(s.top+c+s.height),s.left-c].map(m=>`${-1*Math.floor(m)}px`).join(" "),a=new IntersectionObserver(()=>{++o>1&&Bt(n)},{root:Rt,threshold:1,rootMargin:d});a.observe(n),Wn.set(n,a)}function Bt(n){clearTimeout(In.get(n));const i=Ln(n),s=cn(i)?500:i.duration;In.set(n,setTimeout(async()=>{const o=Ot.get(n);try{await(o==null?void 0:o.finished),ct.set(n,Zt(n)),cc(n)}catch{}},s))}function ac(){clearTimeout(In.get(Rt)),In.set(Rt,setTimeout(()=>{Rs.forEach(n=>$s(n,i=>Es(()=>Bt(i))))},100))}function rc(n){setTimeout(()=>{ic.set(n,setInterval(()=>Es(Bt.bind(null,n)),2e3))},Math.round(2e3*Math.random()))}function Es(n){typeof requestIdleCallback=="function"?requestIdleCallback(()=>n()):requestAnimationFrame(()=>n())}let Xn,Yt;const lc=typeof window<"u"&&"ResizeObserver"in window;lc&&(Rt=document.documentElement,Xn=new MutationObserver(sc),Yt=new ResizeObserver(oc),window.addEventListener("scroll",()=>{fi=window.scrollY,hi=window.scrollX}),Yt.observe(Rt));function dc(n){return n.reduce((o,c)=>[...o,...Array.from(c.addedNodes),...Array.from(c.removedNodes)],[]).every(o=>o.nodeName==="#comment")?!1:n.reduce((o,c)=>{if(o===!1)return!1;if(c.target instanceof Element){if(Un(c.target),!o.has(c.target)){o.add(c.target);for(let r=0;r<c.target.children.length;r++){const u=c.target.children.item(r);if(u){if(on in u)return!1;Un(c.target,u),o.add(u)}}}if(c.removedNodes.length)for(let r=0;r<c.removedNodes.length;r++){const u=c.removedNodes[r];if(on in u)return!1;u instanceof Element&&(o.add(u),Un(c.target,u),Gt.set(u,[c.previousSibling,c.nextSibling]))}}return o},new Set)}function Un(n,i){!i&&!(St in n)?Object.defineProperty(n,St,{value:n}):i&&!(St in i)&&Object.defineProperty(i,St,{value:n})}function uc(n){var i;const s=n.isConnected,o=ct.has(n);s&&Gt.has(n)&&Gt.delete(n),Ot.has(n)&&((i=Ot.get(n))===null||i===void 0||i.cancel()),xn in n?$i(n):o&&s?fc(n):o&&!s?pc(n):$i(n)}function vt(n){return Number(n.replace(/[^0-9.\-]/g,""))}function hc(n){let i=n.parentElement;for(;i;){if(i.scrollLeft||i.scrollTop)return{x:i.scrollLeft,y:i.scrollTop};i=i.parentElement}return{x:0,y:0}}function Zt(n){const i=n.getBoundingClientRect(),{x:s,y:o}=hc(n);return{top:i.top+o,left:i.left+s,width:i.width,height:i.height}}function Ms(n,i,s){let o=i.width,c=i.height,r=s.width,u=s.height;const l=getComputedStyle(n);if(l.getPropertyValue("box-sizing")==="content-box"){const a=vt(l.paddingTop)+vt(l.paddingBottom)+vt(l.borderTopWidth)+vt(l.borderBottomWidth),m=vt(l.paddingLeft)+vt(l.paddingRight)+vt(l.borderRightWidth)+vt(l.borderLeftWidth);o-=m,r-=m,c-=a,u-=a}return[o,r,c,u].map(Math.round)}function Ln(n){return St in n&&Kt.has(n[St])?Kt.get(n[St]):{duration:250,easing:"ease-in-out"}}function Ls(n){if(St in n)return n[St]}function pi(n){const i=Ls(n);return i?tn.has(i):!1}function $s(n,...i){i.forEach(s=>s(n,Kt.has(n)));for(let s=0;s<n.children.length;s++){const o=n.children.item(s);o&&i.forEach(c=>c(o,Kt.has(o)))}}function mi(n){return Array.isArray(n)?n:[n]}function cn(n){return typeof n=="function"}function fc(n){const i=ct.get(n),s=Zt(n);if(!pi(n))return ct.set(n,s);let o;if(!i)return;const c=Ln(n);if(typeof c!="function"){const r=i.left-s.left,u=i.top-s.top,[l,d,a,m]=Ms(n,i,s),b={transform:`translate(${r}px, ${u}px)`},g={transform:"translate(0, 0)"};l!==d&&(b.width=`${l}px`,g.width=`${d}px`),a!==m&&(b.height=`${a}px`,g.height=`${m}px`),o=n.animate([b,g],{duration:c.duration,easing:c.easing})}else{const[r]=mi(c(n,"remain",i,s));o=new Animation(r),o.play()}Ot.set(n,o),ct.set(n,s),o.addEventListener("finish",Bt.bind(null,n))}function $i(n){xn in n&&delete n[xn];const i=Zt(n);ct.set(n,i);const s=Ln(n);if(!pi(n))return;let o;if(typeof s!="function")o=n.animate([{transform:"scale(.98)",opacity:0},{transform:"scale(0.98)",opacity:0,offset:.5},{transform:"scale(1)",opacity:1}],{duration:s.duration*1.5,easing:"ease-in"});else{const[c]=mi(s(n,"add",i));o=new Animation(c),o.play()}Ot.set(n,o),o.addEventListener("finish",Bt.bind(null,n))}function Pi(n,i){var s;n.remove(),ct.delete(n),Gt.delete(n),Ot.delete(n),(s=Wn.get(n))===null||s===void 0||s.disconnect(),setTimeout(()=>{if(on in n&&delete n[on],Object.defineProperty(n,xn,{value:!0,configurable:!0}),i&&n instanceof HTMLElement)for(const o in i)n.style[o]=""},0)}function pc(n){var i;if(!Gt.has(n)||!ct.has(n))return;const[s,o]=Gt.get(n);Object.defineProperty(n,on,{value:!0,configurable:!0});const c=window.scrollX,r=window.scrollY;if(o&&o.parentNode&&o.parentNode instanceof Element?o.parentNode.insertBefore(n,o):s&&s.parentNode?s.parentNode.appendChild(n):(i=Ls(n))===null||i===void 0||i.appendChild(n),!pi(n))return Pi(n);const[u,l,d,a]=gc(n),m=Ln(n),b=ct.get(n);(c!==hi||r!==fi)&&mc(n,c,r,m);let g,p={position:"absolute",top:`${u}px`,left:`${l}px`,width:`${d}px`,height:`${a}px`,margin:"0",pointerEvents:"none",transformOrigin:"center",zIndex:"100"};if(!cn(m))Object.assign(n.style,p),g=n.animate([{transform:"scale(1)",opacity:1},{transform:"scale(.98)",opacity:0}],{duration:m.duration,easing:"ease-out"});else{const[f,v]=mi(m(n,"remove",b));(v==null?void 0:v.styleReset)!==!1&&(p=(v==null?void 0:v.styleReset)||p,Object.assign(n.style,p)),g=new Animation(f),g.play()}Ot.set(n,g),g.addEventListener("finish",Pi.bind(null,n,p))}function mc(n,i,s,o){const c=hi-i,r=fi-s,u=document.documentElement.style.scrollBehavior;if(getComputedStyle(Rt).scrollBehavior==="smooth"&&(document.documentElement.style.scrollBehavior="auto"),window.scrollTo(window.scrollX+c,window.scrollY+r),!n.parentElement)return;const d=n.parentElement;let a=d.clientHeight,m=d.clientWidth;const b=performance.now();function g(){requestAnimationFrame(()=>{if(!cn(o)){const p=a-d.clientHeight,f=m-d.clientWidth;b+o.duration>performance.now()?(window.scrollTo({left:window.scrollX-f,top:window.scrollY-p}),a=d.clientHeight,m=d.clientWidth,g()):document.documentElement.style.scrollBehavior=u}})}g()}function gc(n){const i=ct.get(n),[s,,o]=Ms(n,i,Zt(n));let c=n.parentElement;for(;c&&(getComputedStyle(c).position==="static"||c instanceof HTMLBodyElement);)c=c.parentElement;c||(c=document.body);const r=getComputedStyle(c),u=ct.get(c)||Zt(c),l=Math.round(i.top-u.top)-vt(r.borderTopWidth),d=Math.round(i.left-u.left)-vt(r.borderLeftWidth);return[l,d,s,o]}function Ps(n,i={}){return Xn&&Yt&&(window.matchMedia("(prefers-reduced-motion: reduce)").matches&&!cn(i)&&!i.disrespectUserMotionPreference||(tn.add(n),getComputedStyle(n).position==="static"&&Object.assign(n.style,{position:"relative"}),$s(n,Bt,rc,c=>Yt==null?void 0:Yt.observe(c)),cn(i)?Kt.set(n,i):Kt.set(n,{duration:250,easing:"ease-in-out",...i}),Xn.observe(n,{childList:!0}),Rs.add(n))),Object.freeze({parent:n,enable:()=>{tn.add(n)},disable:()=>{tn.delete(n)},isEnabled:()=>tn.has(n)})}function gi(n){const i=q(null),[s,o]=M(),c=r=>{s&&(r?s.enable():s.disable())};return ne(()=>{i.current instanceof HTMLElement&&o(Ps(i.current,n||{}))},[]),[i,c]}const bc=window.matchMedia("(display-mode: standalone)").matches;function vc({onClose:n}){const{_:i}=de(),{masto:s}=re(),o=ke.local.getJSON("accounts"),c=yt(),r=o.length>1,[u,l]=Et(a=>a+1,0),[d]=gi();return e("div",{id:"accounts-container",class:"sheet",tabIndex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:e("h2",{children:e(h,{id:"bPwFdf"})})}),e("main",{children:e("section",{children:[e("ul",{class:"accounts-list",ref:d,children:o.map((a,m)=>{const b=a.info.id===c,g=m===0;return e("li",{children:[e("div",{children:[r&&e("span",{class:`current ${b?"is-current":""}`,children:e(x,{icon:"check-circle",alt:i({id:"Hp1l6f"})})}),e(ft,{url:a.info.avatarStatic,size:"xxl",onDblClick:async()=>{if(b)try{const p=await s.v1.accounts.$select(a.info.id).fetch();a.info=p,ke.local.setJSON("accounts",o),l()}catch{}}}),e(mt,{account:r?{...a.info,acct:/@/.test(a.info.acct)?a.info.acct:`${a.info.acct}@${a.instanceURL}`}:a.info,showAcct:!0,onClick:()=>{b?A.showAccount=`${a.info.username}@${a.instanceURL}`:(Cn(a.info.id),location.reload())}})]}),e("div",{class:"actions",children:[g&&r&&e(O,{children:[e("span",{class:"tag",children:e(h,{id:"ovBPCi"})})," "]}),e(rt,{align:"end",menuButton:e("button",{type:"button",class:"plain more-button",children:e(x,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[r&&e(O,{children:[e(Se,{disabled:b,onClick:()=>{Cn(a.info.id),location.reload()},children:[e(x,{icon:"transfer"})," ",e(h,{id:"3t/Nrv"})]}),!bc&&!b&&e(Ye,{href:`./?account=${a.info.id}`,target:"_blank",children:[e(x,{icon:"external"}),e("span",{children:e(h,{id:"PZgZtY"})})]}),e(Ze,{})]}),e(Se,{onClick:()=>{A.showAccount=`${a.info.username}@${a.instanceURL}`},children:[e(x,{icon:"user"}),e("span",{children:e(h,{id:"40z2Fm"})})]}),e(Ze,{}),r&&e(Se,{disabled:g,onClick:()=>{o.splice(m,1),o.unshift(a),ke.local.setJSON("accounts",o),l()},children:[e(x,{icon:"check-circle"}),e("span",{children:e(h,{id:"PPcets"})})]}),e(ut,{subMenu:!0,confirmLabel:e(O,{children:[e(x,{icon:"exit"}),e("span",{children:e(h,{id:"k08LxG",values:{0:a.info.acct},components:{0:e("span",{class:"bidi-isolate"})}})})]}),disabled:!b,menuItemClassName:"danger",onClick:()=>{o.splice(m,1),ke.local.setJSON("accounts",o),location.href=location.pathname||"/"},children:[e(x,{icon:"exit"}),e("span",{children:e(h,{id:"CXk1bI"})})]})]})]})]},a.info.id)})}),e("p",{children:e(be,{to:"/login",class:"button plain2",onClick:n,children:[e(x,{icon:"plus"})," ",e("span",{children:e(h,{id:"Is7/PB"})})]})}),r&&e("p",{children:e("small",{children:e(h,{id:"52x24e",components:{0:e("i",{})}})})})]})})]})}const bi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%2064%2064'%3e%3cpath%20fill='none'%20d='M0%200h63.994v63.994H0z'/%3e%3cpath%20fill='%23a4bff7'%20d='M37.774%2011.471c14.639%203.752%2019.034%2016.557%2015.889%2031.304-.696%203.261-2.563%206.661-6.356%208.693-3.204%201.717-8.07%202.537-15.338.55l-9.634-2.404C11.651%2046.992%208.378%2038.733%2010.027%2031.823c3.627-15.201%2015.543-23.48%2027.747-20.352Z'/%3e%3cpath%20fill='%23d8e7fe'%20d='M36.76%2015.429c12.289%203.15%2015.547%2014.114%2012.907%2026.493-.947%204.44-4.937%209.365-16.664%206.143l-9.684-2.417c-7.854-1.923-10.53-7.8-9.318-12.877%203.016-12.639%2012.611-19.943%2022.759-17.342Z'/%3e%3cpath%20fill='%236081e6'%20d='M27.471%2024.991c-1.457-.698-7.229%203.213-7.663%208.926-.182%202.39%204.55%203.237%205.071-.169.725-4.743%203.715-8.218%202.592-8.757Zm10.746%202.005c-2.083.327-.382%205.901-.595%2010.727-.123%202.8%204.388%203.464%204.703%202.011%201.098-5.073-2.066-13.058-4.108-12.738Z'/%3e%3c/svg%3e",yc={"zh-CN":"zh-Hans","zh-TW":"zh-Hant","pt-BR":"pt-BR"};function vi(){const{i18n:n}=de(),i=_e(()=>mo.map(s=>{var u,l;const o=yc[s]||s.replace(/-[a-z]+$/i,""),c=At({code:o,locale:s,fallback:(u=On.find(d=>d.code===s))==null?void 0:u.nativeName}),r=At({code:o,locale:n.locale,fallback:(l=On.find(d=>d.code===s))==null?void 0:l.name});return{code:s,regionlessCode:o,_common:r,native:c}}).sort((s,o)=>{const c=s._common.localeCompare(o._common,n.locale);return c!==0?c:s.code<o.code?-1:s.code>o.code?1:0}),[]);return e("label",{class:"lang-selector",children:["🌐"," ",e("select",{class:"small",value:n.locale||go,onChange:s=>{ke.local.set("lang",s.target.value),bo(s.target.value)},children:[i.map(({code:s,regionlessCode:o,native:c})=>{var l;const r=At({code:o,locale:n.locale,fallback:(l=On.find(d=>d.code===s))==null?void 0:l.name});return e("option",{value:s,"data-regionless-code":o,children:!!r&&r!==c?`${c} - ${r}`:c},s)}),void 0]})]})}function Di(n){const{masto:i}=re();return i.v1.push.subscription.create(n)}function wc(){const{masto:n}=re();return n.v1.push.subscription.fetch()}function kc(n){const{masto:i}=re();return i.v1.push.subscription.update(n)}function Sc(){const{masto:n}=re();return n.v1.push.subscription.remove()}function $n(){return"serviceWorker"in navigator&&"PushManager"in window}function Cc(){return navigator.serviceWorker.getRegistration()}async function yi(){const n=await Cc(),i=n?await n.pushManager.getSubscription():void 0;return{registration:n,subscription:i}}function Ds(n){const i="=".repeat((4-n.length%4)%4),s=`${n}${i}`.replace(/-/g,"+").replace(/_/g,"/"),o=window.atob(s),c=new Uint8Array(o.length);for(let r=0;r<o.length;++r)c[r]=o.charCodeAt(r);return c}async function _c(){if(!$n())return;const{subscription:n}=await yi();let i=null;try{i=await wc()}catch(s){if(!/(not found|unknown)/i.test(s.message))throw s}if(i&&n){const s=i.endpoint===n.endpoint,o=Kn(),c=i.serverKey===o;if(!s)throw new Error("Backend subscription endpoint changed");if(!c)throw new Error("Backend subscription key and vapid key changed")}if(n&&!i){const s=Kn();if(s){const{applicationServerKey:o}=n.options,c=Ds(s).toString(),r=new Uint8Array(o).toString();if(!(c===r))throw await n.unsubscribe(),new Error("Subscription key and vapid key changed")}}return{subscription:n,backendSubscription:i}}async function Ni({data:n,policy:i}){if(!$n())return;let{registration:s,subscription:o}=await yi(),c=null;if(o)try{c=await kc({data:n,policy:i})}catch{c=await Di({subscription:o,data:n,policy:i})}else{const r=Kn();if(!r)throw new Error("No server key found");o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ds(r)}),c=await Di({subscription:o,data:n,policy:i})}return{subscription:o,backendSubscription:c}}async function Oi(){if(!$n())return;const{subscription:n}=await yi();n&&(await Sc(),await n.unsubscribe())}const Ic={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},zi=16,Pt=[14,15,16,17,18,19,20],{PHANPY_WEBSITE:Bi,PHANPY_PRIVACY_POLICY_URL:xc,PHANPY_IMG_ALT_API_URL:Tc,PHANPY_GIPHY_API_KEY:Ac}=Ic;function Rc({onClose:n}){const{_:i}=de(),s=Ve(A),o=ke.local.get("theme")||"auto",c=q(),r=s.settings.contentTranslationTargetLanguage||null,u=ws(),l=At(u),d=ke.local.get("textSize")||zi,[a,m]=M(ke.account.get("preferences")||{}),{masto:b,authenticated:g,instance:p}=re();return e("div",{id:"settings-container",class:"sheet",tabIndex:"-1",style:{"--current-text-size":`${d}px`},children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"Tz0i8g"})})}),e("main",{children:[e("section",{children:e("ul",{children:[e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"aAIQg2"})})}),e("div",{children:e("form",{ref:c,onInput:f=>{f.preventDefault();const y=new FormData(c.current).get("theme"),w=document.documentElement;if(y==="auto"){w.classList.remove("is-light","is-dark");const C=document.querySelector('meta[data-theme-setting="manual"]');C&&(C.name=""),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(k=>{k.name="theme-color"})}else{w.classList.toggle("is-light",y==="light"),w.classList.toggle("is-dark",y==="dark");const C=document.querySelector('meta[data-theme-setting="manual"]');C&&(C.name="theme-color",C.content=y==="light"?C.dataset.themeLightColor:C.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(k=>{k.name=""})}document.querySelector('meta[name="color-scheme"]').setAttribute("content",y==="auto"?"dark light":y),y==="auto"?ke.local.del("theme"):ke.local.set("theme",y)},children:e("div",{class:"radio-group",children:[e("label",{children:[e("input",{type:"radio",name:"theme",value:"light",defaultChecked:o==="light"}),e("span",{children:e(h,{id:"1njn7W"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"dark",defaultChecked:o==="dark"}),e("span",{children:e(h,{id:"pvnfJD"})})]}),e("label",{children:[e("input",{type:"radio",name:"theme",value:"auto",defaultChecked:o!=="light"&&o!=="dark"}),e("span",{children:e(h,{id:"R9Khdg"})})]})]})})})]}),e("li",{children:[e("div",{children:e("label",{children:e(h,{id:"7r6sCa"})})}),e("div",{class:"range-group",children:[e("span",{style:{fontSize:Pt[0]},children:e(h,{id:"J6ypuD"})})," ",e("input",{type:"range",min:Pt[0],max:Pt[Pt.length-1],step:"1",value:d,list:"sizes",onChange:f=>{const v=parseInt(f.target.value,10);document.documentElement.style.setProperty("--text-size",`${v}px`),v===zi?ke.local.del("textSize"):ke.local.set("textSize",f.target.value)}})," ",e("span",{style:{fontSize:Pt[Pt.length-1]},children:e(h,{id:"J6ypuD"})}),e("datalist",{id:"sizes",children:Pt.map(f=>e("option",{value:f}))})]})]}),e("li",{children:[e("span",{children:[e("label",{children:e(h,{id:"CeJHfb"})}),e("br",{}),e("small",{children:e("a",{href:"https://crowdin.com/project/phanpy",target:"_blank",rel:"noopener",children:e(h,{id:"FFmj1D"})})})]}),e(vi,{})]})]})}),g&&e(O,{children:[e("h3",{children:e(h,{id:"PcoS3v"})}),e("section",{children:e("ul",{children:e("li",{children:[e("div",{children:e("label",{for:"posting-privacy-field",children:[e(h,{id:"NAjVvt"})," ",e(x,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})]})}),e("div",{children:e("select",{id:"posting-privacy-field",value:a["posting:default:visibility"]||"public",onChange:f=>{const{value:v}=f.target;(async()=>{try{await b.v1.accounts.updateCredentials({source:{privacy:v}}),m({...a,"posting:default:visibility":v}),ke.account.set("preferences",{...a,"posting:default:visibility":v})}catch{alert(i({id:"Oa+KBY"}))}})()},children:[e("option",{value:"public",children:e(h,{id:"7d1a0d"})}),e("option",{value:"unlisted",children:e(h,{id:"WDcQq9"})}),e("option",{value:"private",children:e(h,{id:"o34OrG"})})]})})]})})}),e("p",{class:"section-postnote",children:[e(x,{icon:"cloud",alt:i({id:"N2FcBE"}),class:"synced-icon"})," ",e("small",{children:e(h,{id:"xlsg7n",values:{instance:p},components:{0:e("a",{href:`https://${p}/`,target:"_blank",rel:"noopener"})}})})]})]}),e("h3",{children:e(h,{id:"ivdhsq"})}),e("section",{children:e("ul",{children:[e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.autoRefresh,onChange:f=>{A.settings.autoRefresh=f.target.checked}})," ",e(h,{id:"0mC0SF"})]})}),e("li",{class:"block",children:e("label",{children:[e("input",{type:"checkbox",checked:s.settings.boostsCarousel,onChange:f=>{A.settings.boostsCarousel=f.target.checked}})," ",e(h,{id:"TSbnoW"})]})}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslation,onChange:f=>{const{checked:v}=f.target;A.settings.contentTranslation=v,v||(A.settings.contentTranslationTargetLanguage=null)}})," ",e(h,{id:"0SdaOt"})]}),e("div",{class:`sub-section ${s.settings.contentTranslation?"":"more-insignificant"}`,children:[e("div",{children:e("label",{children:[e(h,{id:"zXCa9e"})," ",e("select",{value:r||"",disabled:!s.settings.contentTranslation,style:{width:"10em"},onChange:f=>{A.settings.contentTranslationTargetLanguage=f.target.value||null},children:[e("option",{value:"",children:e(h,{id:"jNCSyx",values:{systemTargetLanguageText:l}})}),e("option",{disabled:!0,children:"──────────"}),Ri.map(f=>{const v=At({code:f.code,fallback:f.name}),y=At({code:f.code,locale:f.code}),w=v!==y;return e("option",{value:f.code,children:w?`${y} - ${v}`:v})})]})]})}),e("hr",{}),e("div",{class:"checkbox-fieldset",children:[e(h,{id:"cc0NrU",values:{0:s.settings.contentTranslationHideLanguages.length}}),e("div",{class:"checkbox-fields",children:Ri.map(f=>{const v=At({code:f.code,fallback:f.name}),y=At({code:f.code,locale:f.code}),w=v!==y;return e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationHideLanguages.includes(f.code),onChange:C=>{const{checked:S}=C.target;S?A.settings.contentTranslationHideLanguages.push(f.code):A.settings.contentTranslationHideLanguages=s.settings.contentTranslationHideLanguages.filter(k=>k!==f.code)}})," ",w?e("span",{children:[y," ",e("span",{class:"insignificant",children:["- ",v]})]}):v]})})})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"xpF+wU",components:{0:e("a",{href:"https://github.com/cheeaun/lingva-api",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://github.com/thedaviddelta/lingva-translate",target:"_blank",rel:"noopener"})}})})}),e("hr",{}),e("div",{children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.contentTranslationAutoInline,disabled:!s.settings.contentTranslation,onChange:f=>{A.settings.contentTranslationAutoInline=f.target.checked}})," ",e(h,{id:"gURvmk"})]}),e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"PbHARL",components:{0:e("b",{})}})})})]})]})]}),!!Ac&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.composerGIFPicker,onChange:f=>{A.settings.composerGIFPicker=f.target.checked}})," ",e(h,{id:"D7/2jB"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"/CLBTL",components:{0:e("a",{href:"https://developers.giphy.com/",target:"_blank",rel:"noopener"})}})})})]}),!!Tc&&g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.mediaAltGenerator,onChange:f=>{A.settings.mediaAltGenerator=f.target.checked}})," ",e(h,{id:"9q5uor"})," ",e(x,{icon:"sparkles2",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"faZ9RI"})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHZgvt",components:{0:e("a",{href:"https://github.com/cheeaun/img-alt-api",target:"_blank",rel:"noopener"})}})})})]}),g&&et("@mastodon/grouped-notifications")&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.groupedNotificationsAlpha,onChange:f=>{A.settings.groupedNotificationsAlpha=f.target.checked}})," ",e(h,{id:"aGziA/"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"X17jCM"})})})]}),g&&e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.shortcutSettingsCloudImportExport,onChange:f=>{A.settings.shortcutSettingsCloudImportExport=f.target.checked}})," ",e(h,{id:"570qTm"})," ",e(x,{icon:"cloud",class:"more-insignificant"})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"0tZAhT",components:{0:e("br",{})}})})}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"fHf1v/"})})})]}),e("li",{class:"block",children:[e("label",{children:[e("input",{type:"checkbox",checked:s.settings.cloakMode,onChange:f=>{A.settings.cloakMode=f.target.checked}})," ",e(h,{id:"lxYe+I",components:{0:e("span",{class:"insignificant"}),1:e("samp",{}),2:e("samp",{})}})]}),e("div",{class:"sub-section insignificant",children:e("small",{children:e(h,{id:"T/hglb"})})})]}),g&&e("li",{children:e("button",{type:"button",class:"light",onClick:()=>{A.showDrafts=!0,A.showSettings=!1},children:e(h,{id:"krk5ws"})})})]})}),g&&e(Ec,{onClose:n}),e("h3",{children:e(h,{id:"uyJsf6"})}),e("section",{children:[e("div",{style:{display:"flex",flexWrap:"wrap",gap:8,lineHeight:1.25,alignItems:"center",marginTop:8},children:[e("img",{src:bi,alt:"",width:"64",height:"64",style:{aspectRatio:"1/1",verticalAlign:"middle",background:"#b7cdf9",borderRadius:12}}),e("div",{children:[e("b",{children:"Phanpy"})," ",e("a",{href:"https://hachyderm.io/@phanpy",rel:"noopener",onClick:f=>{f.preventDefault(),A.showAccount="phanpy@hachyderm.io"},children:"@phanpy"}),e("br",{}),e(h,{id:"AZ2EoP",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank",rel:"noopener"}),1:e("a",{href:"https://mastodon.social/@cheeaun",rel:"noopener",onClick:f=>{f.preventDefault(),A.showAccount="cheeaun@mastodon.social"}})}})]})]}),e("p",{children:[e("a",{href:"https://github.com/sponsors/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"O4cLCR"})})," ","·"," ",e("a",{href:"https://www.buymeacoffee.com/cheeaun",target:"_blank",rel:"noopener",children:e(h,{id:"Ng063n"})})," ","·"," ",e("a",{href:"https://patreon.com/cheeaun",target:"_blank",rel:"noopener",children:"Patreon"})," ","·"," ",e("a",{href:xc,target:"_blank",rel:"noopener",children:e(h,{id:"LcET2C"})})]}),e("p",{children:[Bi&&e(O,{children:[e(h,{id:"pFnMHn",values:{0:Bi.replace(/https?:\/\//g,"").replace(/\/$/,"")},components:{0:e("span",{class:"insignificant"})}}),e("br",{})]}),e(h,{id:"6KkH+2",values:{0:e("span",{class:"ib insignificant",children:["(",e("a",{href:"https://github.com/cheeaun/phanpy/commit/649de8ca",target:"_blank",rel:"noopener",children:e(It,{datetime:new Date("2025-05-03T17:27:52.567Z")})}),")"]})},components:{0:e("span",{class:"insignificant"}),1:e("input",{type:"text",class:"version-string",readOnly:!0,size:"18",value:`${"2025-05-03T17:27:52.567Z".slice(0,10).replace(/-/g,".")}.649de8ca`,onClick:f=>{f.target.select();try{navigator.clipboard.writeText(f.target.value),me(i({id:"PiPfua"}))}catch{me(i({id:"gdxreD"}))}}})}})]})]}),void 0]})]})}function Ec({onClose:n}){const{_:i}=de();if(!$n())return null;const{instance:s}=re(),[o,c]=M("default"),r=q(),[u,l]=M(!1),[d,a]=M(!1),m=q();ne(()=>{(async()=>{c("loading");try{const{subscription:g,backendSubscription:p}=await _c();if(p!=null&&p.policy&&p.policy!=="none"){l(!0);const{alerts:f,policy:v}=p;m.current=v;const{elements:y}=r.current,w=y.namedItem("policy");w&&(w.value=v),Object.entries(f).forEach(([C,S])=>{const k=y.namedItem(C);(k==null?void 0:k.type)==="checkbox"&&(k.checked=!!S)})}c("default")}catch(g){/outside.*authorized/i.test(g.message)?a(!0):alert((g==null?void 0:g.message)||g),c("error")}})()},[]);const b=o==="loading";return e("form",{ref:r,onChange:()=>{setTimeout(()=>{const g=Object.fromEntries(new FormData(r.current)),p=!!g["policy-allow"],f={data:{policy:g.policy,alerts:{mention:!!g.mention,favourite:!!g.favourite,reblog:!!g.reblog,follow:!!g.follow,follow_request:!!g.followRequest,poll:!!g.poll,update:!!g.update,status:!!g.status}}};let v=0;Object.keys(f.data.alerts).forEach(w=>{f.data.alerts[w]?v++:delete f.data.alerts[w]});const y=m.current!==f.data.policy;p&&v>0?y?Oi().then(()=>{Ni(f)}).catch(w=>{alert(i({id:"I6pdY3"}))}):Ni(f).catch(w=>{alert(i({id:"I6pdY3"}))}):Oi().catch(w=>{alert(i({id:"q1zFd+"}))})},100)},children:[e("h3",{children:e(h,{id:"WUHLnz"})}),e("section",{children:e("ul",{children:e("li",{children:[e("label",{children:[e("input",{type:"checkbox",disabled:b||d,name:"policy-allow",checked:u,onChange:async g=>{const{checked:p}=g.target;if(p){const f=await Notification.requestPermission();f==="granted"?l(!0):(l(!1),f==="denied"&&alert(i({id:"6LUsk7"})))}else l(!1)}})," ",e(h,{id:"qYNCa1",values:{0:[{value:"all",label:i({id:"+niKJH"})},{value:"followed",label:i({id:"x2NYtp"})},{value:"follower",label:i({id:"PBFNgg"})}].map(g=>e("option",{value:g.value,children:g.label}))},components:{0:e("select",{name:"policy",disabled:b||d||!u})}})]}),e("div",{class:"shazam-container no-animation",style:{width:"100%"},hidden:!u,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"sub-section",children:e("ul",{children:[{value:"mention",label:i({id:"/bZzdR"})},{value:"favourite",label:i({id:"zZOZj7"})},{value:"reblog",label:i({id:"puY2t0"})},{value:"follow",label:i({id:"aaJhcT"})},{value:"followRequest",label:i({id:"6Fs1Ba"})},{value:"poll",label:i({id:"wNExRS"})},{value:"update",label:i({id:"K/EtE6"})},{value:"status",label:i({id:"2yr1/p"})}].map(g=>e("li",{children:e("label",{children:[e("input",{type:"checkbox",name:g.value})," ",g.label]})}))})})})}),d&&e("div",{class:"sub-section",children:e("p",{children:e(h,{id:"8d0b8B",components:{0:e(be,{to:`/login?instance=${s}`,onClick:n}),1:e("b",{})}})})})]})})}),e("p",{class:"section-postnote",children:e("small",{children:e(h,{id:"z96cOX",components:{0:e("b",{})}})})})]})}const Jn=()=>{let n=setTimeout(()=>{var s,o;const i=document.getElementById("columns");if(i){const c=i.querySelector(".deck-container.focus");if(c)c.focus();else{const r=Array.from(i.querySelectorAll(".deck-container")).find(u=>u.getBoundingClientRect().left>=0);r?r.focus():(o=(s=i.querySelector(".deck-container"))==null?void 0:s.focus)==null||o.call(s)}}else{const c=document.querySelectorAll("#modal-container > *");if(c!=null&&c.length){const d=c[c.length-1],a=d.querySelector('[tabindex="-1"]')||d;if(a){a.focus();return}}if(document.querySelector(".deck-backdrop"))return;const u=document.querySelectorAll(".deck-container"),l=u[u.length-1];l&&l.tabIndex===-1&&l.focus()}},100);return()=>clearTimeout(n)};function Ns(n){if(!n)return;const i=Wt(),s=q(i.pathname);ne(()=>{s.current&&i.pathname!==s.current&&(n==null||n())},[i.pathname,n])}const Os=1e3*60,Mc=24*60*60*1e3,Qn=gt(async()=>{const{masto:n}=re(),i=await n.v1.lists.list();return i.sort((s,o)=>s.title.localeCompare(o.title)),i.length&&setTimeout(()=>{ke.account.set("lists",{lists:i,updatedAt:Date.now()})},1),i},{maxAge:Os});async function ln(){try{const{lists:n,updatedAt:i}=ke.account.get("lists")||{};return n!=null&&n.length?(Date.now()-i>Mc&&Qn(),n):await Qn()}catch{return[]}}const Lc=gt(n=>{const{masto:i}=re();return i.v1.lists.$select(n).fetch()},{maxAge:Os});async function zs(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.find(o=>o.id===n);if(s)return s}try{return Lc(n)}catch{return null}}async function $c(n){const i=await zs(n);return(i==null?void 0:i.title)||""}function Pc(n){const{lists:i}=ke.account.get("lists")||{};i!=null&&i.length&&(i.push(n),i.sort((s,o)=>s.title.localeCompare(o.title)),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}function Dc(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n.id);s!==-1&&(i[s]=n,i.sort((o,c)=>o.title.localeCompare(c.title)),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function Nc(n){const{lists:i}=ke.account.get("lists")||{};if(i!=null&&i.length){const s=i.findIndex(o=>o.id===n);s!==-1&&(i.splice(s,1),ke.account.set("lists",{lists:i,updatedAt:Date.now()}))}}function wi({list:n,onClose:i}){const{_:s}=de(),{masto:o}=re(),[c,r]=M("default"),u=!!n,l=q(),d=q(),a=q();ne(()=>{u&&(l.current.value=n.title,d.current.value=n.repliesPolicy,a.current&&(a.current.checked=n.exclusive))},[u]);const m=et("@mastodon/list-exclusive")||et("@gotosocial/list-exclusive");return e("div",{class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(x,{icon:"x",alt:s({id:"yz7wBu"})})})," ",e("header",{children:e("h2",{children:s(u?{id:"tuhghE"}:{id:"Sb2gYF"})})}),e("main",{children:e("form",{class:"list-form",onSubmit:b=>{b.preventDefault();const g=new FormData(b.target),p=g.get("title"),f=g.get("replies_policy"),v=g.get("exclusive")==="on";r("loading"),(async()=>{try{let y;u?y=await o.v1.lists.$select(n.id).update({title:p,replies_policy:f,exclusive:v}):y=await o.v1.lists.create({title:p,replies_policy:f,exclusive:v}),r("default"),i==null||i({state:"success",list:y}),setTimeout(()=>{u?Dc(y):Pc(y)},1)}catch{r("error"),alert(s(u?{id:"R7ep1i"}:{id:"KPoj8w"}))}})()},children:[e("div",{class:"list-form-row",children:e("label",{for:"list-title",children:[e(h,{id:"6YtxFj"})," ",e("input",{ref:l,type:"text",id:"list-title",name:"title",required:!0,disabled:c==="loading",dir:"auto"})]})}),e("div",{class:"list-form-row",children:e("select",{ref:d,name:"replies_policy",required:!0,disabled:c==="loading",children:[e("option",{value:"list",children:e(h,{id:"ei6pnR"})}),e("option",{value:"followed",children:e(h,{id:"Mr53YX"})}),e("option",{value:"none",children:e(h,{id:"PM7llw"})})]})}),m&&e("div",{class:"list-form-row",children:e("label",{class:"label-block",children:[e("input",{ref:a,type:"checkbox",name:"exclusive",disabled:c==="loading"})," ",e(h,{id:"jxxYp0"})]})}),e("div",{class:"list-form-footer",children:[e("button",{type:"submit",disabled:c==="loading",children:s(u?{id:"tfDRzk"}:{id:"hYgDIe"})}),u&&e(ut,{disabled:c==="loading",align:"end",menuItemClassName:"danger",confirmLabel:s({id:"+kQ/cY"}),onClick:()=>{r("loading"),(async()=>{try{await o.v1.lists.$select(n.id).remove(),r("default"),i==null||i({state:"deleted"}),setTimeout(()=>{Nc(n.id)},1)}catch{r("error"),alert(s({id:"tqUaGL"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:c==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}const Oc=[60*5,60*30,60*60,60*60*6,60*60*24,60*60*24*3,60*60*24*7,60*60*24*30,0],Ht={0:{id:"9ZP9cc"},300:it(5,"minute"),1800:it(30,"minute"),3600:it(1,"hour"),21600:it(6,"hour"),86400:it(1,"day"),259200:it(3,"day"),604800:it(1,"week"),2592e3:it(30,"day")},Ui=80,Bs=1e3*60*10;function zc(n,i){return i.v1.accounts.familiarFollowers.fetch({id:[n]})}const Bc=gt(zc,{maxAge:Bs});async function Uc(n,i){const s=i.v1.accounts.$select(n).statuses.list({limit:20}).next(),{value:o}=await s,c={total:o.length,originals:0,replies:0,boosts:0};return o.forEach(r=>{r.reblog?c.boosts++:r.inReplyToId&&r.inReplyToAccountId!==r.account.id?c.replies++:c.originals++}),o.length&&(c.daysSinceLastPost=Math.ceil((Date.now()-new Date(o[o.length-1].createdAt))/864e5)),c}const Fc=gt(Uc,{maxAge:Bs});function Us({account:n,fetchAccount:i=()=>{},standalone:s,instance:o,authenticated:c}){const{i18n:r,_:u}=de(),{masto:l}=re({instance:o}),{masto:d,instance:a}=re(),[m,b]=M("default"),g=typeof n=="string",[p,f]=M(g?null:n),v=_e(()=>o===a,[o,a]);ne(()=>{if(!g){f(n);return}b("loading"),(async()=>{try{const H=await i();A.accounts[`${H.id}@${o}`]=H,f(H),b("default")}catch{f(null),b("error")}})()},[g,n,i]);const{acct:y,avatar:w,avatarStatic:C,bot:S,createdAt:k,displayName:T,emojis:_,fields:I,followersCount:R,followingCount:L,group:z,id:P,lastStatusAt:Z,locked:ee,note:W,statusesCount:V,url:B,username:F,memorial:se,moved:$,roles:U,hideCollections:Y}=p||{};let G=!1,{header:te,headerStatic:ae}=p||{};(!te||/missing\.png$/.test(te))&&w&&!/missing\.png$/.test(w)&&(te=w,G=!0,C&&!/missing\.png$/.test(C)&&(ae=C));const ye=_e(()=>P===yt(),[P]);ne(()=>{const H=!!(p!=null&&p.id&&(p!=null&&p.username)&&(p!=null&&p.acct)&&(p!=null&&p.avatar)&&(p!=null&&p.avatarStatic)&&(p!=null&&p.displayName)&&(p!=null&&p.url));if(ye&&o&&H){const ve=ke.local.getJSON("accounts");let Re=!1;ve.forEach(E=>{E.info.id===p.id&&E.instanceURL===o&&(E.info=p,Re=!0)}),Re&&ke.local.setJSON("accounts",ve)}},[ye,p,o]);const Ce=_e(()=>B?zt.toUnicode(URL.parse(B).hostname):null,[B]),[j,he]=M([]),Te=q(),Pe=q([]);async function De(H){var K;(H||!Te.current)&&(Te.current=l.v1.accounts.$select(P).followers.list({limit:Ui}));const ve=await Te.current.next();if(ye||!v)return ve;const{value:Re}=ve;let E=[];if(H){let ce=[];try{ce=await l.v1.accounts.familiarFollowers.fetch({id:[P]})}catch{}Pe.current=((K=ce==null?void 0:ce[0])==null?void 0:K.accounts)||[],E=[...Pe.current,...Re.filter(J=>!Pe.current.some(oe=>oe.id===J.id))]}else Re!=null&&Re.length&&(E=Re.filter(ce=>!Pe.current.some(J=>J.id===ce.id)));return{...ve,value:E}}const Be=q();async function Ee(H){return(H||!Be.current)&&(Be.current=l.v1.accounts.$select(P).following.list({limit:Ui})),await Be.current.next()}const Me=s?"div":be,X=o?`/${o}/a/${P}`:`/a/${P}`,[Ie,Ne]=M([]),[fe,Q]=M(),[ge,N]=M("default"),ie=!!(fe!=null&&fe.total),ue=async H=>{try{const ve=await Bc(H,d);Ne(ve[0].accounts.slice(0,Hc))}catch{}},D=async()=>{if(P){N("loading");try{const H=await Fc(P,l);Q(H),N("default")}catch{N("error")}}},le=st(({relationship:H,currentID:ve})=>{H.following||(ue(ve),!s&&V>0&&D())},[s,P,V]),xe=st(H=>{H.id===P&&(f(H),A.accounts[`${H.id}@${o}`]=H)},[P,o]);return e("div",{tabIndex:"-1",class:`account-container ${m==="loading"?"skeleton":""}`,style:{"--header-color-1":j[0],"--header-color-2":j[1],"--header-color-3":j[2],"--header-color-4":j[3]},children:[m==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"44hICK"})}),g?e("p",{children:e("code",{class:"insignificant",children:n})}):e("p",{children:e("a",{href:B,target:"_blank",rel:"noopener",children:[e(h,{id:"Aadw0+"})," ",e(x,{icon:"external"})]})})]}),m==="loading"?e(O,{children:[e("header",{children:e(ht,{avatarSize:"xxxl",skeleton:!0})}),e("main",{children:[e("div",{class:"note",children:[e("p",{children:"███████ ████ ████"}),e("p",{children:"████ ████████ ██████ █████████ ████ ██"})]}),e("div",{class:"account-metadata-box",children:[e("div",{class:"profile-metadata",children:[e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"███"}),e("p",{children:"██████"})]}),e("div",{class:"profile-field",children:[e("b",{class:"more-insignificant",children:"████"}),e("p",{children:"███████████"})]})]}),e("div",{class:"stats",children:[e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"x5LEuB"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"following.stats"})]}),e("div",{children:[e("span",{children:"██"})," ",e(h,{id:"+owNNn"})]})]})]}),e("div",{class:"actions",children:[e("span",{}),e("span",{class:"buttons",children:e("button",{type:"button",class:"plain",disabled:!0,children:e(x,{icon:"more",size:"l",alt:u({id:"2FYpfJ"})})})})]})]})]}):p&&e(O,{children:[!!$&&e("div",{class:"account-moved",children:[e("p",{children:e(h,{id:"C6cVP/",values:{displayName:T},components:{0:e("b",{})}})}),e(ht,{account:$,instance:o,onClick:H=>{H.stopPropagation(),A.showAccount=$}})]}),!!te&&!/missing\.png$/.test(te)&&e("img",{src:te,alt:"",class:`header-banner ${G?"header-is-avatar":""}`,onError:H=>{H.target.crossOrigin?H.target.src!==ae?H.target.src=ae:(H.target.removeAttribute("crossorigin"),H.target.src=te):H.target.src!==ae?H.target.src=ae:H.target.remove()},crossOrigin:"anonymous",onLoad:H=>{H.target.classList.add("loaded");try{const ve=window.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas"),Re=ve.getContext("2d",{willReadFrequently:!0});ve.width=H.target.width,ve.height=H.target.height,Re.imageSmoothingEnabled=!1,Re.drawImage(H.target,0,0);const E=10,ce=[Re.getImageData(0,0,E,E).data,Re.getImageData(H.target.width-E,0,E,E).data,Re.getImageData(0,H.target.height-E,E,E).data,Re.getImageData(H.target.width-E,H.target.height-E,E,E).data].map(J=>{let oe=0,Oe=0,Le=0,$e=0;for(let Ge=0;Ge<J.length;Ge+=4)oe+=J[Ge],Oe+=J[Ge+1],Le+=J[Ge+2],$e+=J[Ge+3];const Fe=J.length/4;return[oe/Fe,Oe/Fe,Le/Fe,$e/Fe]}).map(J=>{const[oe,Oe,Le,$e]=Yc(J);return`rgba(${oe}, ${Oe}, ${Le}, ${$e})`});he(ce)}catch{}}}),e("header",{children:s?e(rt,{shift:window.matchMedia("(min-width: calc(40em))").matches?114:64,menuButton:e("div",{children:e(ht,{account:p,instance:o,avatarSize:"xxxl",onClick:()=>{}})}),children:[e("div",{class:"szh-menu__header",children:e(Jc,{acct:y,instance:o})}),e(Se,{onClick:()=>{const H=y.includes("@")?`@${y}`:`@${y}@${o}`;try{navigator.clipboard.writeText(H),me(u({id:"zJoEwS"}))}catch{me(u({id:"BC0lSD"}))}},children:[e(x,{icon:"link"}),e("span",{children:e(h,{id:"27x6gl"})})]}),e(Se,{href:B,target:"_blank",children:[e(x,{icon:"external"}),e("span",{children:e(h,{id:"Bz5hLl"})})]}),e(Ze,{}),e(Se,{onClick:()=>{A.showMediaModal={mediaAttachments:[{type:"image",url:C}]}},children:[e(x,{icon:"user"}),e("span",{children:e(h,{id:"7WYl2I"})})]}),e(Se,{onClick:()=>{A.showMediaModal={mediaAttachments:[{type:"image",url:ae}]}},children:[e(x,{icon:"media"}),e("span",{children:e(h,{id:"ZNme5R"})})]})]}):e(ht,{account:p,instance:o,avatarSize:"xxxl",internal:!0})}),e("div",{class:"faux-header-bg","aria-hidden":"true"}),e("main",{children:[!!se&&e("span",{class:"tag",children:e(h,{id:"prdIOK"})}),!!S&&e("span",{class:"tag",children:[e(x,{icon:"bot"})," ",e(h,{id:"9Vdq+j"})]}),!!z&&e("span",{class:"tag",children:[e(x,{icon:"group"})," ",e(h,{id:"L8fEEm"})]}),U==null?void 0:U.map(H=>e("span",{class:"tag",children:[H.name,!!Ce&&e(O,{children:[" ",e("span",{class:"more-insignificant",children:Ce})]})]})),e("div",{class:"note",dir:"auto",onClick:ks({instance:a}),dangerouslySetInnerHTML:{__html:Zn(W,{emojis:_})}}),e("div",{class:"account-metadata-box",children:[(I==null?void 0:I.length)>0&&e("div",{class:"profile-metadata",children:I.map(({name:H,value:ve,verifiedAt:Re},E)=>e("div",{class:`profile-field ${Re?"profile-verified":""}`,dir:"auto",children:[e("b",{children:[e(Ss,{text:H,emojis:_})," ",!!Re&&e(x,{icon:"check-circle",size:"s",alt:u({id:"QDEWii"})})]}),e("p",{dangerouslySetInnerHTML:{__html:Zn(ve,{emojis:_})}})]},H+E))}),e("div",{class:"stats",children:[e(Me,{tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{A.showGenericAccounts={id:"followers",heading:u({id:"x5LEuB"}),fetchAccounts:De,instance:o,excludeRelationshipAttrs:ye?["followedBy"]:[],blankCopy:Y?u({id:"BRV/wh"}):void 0}},0)},children:[!!Ie.length&&e("span",{class:"shazam-container-horizontal",children:e("span",{class:"shazam-container-inner stats-avatars-bunch",children:Ie.map(H=>e(ft,{url:H.avatarStatic,size:"s",alt:`${H.displayName} @${H.acct}`,squircle:H==null?void 0:H.bot}))})}),e("span",{title:R,children:Xe(R)})," ",e(h,{id:"x5LEuB"})]}),e(Me,{class:"insignificant",tabIndex:0,to:X,onClick:()=>{setTimeout(()=>{A.showGenericAccounts={heading:u({id:"following.stats"}),fetchAccounts:Ee,instance:o,excludeRelationshipAttrs:ye?["following"]:[],blankCopy:Y?u({id:"BRV/wh"}):void 0}},0)},children:[e("span",{title:L,children:Xe(L)})," ",e(h,{id:"following.stats"}),e("br",{})]}),e(Me,{class:"insignificant",to:X,children:[e("span",{title:V,children:Xe(V)})," ",e(h,{id:"+owNNn"})]}),!!k&&e("div",{class:"insignificant",children:e(h,{id:"PCcEFZ",values:{0:ot(k,{hideTime:!0})},components:{0:e("time",{datetime:k})}})})]})]}),!!fe&&e(Me,{to:X,class:"account-metadata-box",children:e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:ie?e("div",{class:"posting-stats",title:u({id:"wiuWLe",values:{0:(fe.originals/fe.total).toLocaleString(r.locale||void 0,{style:"percent"}),1:(fe.replies/fe.total).toLocaleString(r.locale||void 0,{style:"percent"}),2:(fe.boosts/fe.total).toLocaleString(r.locale||void 0,{style:"percent"})}}),children:[e("div",{children:fe.daysSinceLastPost<365?pe._({id:"oZUtTk",values:{0:fe.total,1:fe.daysSinceLastPost,2:fe.daysSinceLastPost,3:fe.daysSinceLastPost,4:fe.total,5:fe.total,6:fe.daysSinceLastPost}}):pe._({id:"JvA7Mo",values:{0:fe.total,1:fe.total}})}),e("div",{class:"posting-stats-bar",style:{"--originals-percentage":`${fe.originals/fe.total*100}%`,"--replies-percentage":`${(fe.originals+fe.replies)/fe.total*100}%`}}),e("div",{class:"posting-stats-legends",children:[e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-originals"})," ",e(h,{id:"HxF6Fk"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-replies"})," ",e(h,{id:"N8UzTV"})]})," ",e("span",{class:"ib",children:[e("span",{class:"posting-stats-legend-item posting-stats-legend-item-boosts"})," ",e(h,{id:"puY2t0"})]})]})]}):e("div",{class:"posting-stats",children:e(h,{id:"vl3XTJ"})})})})}),!$&&e("div",{class:"account-metadata-box",children:e("div",{class:"shazam-container no-animation",hidden:!!fe,children:e("div",{class:"shazam-container-inner",children:e("button",{type:"button",class:"posting-stats-button",disabled:ge==="loading",onClick:()=>{D()},children:[e("div",{class:`posting-stats-bar posting-stats-icon ${ge==="loading"?"loading":""}`,style:{"--originals-percentage":"33%","--replies-percentage":"66%"}}),e(h,{id:"PjP87f"})," "]})})})})]}),e("footer",{children:e(qc,{info:p,instance:o,standalone:s,authenticated:c,onRelationshipChange:le,onProfileUpdate:xe})})]})]})}const Hc=3;function qc({info:n,instance:i,standalone:s,authenticated:o,onRelationshipChange:c=()=>{},onProfileUpdate:r=()=>{}}){var fe;if(!n)return null;const{_:u,_:l}=de(),{masto:d,instance:a,authenticated:m}=re(),b=i===a,[g,p]=M("default"),[f,v]=M(null),{id:y,acct:w,url:C,username:S,locked:k,lastStatusAt:T,note:_,fields:I,moved:R}=n,L=q(y),{following:z,showingReblogs:P,notifying:Z,followedBy:ee,blocking:W,blockedBy:V,muting:B,mutingNotifications:F,requested:se,domainBlocking:$,endorsed:U,note:Y}=f||{},[G,te]=M(null),[ae,ye]=M(!1),Ce=w.includes("@")?w:`${w}@${i}`;ne(()=>{if(n){const Q=yt();let ge;(async()=>{if(b&&o)ge=y;else if(!b&&m){const ie=n.acct.includes("@");try{const ue=await d.v2.search.fetch({q:ie?n.acct:`${n.username}@${i}`,type:"accounts",limit:1,resolve:!0});ue.accounts.length&&(ge=ue.accounts[0].id,te(ue.accounts[0]))}catch{}}if(!ge)return;if(Q===ge){ye(!0);return}L.current=ge,p("loading");const N=d.v1.accounts.relationships.fetch({id:[ge]});try{const ie=await N;if(p("default"),ie.length){const ue=ie[0];v(ue),c({relationship:ue,currentID:ge})}}catch{p("error")}})()}},[n,o]),ne(()=>{n&&ae&&vo(n)},[n,ae]);const j=g==="loading",[he,Te]=M(!1),[Pe,De]=M(!1),[Be,Ee]=M(!1),[Me,X]=M(!1),[Ie,Ne]=M([]);return e(O,{children:[e("div",{class:"actions",children:[e("span",{children:[ee?e("span",{class:"tag",children:e(h,{id:"p3UO/y"})}):T?e("small",{class:"insignificant",children:e(h,{id:"F3cM1G",values:{0:ot(T,{hideTime:!0})},components:{0:e("span",{class:"ib"})}})}):e("span",{}),B&&e("span",{class:"tag danger",children:e(h,{id:"+IJm1Z"})}),W&&e("span",{class:"tag danger",children:e(h,{id:"32TndD"})})]})," ",e("span",{class:"buttons",children:[!!Y&&e("button",{type:"button",class:"private-note-tag",title:l({id:"zxFxcH"}),onClick:()=>{Ee(!0)},dir:"auto",children:e("span",{children:Y})}),e(rt,{portal:{target:document.body},containerProps:{style:{zIndex:1001}},align:"center",position:"anchor",overflow:"auto",menuButton:e("button",{type:"button",class:"plain",disabled:j,children:e(x,{icon:"more",size:"l",alt:l({id:"2FYpfJ"})})}),onMenuChange:Q=>{z&&Q.open&&(async()=>{try{const ge=await d.v1.accounts.$select(L.current).lists.list();Ne(ge)}catch{}})()},children:[m&&!ae&&e(O,{children:[e(Se,{onClick:()=>{vs({draftStatus:{status:`@${(G==null?void 0:G.acct)||w} `}})},children:[e(x,{icon:"at"}),e("span",{children:e(h,{id:"3LkfZu",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),e(Se,{onClick:()=>{Te(!0)},children:[e(x,{icon:"translate"}),e("span",{children:e(h,{id:"R8mSiS"})})]}),et("@mastodon/profile-private-note")&&e(Se,{onClick:()=>{Ee(!0)},children:[e(x,{icon:"pencil"}),e("span",{children:l(Y?{id:"U+Gokq"}:{id:"VcQzRi"})})]}),z&&!!f&&e(O,{children:[e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select(L.current).follow({notify:!Z});Q&&v(Q),p("default"),me(Q.notifying?l({id:"jL3N0G",values:{username:S}}):l({id:"0h4/9h",values:{username:S}}))}catch(Q){alert(Q),p("error")}})()},children:[e(x,{icon:"notification"}),e("span",{children:l(Z?{id:"osJmEN"}:{id:"I92Z+b"})})]}),e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select(L.current).follow({reblogs:!P});Q&&v(Q),p("default"),me(Q.showingReblogs?l({id:"0X2KC8",values:{username:S}}):l({id:"cXWjH0",values:{username:S}}))}catch(Q){alert(Q),p("error")}})()},children:[e(x,{icon:"rocket"}),e("span",{children:l(P?{id:"GRUr8d"}:{id:"uREpT3"})})]})]}),z&&e(Se,{onClick:()=>{De(!0)},children:[e(x,{icon:"list"}),Ie.length?e(O,{children:[e("small",{class:"menu-grow",children:[e(h,{id:"sJ2yQc"}),e("br",{}),e("span",{class:"more-insignificant",children:Ie.map(Q=>Q.title).join(", ")})]}),e("small",{class:"more-insignificant",children:Ie.length})]}):e("span",{children:e(h,{id:"sJ2yQc"})})]}),e(Ze,{})]}),e(Se,{onClick:()=>{const Q=`@${(G==null?void 0:G.acct)||Ce}`;try{navigator.clipboard.writeText(Q),me(l({id:"zJoEwS"}))}catch{me(l({id:"BC0lSD"}))}},children:[e(x,{icon:"copy"}),e("small",{children:[e(h,{id:"27x6gl"}),e("br",{}),e("span",{class:"more-insignificant bidi-isolate",children:["@",(G==null?void 0:G.acct)||Ce]})]})]}),e(Se,{href:C,target:"_blank",children:[e(x,{icon:"external"}),e("small",{class:"menu-double-lines",children:jc(C)})]}),e("div",{class:"menu-horizontal",children:[e(Se,{onClick:()=>{try{navigator.clipboard.writeText(C),me(l({id:"edWbV6"}))}catch{me(l({id:"W1ewR0"}))}},children:[e(x,{icon:"link"}),e("span",{children:e(h,{id:"he3ygx"})})]}),(navigator==null?void 0:navigator.share)&&((fe=navigator==null?void 0:navigator.canShare)==null?void 0:fe.call(navigator,{url:C}))&&e(Se,{onClick:()=>{try{navigator.share({url:C})}catch{alert(l({id:"TtG3Uh"}))}},children:[e(x,{icon:"share"}),e("span",{children:e(h,{id:"LFKLqp"})})]})]}),!!f&&e(O,{children:[e(Ze,{}),B?e(Se,{onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||y).unmute();v(Q),p("default"),me(l({id:"B4Xkly",values:{username:S}})),A.reloadGenericAccounts.id="mute",A.reloadGenericAccounts.counter++}catch{p("error")}})()},children:[e(x,{icon:"unmute"}),e("span",{children:e(h,{id:"Q/HUhC",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(rn,{menuClassName:"menu-blur",openTrigger:"clickOnly",direction:"bottom",overflow:"auto",shift:16,label:e(O,{children:[e(x,{icon:"mute"}),e("span",{class:"menu-grow",children:e(h,{id:"xhPEH3",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})}),e("span",{style:{textOverflow:"clip"},children:[e(x,{icon:"time"}),e(x,{icon:"chevron-right"})]})]}),children:e("div",{class:"menu-wrap",children:Oc.map(Q=>e(Se,{onClick:()=>{p("loading"),(async()=>{try{const ge=await d.v1.accounts.$select((G==null?void 0:G.id)||y).mute({duration:Q});v(ge),p("default"),me(l({id:"/plB9m",values:{0:typeof Ht[Q]=="function"?Ht[Q]():u(Ht[Q]),username:S}})),A.reloadGenericAccounts.id="mute",A.reloadGenericAccounts.counter++}catch{p("error"),me(l({id:"vWGBjT",values:{username:S}}))}})()},children:typeof Ht[Q]=="function"?Ht[Q]():u(Ht[Q])}))})}),ee&&e(ut,{subMenu:!0,menuItemClassName:"danger",confirmLabel:e(O,{children:[e(x,{icon:"user-x"}),e("span",{children:e(h,{id:"unyq2W",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),onClick:()=>{p("loading"),(async()=>{try{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||y).removeFromFollowers();v(Q),p("default"),me(l({id:"AgkcM/",values:{username:S}})),A.reloadGenericAccounts.id="followers",A.reloadGenericAccounts.counter++}catch{p("error")}})()},children:[e(x,{icon:"user-x"}),e("span",{children:e(h,{id:"VCZ0OT"})})]}),e(ut,{subMenu:!0,confirm:!W,confirmLabel:e(O,{children:[e(x,{icon:"block"}),e("span",{children:e(h,{id:"aforS9",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}),itemProps:{className:"danger"},menuItemClassName:"danger",onClick:()=>{p("loading"),(async()=>{try{if(W){const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||y).unblock();v(Q),p("default"),me(l({id:"sI9N29",values:{username:S}}))}else{const Q=await d.v1.accounts.$select((G==null?void 0:G.id)||y).block();v(Q),p("default"),me(l({id:"uYcYzu",values:{username:S}}))}A.reloadGenericAccounts.id="block",A.reloadGenericAccounts.counter++}catch{p("error"),W?me(l({id:"0tG4wG",values:{username:S}})):me(l({id:"pA+qEx",values:{username:S}}))}})()},children:W?e(O,{children:[e(x,{icon:"unblock"}),e("span",{children:e(h,{id:"/3LJfX",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]}):e(O,{children:[e(x,{icon:"block"}),e("span",{children:e(h,{id:"JRswkR",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]})}),e(Se,{className:"danger",onClick:()=>{A.showReportModal={account:G||n}},children:[e(x,{icon:"flag"}),e("span",{children:e(h,{id:"qTJgpR",values:{username:S},components:{0:e("span",{class:"bidi-isolate"})}})})]})]}),m&&ae&&s&&et("@mastodon/profile-edit")&&e(O,{children:[e(Ze,{}),e(Se,{onClick:()=>{X(!0)},children:[e(x,{icon:"pencil"}),e("span",{children:e(h,{id:"9OpVZg"})})]})]}),!1]}),!f&&g==="loading"&&e(Ue,{abrupt:!0}),!!f&&!R&&e(ut,{confirm:z||se,confirmLabel:e("span",{children:l(se?{id:"e7qQIH"}:{id:"q4ucww",values:{1:n.acct||n.username}})}),menuItemClassName:"danger",align:"end",disabled:j,onClick:()=>{p("loading"),(async()=>{try{let Q;z||se?Q=await d.v1.accounts.$select(L.current).unfollow():Q=await d.v1.accounts.$select(L.current).follow(),Q&&v(Q),p("default")}catch(Q){alert(Q),p("error")}})()},children:e("button",{type:"button",class:`${z||se?"light swap":""}`,"data-swap-state":z||se?"danger":"",disabled:j,children:z?e(O,{children:[e("span",{children:e(h,{id:"y6sq5j"})}),e("span",{children:e(h,{id:"HKrBPX"})})]}):se?e(O,{children:[e("span",{children:e(h,{id:"Yx0Ud8"})}),e("span",{children:e(h,{id:"yTVtKs"})})]}):k?e(O,{children:[e(x,{icon:"lock"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]}):l({id:"MKEPCY"})})})]})]}),!!he&&e(qe,{onClose:()=>{Te(!1)},children:e(Vc,{note:_,fields:I,onClose:()=>Te(!1)})}),!!Pe&&e(qe,{onClose:()=>{De(!1)},children:e(Gc,{accountID:L.current,onClose:()=>De(!1)})}),!!Be&&e(qe,{onClose:()=>{Ee(!1)},children:e(Kc,{account:n,note:Y,onRelationshipChange:Q=>{v(Q)},onClose:()=>Ee(!1)})}),!!Me&&e(qe,{onClose:()=>{X(!1)},children:e(Wc,{onClose:({state:Q,account:ge}={})=>{X(!1),Q==="success"&&ge&&r(ge)}})})]})}function Yc([n,i,s]){const o=.2126*n+.7152*i+.0722*s;let c;return o>=220?c=1:o<=50?c=.1:c=o/255,c=Math.min(1,c),[n,i,s,c]}function jc(n){if(!n)return;const i=URL.parse(n),{host:s,pathname:o}=i,c=o.replace(/\/$/,"").replace(/^\//,"");return e(O,{children:[e("span",{class:"more-insignificant",children:[zt.toUnicode(s),"/"]}),e("wbr",{}),e("span",{children:c})]})}function Vc({note:n,fields:i,onClose:s}){const{_:o}=de(),c=(i==null?void 0:i.map(({name:u,value:l})=>`${u}
${Ei(l)}`).join(`

`))||"",r=Ei(n)+(c?`

${c}`:"");return e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close",onClick:s,children:e(x,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"9groMz"})})}),e("main",{children:[e("p",{style:{whiteSpace:"pre-wrap"},children:r}),e(Cs,{forceTranslate:!0,text:r})]})]})}function Gc({accountID:n,onClose:i}){const{_:s}=de(),{masto:o}=re(),[c,r]=M("default"),[u,l]=M([]),[d,a]=M([]),[m,b]=Et(f=>f+1,0);ne(()=>{r("loading"),(async()=>{try{const f=await ln();l(f);const v=await o.v1.accounts.$select(n).lists.list();a(v),r("default")}catch{r("error")}})()},[m]);const[g,p]=M(!1);return e("div",{class:"sheet",id:"list-add-remove-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(x,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"sJ2yQc"})})}),e("main",{children:[u.length>0?e("ul",{class:"list-add-remove",children:u.map(f=>{const v=d.some(y=>y.id===f.id);return e("li",{children:e("button",{type:"button",class:`light ${v?"checked":""}`,disabled:c==="loading",onClick:()=>{r("loading"),(async()=>{try{v?await o.v1.lists.$select(f.id).accounts.remove({accountIds:[n]}):await o.v1.lists.$select(f.id).accounts.create({accountIds:[n]}),b()}catch{r("error"),alert(s(v?{id:"7KnEYa"}:{id:"Tba8uO"}))}})()},children:[e(x,{icon:"check-circle",alt:"☑️"}),e("span",{children:f.title})]})})})}):c==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):c==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"/MJ7gZ"})}),e("button",{type:"button",class:"plain2",onClick:()=>p(!0),disabled:c!=="default",children:[e(x,{icon:"plus",size:"l"})," ",e("span",{children:e(h,{id:"Sb2gYF"})})]})]}),g&&e(qe,{onClick:f=>{f.target===f.currentTarget&&p(!1)},children:e(wi,{list:g==null?void 0:g.list,onClose:f=>{f.state==="success"&&b(),p(!1)}})})]})}function Kc({account:n,note:i,onRelationshipChange:s=()=>{},onClose:o=()=>{}}){const{_:c}=de(),{masto:r}=re(),[u,l]=M("default"),d=q(null);return ne(()=>{let a;return d.current&&!i&&(a=setTimeout(()=>{var m,b;(b=(m=d.current).focus)==null||b.call(m)},100)),()=>{clearTimeout(a)}},[]),e("div",{class:"sheet",id:"private-note-container",children:[!!o&&e("button",{type:"button",class:"sheet-close",onClick:o,children:e(x,{icon:"x",alt:c({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"DYqYm5",values:{0:(n==null?void 0:n.username)||(n==null?void 0:n.acct)},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:e("form",{onSubmit:a=>{a.preventDefault();const b=new FormData(a.target).get("note");(b==null?void 0:b.trim())!==(i==null?void 0:i.trim())&&(l("loading"),(async()=>{try{const g=await r.v1.accounts.$select(n==null?void 0:n.id).note.create({comment:b});l("default"),s(g),o()}catch(g){l("error"),alert((g==null?void 0:g.message)||c({id:"ot8LpF"}))}})())},children:[e("textarea",{ref:d,name:"note",disabled:u==="loading",dir:"auto",children:i}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:u==="loading",onClick:()=>{o==null||o()},children:e(h,{id:"dEgA5A"})}),e("span",{children:[e(Ue,{abrupt:!0,hidden:u!=="loading"}),e("button",{disabled:u==="loading",type:"submit",children:e(h,{id:"SrwrEj"})})]})]})]})})]})}const Zc=["image/jpeg","image/png","image/gif","image/webp"],Fi=Zc.join(",");function Wc({onClose:n=()=>{}}){const{_:i}=de(),{masto:s}=re(),[o,c]=M("loading"),[r,u]=M(null),[l,d]=M(null),[a,m]=M(null);ne(()=>{(async()=>{try{const k=await s.v1.accounts.verifyCredentials();u(k),c("default")}catch{c("error")}})()},[]);const{displayName:b,source:g,avatar:p,header:f}=r||{},{note:v,fields:y}=g||{},w=q(null),C=[...p?[{type:"image",url:p}]:[],...a?[{type:"image",url:a}]:[]],S=[...f?[{type:"image",url:f}]:[],...l?[{type:"image",url:l}]:[]];return e("div",{class:"sheet",id:"edit-profile-container",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"9OpVZg"})})}),e("main",{children:o==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("form",{onSubmit:k=>{k.preventDefault();const T=new FormData(k.target),_=T.get("header"),I=T.get("avatar"),R=T.get("display_name"),L=T.get("note"),z=w.current.querySelectorAll('input[name^="fields_attributes"]'),P=[];z.forEach(Z=>{const ee=Z.name,[W,V,B]=ee.match(/fields_attributes\[(\d+)\]\[(.+)\]/)||[],F=Z.value?Z.value.trim():"";V&&B&&F&&(P[V]||(P[V]={}),P[V][B]=F)}),P.forEach(Z=>{Z.name&&!Z.value&&(Z.value="")}),(async()=>{try{const Z=await s.v1.accounts.updateCredentials({header:_,avatar:I,displayName:R,note:L,fieldsAttributes:P});n==null||n({state:"success",account:Z})}catch(Z){alert((Z==null?void 0:Z.message)||i({id:"FwMMx0"}))}})()},children:[e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"C5zXYJ"})," ",e("input",{type:"file",name:"header",accept:Fi,onChange:k=>{const T=k.target.files[0];if(T){const _=URL.createObjectURL(T);d(_)}}})]}),e("div",{class:"edit-profile-media-field",children:[f?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{A.showMediaModal={mediaAttachments:S,index:0}},children:e("img",{src:f,alt:""})}):e("div",{class:"edit-media"}),l&&e(O,{children:[e(x,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{A.showMediaModal={mediaAttachments:S,index:1}},children:e("img",{src:l,alt:""})})]})]})]}),e("div",{class:"edit-profile-media-container",children:[e("label",{children:[e(h,{id:"4XF0BB"})," ",e("input",{type:"file",name:"avatar",accept:Fi,onChange:k=>{const T=k.target.files[0];if(T){const _=URL.createObjectURL(T);m(_)}}})]}),e("div",{class:"edit-profile-media-field",children:[p?e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{A.showMediaModal={mediaAttachments:C,index:0}},children:e("img",{src:p,alt:""})}):e("div",{class:"edit-media"}),a&&e(O,{children:[e(x,{icon:"arrow-right"}),e("div",{class:"edit-media",tabIndex:"0",onClick:()=>{A.showMediaModal={mediaAttachments:C,index:1}},children:e("img",{src:a,alt:""})})]})]})]}),e("p",{children:e("label",{children:[e(h,{id:"6YtxFj"})," ",e("input",{type:"text",name:"display_name",defaultValue:b,maxLength:30,disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e("label",{children:[e(h,{id:"E+oKCO"}),e("textarea",{defaultValue:v,name:"note",maxLength:500,rows:"5",disabled:o==="loading",dir:"auto"})]})}),e("p",{children:e(h,{id:"T4I119"})}),e("table",{ref:w,children:[e("thead",{children:e("tr",{children:[e("th",{children:e(h,{id:"87a/t/"})}),e("th",{children:e(h,{id:"4b3oEV"})})]})}),e("tbody",{children:Array.from({length:Math.max(4,y.length)}).map((k,T)=>{const{name:_="",value:I=""}=y[T]||{};return e(Xc,{name:_,value:I,index:T,disabled:o==="loading"},T)})})]}),e("footer",{children:[e("button",{type:"button",class:"light",disabled:o==="loading",onClick:()=>{n==null||n()},children:e(h,{id:"dEgA5A"})}),e("button",{type:"submit",disabled:o==="loading",children:e(h,{id:"tfDRzk"})})]})]})})]})}function Xc({name:n,value:i,disabled:s,index:o}){const[c,r]=M(!!i);return e("tr",{children:[e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][name]`,defaultValue:n,disabled:s,maxLength:255,required:c,dir:"auto"})}),e("td",{children:e("input",{type:"text",name:`fields_attributes[${o}][value]`,defaultValue:i,disabled:s,maxLength:255,onChange:u=>r(!!u.currentTarget.value),dir:"auto"})})]})}function Jc({acct:n,instance:i}){let[s,o]=n.split("@");o||(o=i);const c=zt.toASCII(n);return e("div",{class:"handle-info",children:[e("span",{class:"handle-handle",title:c,children:[e("b",{class:"handle-username",children:s}),e("span",{class:"handle-at",children:"@"}),e("b",{class:"handle-server",children:o})]}),e("div",{class:"handle-legend",children:[e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon username"})," ",e(h,{id:"silO9A"})]})," ",e("span",{class:"ib",children:[e("span",{class:"handle-legend-icon server"})," ",e(h,{id:"rZgCpJ"})]})]})]})}function Qc({account:n,instance:i,onClose:s}){const{_:o}=de(),{masto:c,instance:r,authenticated:u}=re({instance:i}),l=typeof n=="string";return ne(()=>{l||(A.accounts[`${n.id}@${r}`]=n)},[n]),Ns(s),e("div",{class:"sheet",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(x,{icon:"x",alt:o({id:"yz7wBu"})})}),e(Us,{instance:r,authenticated:u,account:n,fetchAccount:async()=>{if(l)try{return await c.v1.accounts.lookup({acct:n,skip_webfinger:!1})}catch{const a=await c.v2.search.fetch({q:n,type:"accounts",limit:1,resolve:u});if(a.accounts.length)return a.accounts[0];if(/https?:\/\/[^/]+\/@/.test(n)){const m=URL.parse(n),{hostname:b,pathname:g}=m,p=g.replace(/^\//,"").replace(/\/$/,"")+"@"+b,f=await c.v2.search.fetch({q:p,type:"accounts",limit:1,resolve:u});if(f.accounts.length)return f.accounts[0]}}else return n}})]})}function ea({onClose:n}){const{_:i}=de(),{masto:s}=re(),[o,c]=M("default"),[r,u]=M([]),[l,d]=Et(m=>m+1,0);ne(()=>{c("loading"),(async()=>{try{const m=await pt.drafts.keys();if(m.length){const b=_n(),g=m.filter(p=>p.startsWith(b));if(g.length){const p=await pt.drafts.getMany(g);p.sort((f,v)=>new Date(v.updatedAt).getTime()-new Date(f.updatedAt).getTime()),u(p)}else u([])}else u([]);c("default")}catch{c("error")}})()},[l]);const a=(r==null?void 0:r.length)>0;return e("div",{class:"sheet",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:[e("h2",{children:[e(h,{id:"krk5ws"})," ",e(Ue,{abrupt:!0,hidden:o!=="loading"})]}),a&&e("div",{class:"insignificant",children:e(h,{id:"Ap/10+"})})]}),e("main",{children:a?e(O,{children:[e("ul",{class:"drafts-list",children:r.map(m=>{const{updatedAt:b,key:g,draftStatus:p,replyTo:f}=m,v=new Date(b);return e("li",{children:[e("div",{class:"mini-draft-meta",children:[e("b",{children:[e(x,{icon:f?"reply":"quill",size:"s"})," ",e("time",{children:[!!f&&e(O,{children:[e("span",{class:"bidi-isolate",children:["@",f.account.acct]}),e("br",{})]}),ot(v)]})]}),e(ut,{confirmLabel:e("span",{children:e(h,{id:"/W5yFF"})}),menuItemClassName:"danger",align:"end",disabled:o==="loading",onClick:()=>{(async()=>{try{await pt.drafts.del(g),d()}catch{alert(i({id:"rEYoku"}))}})()},children:e("button",{type:"button",class:"small light",disabled:o==="loading",children:e(h,{id:"Jb6/SB"})})})]}),e("button",{type:"button",disabled:o==="loading",class:"draft-item",onClick:async()=>{let y;if(f){c("loading");try{y=await s.v1.statuses.$select(f.id).fetch()}catch{alert(i({id:"tMwimH"})),c("default");return}c("default")}window.__COMPOSE__={draftStatus:p,replyToStatus:y},A.showCompose=!0,A.showDrafts=!1},children:e(ta,{draft:m})})]},b)})}),r.length>1&&e("p",{children:e(ut,{confirmLabel:e("span",{children:e(h,{id:"3IakFR"})}),menuItemClassName:"danger",disabled:o==="loading",onClick:()=>{(async()=>{c("loading");try{await pt.drafts.delMany(r.map(m=>m.key)),c("default"),d()}catch{alert(i({id:"0J4sZq"})),c("error")}})()},children:e("button",{type:"button",class:"light danger",disabled:o==="loading",children:e(h,{id:"hOg+Mt"})})})})]}):e("p",{children:e(h,{id:"8iQ+jk"})})})]})}function ta({draft:n}){var g;const{_:i}=de(),{draftStatus:s,replyTo:o}=n,{status:c,spoilerText:r,poll:u,mediaAttachments:l}=s,d=((g=u==null?void 0:u.options)==null?void 0:g.length)>0,a=(l==null?void 0:l.length)>0,m=d||a,b=_e(()=>{if(!a)return;const p=l.find(y=>/image/.test(y.type));if(!p)return;const{file:f}=p;return URL.createObjectURL(f)},[a,l]);return e(O,{children:e("div",{class:"mini-draft",children:[m&&e("div",{class:`mini-draft-aside ${b?"has-image":""}`,style:b?{"--bg-image":`url(${b})`}:{},children:[d&&e(x,{icon:"poll",alt:i({id:"4WUbF1"})}),a&&e("span",{children:[e(x,{icon:"attachment",alt:i({id:"xYilR2"})})," ",e("small",{children:l==null?void 0:l.length})]})]}),e("div",{class:"mini-draft-main",children:[!!r&&e("div",{class:"mini-draft-spoiler",children:r}),!!c&&e("div",{class:"mini-draft-status",children:c})]})]})})}function na({html:n,url:i,width:s,height:o,onClose:c=()=>{}}){const{_:r}=de();return e("div",{class:"embed-modal-container",children:[e("div",{class:"top-controls",children:[e("button",{type:"button",class:"light",onClick:()=>c(),children:e(x,{icon:"x",alt:r({id:"yz7wBu"})})}),i&&e("a",{href:i,target:"_blank",rel:"noopener",class:"button plain",children:[e("span",{children:e(h,{id:"4/RpOy"})})," ",e(x,{icon:"external"})]})]}),e("div",{class:"embed-content",dangerouslySetInnerHTML:{__html:n},style:{"--width":s+"px","--height":o+"px","--aspect-ratio":`${s}/${o}`}})]})}function ia({instance:n,excludeRelationshipAttrs:i=[],postID:s,onClose:o=()=>{},blankCopy:c}){const{_:r}=de(),{masto:u,instance:l}=re(),d=n?n===l:!0,a=Ve(A),[m,b]=M("default"),[g,p]=M([]),[f,v]=M(!1);if(Ns(o),!a.showGenericAccounts)return null;const{id:y,heading:w,fetchAccounts:C,accounts:S,showReactions:k}=a.showGenericAccounts,[T,_]=M({}),I=async P=>{if(!(P!=null&&P.length)||!d)return;const Z=await di(P,T);Z&&_({...T,...Z})},R=P=>{C&&(P&&p([]),b("loading"),(async()=>{try{const{done:Z,value:ee}=await C(P);if(Array.isArray(ee)){if(P){const W=[];for(let V=0;V<ee.length;V++){const B=ee[V],F=W.find((se,$)=>se.id===B.id&&V!==$);F?F._types.push(...B._types):W.push({_types:[],...B})}p(W)}else p(W=>{const V=W;for(const B of ee){const F=V.find(se=>se.id===B.id);F?F._types.push(...B._types):V.push(B)}return V});v(!Z),I(ee)}else v(!1);b("default")}catch{b("error")}})())},L=q(!0);ne(()=>{(S==null?void 0:S.length)>0?(p(S),I(S)):(R(!0),L.current=!1)},[S,C]),ne(()=>{var P;L.current||((P=a.reloadGenericAccounts)==null?void 0:P.id)===y&&R(!0)},[a.reloadGenericAccounts.counter]);const z=A.statuses[s];return e("div",{id:"generic-accounts-container",class:"sheet",tabindex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:o,children:e(x,{icon:"x",alt:r({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:w||r({id:"bPwFdf"})})}),e("main",{children:[z&&e(be,{to:`/${n||l}/s/${z.id}`,class:"post-preview",children:e(je,{status:z,size:"s",readOnly:!0})}),g.length>0?e(O,{children:[e("ul",{class:"accounts-list",children:g.map(P=>{var W,V;const Z=T[P.id],ee=`${P.id}-${((W=P._types)==null?void 0:W.length)||""}`;return e("li",{children:[k&&((V=P._types)==null?void 0:V.length)>0&&e("div",{class:"reactions-block",children:P._types.map(B=>e(x,{icon:{reblog:"rocket",favourite:"heart"}[B],class:`${B}-icon`}))}),e("div",{class:"account-relationships",children:e(ht,{account:P,showStats:!0,relationship:Z,excludeRelationshipAttrs:i})})]},ee)})}),m==="default"?f?e(_t,{onChange:P=>{P&&R()},children:e("button",{type:"button",class:"plain block",onClick:()=>R(),children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):m==="loading"&&e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})})]}):m==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):m==="error"?e("p",{class:"ui-state",children:e(h,{id:"AThL/k"})}):e("p",{class:"ui-state insignificant",children:c||r({id:"10OlfF"})})]})]})}function sa({alt:n,lang:i,onClose:s}){const{_:o}=de(),c=Ve(A),[r,u]=M(!1),l=ws(!0),d=c.settings.contentTranslationHideLanguages||[],a=!!i&&i!==l&&!xi([i],[l])&&!d.find(m=>i===m||xi([i],[m]));return e("div",{class:"sheet",tabindex:"-1",children:[!!s&&e("button",{type:"button",class:"sheet-close outer",onClick:s,children:e(x,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{class:"header-grid",children:[e("h2",{children:e(h,{id:"5gfDMm"})}),e("div",{class:"header-side",children:e(rt,{align:"end",menuButton:e("button",{type:"button",class:"plain4",children:e(x,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(Se,{disabled:r,onClick:()=>{u(!0)},children:[e(x,{icon:"translate"}),e("span",{children:e(h,{id:"pi8x/S"})})]}),Oo&&e(Se,{onClick:()=>{zo(n,i)},children:[e(x,{icon:"speak"}),e("span",{children:e(h,{id:"yIBLq8"})})]})]})})]}),e("main",{lang:i,dir:"auto",children:[e("p",{style:{whiteSpace:"pre-wrap",textWrap:"pretty"},children:n}),(a||r)&&e(Cs,{forceTranslate:r,sourceLanguage:i,text:n})]})]})}const{min:kd,max:Sd}=Math;const Fs={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Fs[`[object ${n}]`]=n.toLowerCase();function oa(n){return Fs[Object.prototype.toString.call(n)]||"object"}const Xt=(n,i=null)=>n.length>=3?Array.prototype.slice.call(n):oa(n[0])=="object"&&i?i.split("").filter(s=>n[0][s]!==void 0).map(s=>n[0][s]):n[0].slice(0);const{PI:Pn,min:Cd,max:_d}=Math;const Id=Pn*2,xd=Pn/3,ca=Pn/180,aa=180/Pn;function Tn(n,i){let s=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(i[0])||(i=i.map(u=>[u]));let o=i[0].length,c=i[0].map((u,l)=>i.map(d=>d[l])),r=n.map(u=>c.map(l=>Array.isArray(u)?u.reduce((d,a,m)=>d+a*(l[m]||0),0):l.reduce((d,a)=>d+a*u,0)));return s===1&&(r=r[0]),o===1?r.map(u=>u[0]):r}const Hs={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}};const Fn=n=>{const i=Math.sign(n);return n=Math.abs(n),(n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055)*i},ra=(n,i,s)=>{const{MtxAdaptMa:o,MtxAdaptMaI:c,MtxXYZ2RGB:r,RefWhiteRGB:u,Xn:l,Yn:d,Zn:a}=Hs,m=l*o.m00+d*o.m10+a*o.m20,b=l*o.m01+d*o.m11+a*o.m21,g=l*o.m02+d*o.m12+a*o.m22,p=u.X*o.m00+u.Y*o.m10+u.Z*o.m20,f=u.X*o.m01+u.Y*o.m11+u.Z*o.m21,v=u.X*o.m02+u.Y*o.m12+u.Z*o.m22,y=(n*o.m00+i*o.m10+s*o.m20)*(p/m),w=(n*o.m01+i*o.m11+s*o.m21)*(f/b),C=(n*o.m02+i*o.m12+s*o.m22)*(v/g),S=y*c.m00+w*c.m10+C*c.m20,k=y*c.m01+w*c.m11+C*c.m21,T=y*c.m02+w*c.m12+C*c.m22,_=Fn(S*r.m00+k*r.m10+T*r.m20),I=Fn(S*r.m01+k*r.m11+T*r.m21),R=Fn(S*r.m02+k*r.m12+T*r.m22);return[_*255,I*255,R*255]},ki=(...n)=>{n=Xt(n,"lab");const[i,s,o,...c]=n,[r,u,l]=la([i,s,o]),[d,a,m]=ra(r,u,l);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]};function la(n){var i=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],s=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],o=Tn(s,n);return Tn(i,o.map(c=>c**3))}function Hn(n){const i=Math.sign(n);return n=Math.abs(n),(n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4))*i}const da=(n,i,s)=>{n=Hn(n/255),i=Hn(i/255),s=Hn(s/255);const{MtxRGB2XYZ:o,MtxAdaptMa:c,MtxAdaptMaI:r,Xn:u,Yn:l,Zn:d,As:a,Bs:m,Cs:b}=Hs;let g=n*o.m00+i*o.m10+s*o.m20,p=n*o.m01+i*o.m11+s*o.m21,f=n*o.m02+i*o.m12+s*o.m22;const v=u*c.m00+l*c.m10+d*c.m20,y=u*c.m01+l*c.m11+d*c.m21,w=u*c.m02+l*c.m12+d*c.m22;let C=g*c.m00+p*c.m10+f*c.m20,S=g*c.m01+p*c.m11+f*c.m21,k=g*c.m02+p*c.m12+f*c.m22;return C*=v/a,S*=y/m,k*=w/b,g=C*r.m00+S*r.m10+k*r.m20,p=C*r.m01+S*r.m11+k*r.m21,f=C*r.m02+S*r.m12+k*r.m22,[g,p,f]},Si=(...n)=>{const[i,s,o,...c]=Xt(n,"rgb"),r=da(i,s,o);return[...ua(r),...c.length>0&&c[0]<1?[c[0]]:[]]};function ua(n){const i=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],s=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],o=Tn(i,n);return Tn(s,o.map(c=>Math.cbrt(c)))}const{sin:ha,cos:fa}=Math,pa=(...n)=>{let[i,s,o]=Xt(n,"lch");return isNaN(o)&&(o=0),o=o*ca,[i,fa(o)*s,ha(o)*s]},qn=(...n)=>{n=Xt(n,"lch");const[i,s,o,...c]=n,[r,u,l]=pa(i,s,o),[d,a,m]=ki(r,u,l);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]},{sqrt:ma,atan2:ga,round:ba}=Math,va=(...n)=>{const[i,s,o]=Xt(n,"lab"),c=ma(s*s+o*o);let r=(ga(o,s)*aa+360)%360;return ba(c*1e4)===0&&(r=Number.NaN),[i,c,r]},ya=(...n)=>{const[i,s,o,...c]=Xt(n,"rgb"),[r,u,l]=Si(i,s,o),[d,a,m]=va(r,u,l);return[d,a,m,...c.length>0&&c[0]<1?[c[0]]:[]]},wa={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_IMG_ALT_API_URL:Td}=wa;function qs({mediaAttachments:n,statusID:i,instance:s,lang:o,index:c=0,onClose:r=()=>{}}){var k,T;const{_:u}=de(),[l,d]=M("default"),a=q(null),[m,b]=M(c),g=q(null);wt(()=>{var _;(_=g.current)==null||_.scrollIntoView()},[]);const p=q(i);ne(()=>{const _=c*a.current.clientWidth,I=p.current!==i;I&&(p.current=i),a.current.focus(),a.current.scrollTo({left:_*(Dt()?-1:1),behavior:I?"auto":"smooth"})},[c,i]);const[f,v]=M(!0);ne(()=>{let _=()=>{r()};return a.current&&a.current.addEventListener("swiped-down",_),()=>{a.current&&a.current.removeEventListener("swiped-down",_)}},[]),He("esc",r,{ignoreEventWhen:_=>!!document.querySelector("#modal-container > *")},[r]),ne(()=>{let _=()=>{const{clientWidth:I,scrollLeft:R}=a.current,L=Math.round(Math.abs(R)/I);b(L)};return a.current&&a.current.addEventListener("scroll",_,{passive:!0}),()=>{a.current&&a.current.removeEventListener("scroll",_)}},[]),ne(()=>{let _=setTimeout(()=>{var I,R;(R=(I=a.current)==null?void 0:I.focus)==null||R.call(I)},100);return()=>clearTimeout(_)},[]);const y=_e(()=>n==null?void 0:n.map(_=>{const{blurhash:I}=_;if(I){const R=ui(I);return ya(R)}return null}),[n]),w=_e(()=>y==null?void 0:y.map(_=>_?{light:qn([.95,.01,_[2]]),dark:qn([.35,.01,_[2]]),default:qn([.6,_[1],_[2]])}:null)),C=_e(()=>{const I=100/w.length,R=w.map((P,Z)=>{var V,B,F,se;const ee=Z*I+5,W=(Z+1)*I-5;return P!=null&&P.light&&(P!=null&&P.dark)?{light:`
                rgb(${(V=P.light)==null?void 0:V.join(",")}) ${ee}%, 
                rgb(${(B=P.light)==null?void 0:B.join(",")}) ${W}%
              `,dark:`
                rgb(${(F=P.dark)==null?void 0:F.join(",")}) ${ee}%, 
                rgb(${(se=P.dark)==null?void 0:se.join(",")}) ${W}%
              `}:{light:`
              transparent ${ee}%, 
              transparent ${W}%
            `,dark:`
              transparent ${ee}%, 
              transparent ${W}%
            `}}),L=R.map(P=>P.light).join(", "),z=R.map(P=>P.dark).join(", ");return{light:L,dark:z}},[w]);let S=q(null);return ne(()=>()=>{var _,I;(I=(_=S.current)==null?void 0:_.hideToast)==null||I.call(_)},[]),wt(()=>{const _=w[m];let I,R;if(_){const L=ke.local.get("theme");if(L){const z=`rgb(${_[L].join(",")})`;I=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),I&&(R=I.content,I.content=z)}else{const z=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",P=`rgb(${_[z].join(",")})`;I=document.querySelector(`meta[name="theme-color"][media*="${z}"]`),I&&(R=I.content,I.content=P)}}return()=>{I&&R&&(I.content=R)}},[m,w]),e("div",{class:`media-modal-container media-modal-count-${n==null?void 0:n.length}`,children:[e("div",{ref:a,tabIndex:"0","data-swipe-threshold":"44",class:"carousel",onClick:_=>{(_.target.classList.contains("carousel-item")||_.target.classList.contains("media")||_.target.classList.contains("media-zoom"))&&r()},style:n.length>1?{backgroundAttachment:"local","--accent-gradient-light":C==null?void 0:C.light,"--accent-gradient-dark":C==null?void 0:C.dark}:{},children:n==null?void 0:n.map((_,I)=>{var L,z;const R=n.length===1?w[I]:null;return e("div",{class:"carousel-item",style:R?{"--accent-color":`rgb(${R.default.join(",")})`,"--accent-light-color":`rgb(${(L=R.light)==null?void 0:L.join(",")})`,"--accent-dark-color":`rgb(${(z=R.dark)==null?void 0:z.join(",")})`,"--accent-alpha-color":`rgba(${R.default.join(",")}, 0.4)`}:{},tabindex:"0",ref:I===m?g:null,onClick:P=>{P.target.classList.contains("media")||v(!f)},children:[!!_.description&&e("button",{type:"button",class:"media-alt",hidden:!f,onClick:()=>{A.showMediaAlt={alt:_.description,lang:o}},children:[e("span",{class:"alt-badge",children:"ALT"}),e("span",{class:"media-alt-desc",lang:o,dir:"auto",children:_.description})]}),e(_s,{media:_,showOriginal:!0,lang:o})]},_.id)})}),e("div",{class:"carousel-top-controls",hidden:!f,children:[e("span",{children:e("button",{type:"button",class:"carousel-button",onClick:()=>r(),children:e(x,{icon:"x",alt:u({id:"yz7wBu"})})})}),(n==null?void 0:n.length)>1?e("span",{class:"carousel-dots",children:n==null?void 0:n.map((_,I)=>e("button",{type:"button",disabled:I===m,class:`carousel-dot ${I===m?"active":""}`,onClick:R=>{R.preventDefault(),R.stopPropagation();const L=a.current.clientWidth*I*(Dt()?-1:1);a.current.focus(),a.current.scrollTo({left:L,behavior:"smooth"})},children:e(x,{icon:"round",size:"s",alt:"⸱"})},_.id))}):e("span",{}),e("span",{children:[e(rt,{overflow:"auto",align:"end",position:"anchor",gap:4,menuClassName:"glass-menu",menuButton:e("button",{type:"button",class:"carousel-button",children:e(x,{icon:"more",alt:u({id:"2FYpfJ"})})}),children:[e(Ye,{href:((k=n[m])==null?void 0:k.remoteUrl)||((T=n[m])==null?void 0:T.url),class:"carousel-button",target:"_blank",title:u({id:"5hXGws"}),children:[e(x,{icon:"popout"}),e("span",{children:e(h,{id:"aDr7Vc"})})]}),!1]})," ",!!i&&e(be,{to:`${s?`/${s}`:""}/s/${i}${window.matchMedia("(min-width: calc(40em + 350px))").matches?`?media=${m+1}`:""}`,class:"button carousel-button media-post-link",children:[e("span",{class:"button-label",children:[e(h,{id:"ISg5SQ"})," "]}),"»"]})]})]}),(n==null?void 0:n.length)>1&&e("div",{class:"carousel-controls",hidden:!f,children:[e("button",{type:"button",class:"carousel-button",hidden:m===0,onClick:_=>{_.preventDefault(),_.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(m-1)*(Dt()?-1:1),behavior:"smooth"})},children:e(x,{icon:"arrow-left",alt:u({id:"DHhJ7s"})})}),e("button",{type:"button",class:"carousel-button",hidden:m===n.length-1,onClick:_=>{_.preventDefault(),_.stopPropagation(),a.current.focus(),a.current.scrollTo({left:a.current.clientWidth*(m+1)*(Dt()?-1:1),behavior:"smooth"})},children:e(x,{icon:"arrow-right",alt:u({id:"hXzOVo"})})})]})]})}const ka=[,"spam","legal","violation","other"],Jt={spam:{label:{id:"t8dIOP"},description:{id:"csQin/"}},legal:{label:{id:"IjKdHM"},description:{id:"e6tGFu"}},violation:{label:{id:"KPFHM2"},description:{id:"fpotTF"},stampLabel:{id:"iuLUuH"}},other:{label:{id:"/IX/7x"},description:{id:"kxiG8g"},excludeStamp:!0}};function Sa({account:n,post:i,onClose:s}){const{_:o,_:c}=de(),{masto:r}=re(),[u,l]=M("default"),[d,a]=n.acct.split("@"),[m,b]=_e(()=>{const{rules:S,domain:k}=hs();return[S||[],k]}),[g,p]=M(null),[f,v]=M(!1),y=q(null),[w,C]=M(!1);return e("div",{class:"report-modal-container",children:[e("div",{class:"top-controls",children:[e("h1",{children:c(i?{id:"muLhL3"}:{id:"ACul2G",values:{username:d}})}),e("button",{type:"button",class:"plain4 small",disabled:u==="loading",onClick:()=>s(),children:e(x,{icon:"x",size:"xl",alt:c({id:"yz7wBu"})})})]}),e("main",{children:[e("div",{class:"report-preview",children:i?e(je,{status:i,size:"s",previewMode:!0}):e(ht,{account:n,avatarSize:"xxl",useAvatarStatic:!0,showStats:!0,showActivity:!0})}),!!g&&!Jt[g].excludeStamp&&e("span",{class:"rubber-stamp","aria-hidden":"true",children:[o(Jt[g].stampLabel||o(Jt[g].label)),e("small",{children:e(h,{id:"2WtL62"})})]},g),e("form",{onSubmit:S=>{S.preventDefault();const k=new FormData(S.target),T=Object.fromEntries(k.entries());let{category:_,comment:I,forward:R}=T;I||(I=void 0),R==="on"&&(R=!0);const L=_==="violation"?Object.entries(T).filter(([P])=>P.startsWith("rule_ids")).map(([P,Z])=>Z):void 0,z={category:_,comment:I,forward:R,ruleIds:L};l("loading"),(async()=>{try{await r.v1.reports.create({accountId:n.id,statusIds:i!=null&&i.id?[i.id]:void 0,category:_,comment:I,ruleIds:L,forward:R}),l("success"),me(c(i?{id:"y3ou+8"}:{id:"R9kjEL"})),s()}catch(P){l("error"),me((P==null?void 0:P.message)||c(i?{id:"+3FjPq"}:{id:"oEQq5w"}))}})()},children:[e("p",{children:c(i?{id:"L9fUm+"}:{id:"rSLkfe"})}),e("section",{class:"report-categories",children:ka.map(S=>S==="violation"&&!(m!=null&&m.length)?null:e(O,{children:[e("label",{class:"report-category",children:[e("input",{type:"radio",name:"category",value:S,required:!0,disabled:u==="loading",onChange:k=>{p(k.target.value),v(k.target.value==="violation")}}),e("span",{children:[o(Jt[S].label),"  ",e("small",{class:"ib insignificant",children:o(Jt[S].description)})]})]}),S==="violation"&&!!(m!=null&&m.length)&&e("div",{class:"shazam-container no-animation",hidden:!f,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"report-rules",ref:y,children:m.map((k,T)=>e("label",{class:"report-rule",children:[e("input",{type:"checkbox",name:`rule_ids[${T}]`,value:k.id,required:f&&!w,disabled:u==="loading",onChange:_=>{const{checked:I}=_.target;I?C(!0):y.current.querySelectorAll("input:checked").length||C(!1)}}),e("span",{children:k.text})]},k.id))})})})]},S))}),e("section",{class:"report-comment",children:[e("p",{children:e("label",{for:"report-comment",children:e(h,{id:"ecVtjm"})})}),e("textarea",{maxlength:"1000",rows:"1",name:"comment",id:"report-comment",disabled:u==="loading",required:!i})]}),!!a&&a!==b&&e("section",{children:e("p",{children:e("label",{children:[e("input",{type:"checkbox",switch:!0,name:"forward",disabled:u==="loading"})," ",e("span",{children:e(h,{id:"cyjS8M",values:{domain:a},components:{0:e("i",{})}})})]})})}),e("footer",{children:[e("button",{type:"submit",disabled:u==="loading",children:e(h,{id:"4cijjm"})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await r.v1.accounts.$select(n.id).mute(),me(c({id:"/BGBeF",values:{username:d}}))}catch{me(c({id:"v02K7/",values:{username:d}}))}},children:e(h,{id:"caeqw/",components:{0:e("small",{class:"ib"})}})})," ",e("button",{type:"submit",class:"plain2",disabled:u==="loading",onClick:async()=>{try{await r.v1.accounts.$select(n.id).block(),me(c({id:"kjUejn",values:{username:d}}))}catch{me(c({id:"pMcdDp",values:{username:d}}))}},children:e(h,{id:"JybQca",components:{0:e("small",{class:"ib"})}})}),e(Ue,{hidden:u!=="loading"})]})]})]})]})}var bn={exports:{}},Ad=bn.exports,Hi;function Ca(){return Hi||(Hi=1,function(n){var i=function(){var s=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function u(d,a){if(!r[d]){r[d]={};for(var m=0;m<d.length;m++)r[d][d.charAt(m)]=m}return r[d][a]}var l={compressToBase64:function(d){if(d==null)return"";var a=l._compress(d,6,function(m){return o.charAt(m)});switch(a.length%4){default:case 0:return a;case 1:return a+"===";case 2:return a+"==";case 3:return a+"="}},decompressFromBase64:function(d){return d==null?"":d==""?null:l._decompress(d.length,32,function(a){return u(o,d.charAt(a))})},compressToUTF16:function(d){return d==null?"":l._compress(d,15,function(a){return s(a+32)})+" "},decompressFromUTF16:function(d){return d==null?"":d==""?null:l._decompress(d.length,16384,function(a){return d.charCodeAt(a)-32})},compressToUint8Array:function(d){for(var a=l.compress(d),m=new Uint8Array(a.length*2),b=0,g=a.length;b<g;b++){var p=a.charCodeAt(b);m[b*2]=p>>>8,m[b*2+1]=p%256}return m},decompressFromUint8Array:function(d){if(d==null)return l.decompress(d);for(var a=new Array(d.length/2),m=0,b=a.length;m<b;m++)a[m]=d[m*2]*256+d[m*2+1];var g=[];return a.forEach(function(p){g.push(s(p))}),l.decompress(g.join(""))},compressToEncodedURIComponent:function(d){return d==null?"":l._compress(d,6,function(a){return c.charAt(a)})},decompressFromEncodedURIComponent:function(d){return d==null?"":d==""?null:(d=d.replace(/ /g,"+"),l._decompress(d.length,32,function(a){return u(c,d.charAt(a))}))},compress:function(d){return l._compress(d,16,function(a){return s(a)})},_compress:function(d,a,m){if(d==null)return"";var b,g,p={},f={},v="",y="",w="",C=2,S=3,k=2,T=[],_=0,I=0,R;for(R=0;R<d.length;R+=1)if(v=d.charAt(R),Object.prototype.hasOwnProperty.call(p,v)||(p[v]=S++,f[v]=!0),y=w+v,Object.prototype.hasOwnProperty.call(p,y))w=y;else{if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(b=0;b<k;b++)_=_<<1,I==a-1?(I=0,T.push(m(_)),_=0):I++;for(g=w.charCodeAt(0),b=0;b<8;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1}else{for(g=1,b=0;b<k;b++)_=_<<1|g,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=0;for(g=w.charCodeAt(0),b=0;b<16;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1}C--,C==0&&(C=Math.pow(2,k),k++),delete f[w]}else for(g=p[w],b=0;b<k;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1;C--,C==0&&(C=Math.pow(2,k),k++),p[y]=S++,w=String(v)}if(w!==""){if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(b=0;b<k;b++)_=_<<1,I==a-1?(I=0,T.push(m(_)),_=0):I++;for(g=w.charCodeAt(0),b=0;b<8;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1}else{for(g=1,b=0;b<k;b++)_=_<<1|g,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=0;for(g=w.charCodeAt(0),b=0;b<16;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1}C--,C==0&&(C=Math.pow(2,k),k++),delete f[w]}else for(g=p[w],b=0;b<k;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1;C--,C==0&&(C=Math.pow(2,k),k++)}for(g=2,b=0;b<k;b++)_=_<<1|g&1,I==a-1?(I=0,T.push(m(_)),_=0):I++,g=g>>1;for(;;)if(_=_<<1,I==a-1){T.push(m(_));break}else I++;return T.join("")},decompress:function(d){return d==null?"":d==""?null:l._decompress(d.length,32768,function(a){return d.charCodeAt(a)})},_decompress:function(d,a,m){var b=[],g,p=4,f=4,v=3,y="",w=[],C,S,k,T,_,I,R,L={val:m(0),position:a,index:1};for(C=0;C<3;C+=1)b[C]=C;for(k=0,_=Math.pow(2,2),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;switch(g=k){case 0:for(k=0,_=Math.pow(2,8),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;R=s(k);break;case 1:for(k=0,_=Math.pow(2,16),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;R=s(k);break;case 2:return""}for(b[3]=R,S=R,w.push(R);;){if(L.index>d)return"";for(k=0,_=Math.pow(2,v),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;switch(R=k){case 0:for(k=0,_=Math.pow(2,8),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;b[f++]=s(k),R=f-1,p--;break;case 1:for(k=0,_=Math.pow(2,16),I=1;I!=_;)T=L.val&L.position,L.position>>=1,L.position==0&&(L.position=a,L.val=m(L.index++)),k|=(T>0?1:0)*I,I<<=1;b[f++]=s(k),R=f-1,p--;break;case 2:return w.join("")}if(p==0&&(p=Math.pow(2,v),v++),b[R])y=b[R];else if(R===f)y=S+S.charAt(0);else return null;w.push(y),b[f++]=S+y.charAt(0),p--,S=y,p==0&&(p=Math.pow(2,v),v++)}}};return l}();n!=null?n.exports=i:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return i})}(bn)),bn.exports}var qi=Ca();const _a="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%234169E1'%20d='M14%2052a4%204%200%201%201-8%200%204%204%200%200%201%208%200Zm64-42a4%204%200%201%201-8%200%204%204%200%200%201%208%200Z'/%3e%3c/svg%3e",Ia="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2082%2062'%3e%3crect%20width='78'%20height='58'%20x='2'%20y='2'%20fill='%23999'%20fill-opacity='.3'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3crect%20width='18'%20height='46'%20x='8'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='32'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3crect%20width='18'%20height='46'%20x='56'%20y='8'%20fill='%23fff'%20stroke='%23999'%20stroke-width='2'%20rx='1'/%3e%3c/svg%3e",xa="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2084%2062'%3e%3crect%20width='64'%20height='48'%20x='18'%20y='2'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M19%203h62v10H19z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M43%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M52%208a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3crect%20width='32'%20height='48'%20x='2'%20y='12'%20fill='%23fff'%20stroke='%23999'%20stroke-width='3'%20rx='4'/%3e%3cpath%20fill='%23999'%20fill-opacity='.3'%20d='M3%2049h30v10H3z'/%3e%3cpath%20stroke='%234169E1'%20stroke-width='2'%20d='M11%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3cpath%20stroke='%23999'%20stroke-width='2'%20d='M20%2054a2%202%200%201%201-4%200%202%202%200%200%201%204%200Zm9%200a2%202%200%201%201-4%200%202%202%200%200%201%204%200Z'/%3e%3c/svg%3e",Ta=200,Aa=10;async function An(){const{masto:n}=re(),i=n.v1.followedTags.list({limit:Ta}),s=[];let o=0;do{const{value:c,done:r}=await i.next();if(r||(c==null?void 0:c.length)===0)break;s.push(...c),o++}while(o<Aa);return s.sort((c,r)=>c.name.localeCompare(r.name)),s.length&&setTimeout(()=>{ke.account.set("followedTags",{tags:s,updatedAt:Date.now()})},1),s}const Ra=24*60*60*1e3;async function Ea(){try{const{tags:n,updatedAt:i}=ke.account.get("followedTags")||{};return n!=null&&n.length?(Date.now()-i>Ra&&An(),n):await An()}catch{return[]}}const Yi=document.createElement("div"),Ma=n=>{if(!n)return[];if(n.indexOf("#")===-1)return[];Yi.innerHTML=n;const i=Yi.querySelectorAll("a.hashtag");return i.length?Array.from(i).map(s=>s.innerText.trim().replace(/^[^#]*#+/,"")):[]};function vn({children:n}){if(typeof n=="string")return n;const[i,s]=M("");return ne(()=>{Promise.resolve(n).then(s)},[n]),i}const Ct=9,La=["following","mentions","notifications","list","public","trending","search","hashtag","bookmarks","favourites"],Ys={following:{id:"7ZJHdw"},notifications:{id:"iDNBZe"},list:{id:"h16FyT"},public:{id:"tXgQpk"},search:{id:"A1taO8"},"account-statuses":{id:"AeXO77"},bookmarks:{id:"7Ff7ia"},favourites:{id:"zZOZj7"},hashtag:{id:"GP8RLS"},trending:{id:"4/iCqx"},mentions:{id:"/bZzdR"}},yn={list:[{text:{id:"DUMt1y"},name:"id",notRequired:!0}],public:[{text:{id:"OgyJSr"},name:"local",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],trending:[{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}],search:[{text:{id:"dmloPh"},name:"query",type:"text",placeholder:{id:"UHDQDE"},notRequired:!0}],"account-statuses":[{text:"@",name:"id",type:"text",placeholder:"cheeaun@mastodon.social"}],hashtag:[{text:"#",name:"hashtag",type:"text",placeholder:{id:"a6oTWs"},pattern:"[^#]+"},{text:{id:"eK4SL/"},name:"media",type:"checkbox"},{text:{id:"kyAi7k"},name:"instance",type:"text",placeholder:{id:"7defFj"},notRequired:!0}]},$a=gt(async({id:n})=>{const i=await re().masto.v1.accounts.$select(n).fetch();return i.username||i.acct||i.displayName}),Rn={following:{id:"home",title:(n,i)=>i===0?pe._({id:"i0qMbr"}):pe._({id:"following.title"}),path:"/",icon:"home"},mentions:{id:"mentions",title:{id:"/bZzdR"},path:"/mentions",icon:"at"},notifications:{id:"notifications",title:{id:"iDNBZe"},path:"/notifications",icon:"notification"},list:{id:({id:n})=>n?"list":"lists",title:({id:n})=>n?$c(n):pe._({id:"h16FyT"}),path:({id:n})=>n?`/l/${n}`:"/l",icon:"list",excludeViewMode:({id:n})=>n?[]:["multi-column"]},public:{id:"public",title:({local:n})=>n?pe._({id:"d5zxa4"}):pe._({id:"4ERYY7"}),subtitle:({instance:n})=>n||re().instance,path:({local:n,instance:i})=>`/${i}/p${n?"/l":""}`,icon:({local:n})=>n?"building":"earth"},trending:{id:"trending",title:{id:"4/iCqx"},subtitle:({instance:n})=>n||re().instance,path:({instance:n})=>`/${n}/trending`,icon:"chart"},search:{id:"search",title:({query:n})=>n?`“${n}”`:pe._({id:"A1taO8"}),path:({query:n})=>n?`/search?q=${encodeURIComponent(n)}&type=statuses`:"/search",icon:"search",excludeViewMode:({query:n})=>n?[]:["multi-column"]},"account-statuses":{id:"account-statuses",title:$a,path:({id:n})=>`/a/${n}`,icon:"user"},bookmarks:{id:"bookmarks",title:{id:"7Ff7ia"},path:"/b",icon:"bookmark"},favourites:{id:"favourites",title:{id:"zZOZj7"},path:"/f",icon:"heart"},hashtag:{id:"hashtag",title:({hashtag:n})=>n,subtitle:({instance:n})=>n||re().instance,path:({hashtag:n,instance:i,media:s})=>`${i?`/${i}`:""}/t/${n.split(/\s+/).join("+")}${s?"?media=1":""}`,icon:"hashtag"}};function Pa({onClose:n}){const{_:i}=de(),s=Ve(A),{shortcuts:o}=s,[c,r]=M(!1),[u,l]=M(!1),[d]=gi();return e("div",{id:"shortcuts-settings-container",class:"sheet",tabindex:"-1",children:[!!n&&e("button",{type:"button",class:"sheet-close",onClick:n,children:e(x,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(x,{icon:"shortcut"})," ",e(h,{id:"CTqTgr"})," ",e("sup",{style:{fontSize:12,opacity:.5,textTransform:"uppercase"},children:e(h,{id:"A1As8l"})})]})}),e("main",{children:[e("p",{children:e(h,{id:"CIHAsy"})}),e("div",{class:"shortcuts-view-mode",children:[{value:"float-button",label:pe._({id:"qwdOim"}),imgURL:_a},{value:"tab-menu-bar",label:pe._({id:"UxBoCm"}),imgURL:xa},{value:"multi-column",label:pe._({id:"uvDfdW"}),imgURL:Ia}].map(({value:a,label:m,imgURL:b})=>{const g=s.settings.shortcutsViewMode===a||a==="float-button"&&!s.settings.shortcutsViewMode;return e("label",{class:g?"checked":"",children:[e("input",{type:"radio",name:"shortcuts-view-mode",value:a,checked:g,onChange:p=>{A.settings.shortcutsViewMode=p.target.value}})," ",e("img",{src:b,alt:"",width:"80",height:"58"})," ",e("span",{children:m})]},a)})}),o.length>0?e(O,{children:[e("ol",{class:"shortcuts-list",ref:d,children:o.filter(Boolean).map((a,m)=>{const b=Object.values(a).join("-"),{type:g}=a;if(!Rn[g])return null;let{icon:p,title:f,subtitle:v,excludeViewMode:y}=Rn[g];typeof f=="function"?f=f(a,m):f=i(f),typeof v=="function"?v=v(a,m):v=i(v),typeof p=="function"&&(p=p(a,m)),typeof y=="function"&&(y=y(a,m));const w=y==null?void 0:y.includes(s.settings.shortcutsViewMode);return e("li",{children:[e(x,{icon:p}),e("span",{class:"shortcut-text",children:[e(vn,{children:f}),v&&e(O,{children:[" ",e("small",{class:"ib insignificant",children:v})]}),w&&e("span",{class:"tag",children:e(h,{id:"5KJFnN"})})]}),e("span",{class:"shortcut-actions",children:[e("button",{type:"button",class:"plain small",disabled:m===0,onClick:()=>{const C=Array.from(A.shortcuts);if(m>0){const S=A.shortcuts[m-1];C[m-1]=a,C[m]=S,A.shortcuts=C}},children:e(x,{icon:"arrow-up",alt:pe._({id:"QyioBP"})})}),e("button",{type:"button",class:"plain small",disabled:m===o.length-1,onClick:()=>{const C=Array.from(A.shortcuts);if(m<A.shortcuts.length-1){const S=A.shortcuts[m+1];C[m+1]=a,C[m]=S,A.shortcuts=C}},children:e(x,{icon:"arrow-down",alt:pe._({id:"3Ib6FN"})})}),e("button",{type:"button",class:"plain small",onClick:()=>{r({shortcut:a,shortcutIndex:m})},children:e(x,{icon:"pencil",alt:pe._({id:"ePK91l"})})})]})]},b)})}),o.length===1&&s.settings.shortcutsViewMode!=="float-button"&&e("div",{class:"ui-state insignificant",children:[e(x,{icon:"info"})," ",e("small",{children:e(h,{id:"3Xq4Zi"})})]})]}):e("div",{class:"ui-state insignificant",children:[e("p",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"3xIN+E"}):pe._({id:"vLxvHT"})}),e("p",{children:e(h,{id:"Fq4zw3",components:{0:e("br",{}),1:e("a",{href:"#",onClick:a=>{a.preventDefault(),A.shortcuts=[{type:"following"},{type:"notifications"}]}})}})})]}),e("p",{class:"insignificant",children:o.length>=Ct&&(s.settings.shortcutsViewMode==="multi-column"?pe._({id:"RqXfsz",values:{SHORTCUTS_LIMIT:Ct}}):pe._({id:"EVRO/o",values:{SHORTCUTS_LIMIT:Ct}}))}),e("p",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("button",{type:"button",class:"light",onClick:()=>l(!0),children:e(h,{id:"bgVLbt"})}),e("button",{type:"button",disabled:o.length>=Ct,onClick:()=>r(!0),children:[e(x,{icon:"plus"})," ",e("span",{children:s.settings.shortcutsViewMode==="multi-column"?pe._({id:"Vh3ADI"}):pe._({id:"9tmn6W"})})]})]})]}),c&&e(qe,{onClick:a=>{a.target===a.currentTarget&&r(!1)},children:e(Da,{shortcut:c.shortcut,shortcutIndex:c.shortcutIndex,onSubmit:({result:a,mode:m})=>{m==="edit"?A.shortcuts[c.shortcutIndex]=a:A.shortcuts.push(a)},onClose:()=>r(!1)})}),u&&e(qe,{onClick:a=>{a.target===a.currentTarget&&l(!1)},children:e(Na,{shortcuts:o,onClose:()=>l(!1)})})]})}const ji={list:{id:"1qL+L+"},search:{id:"dmTmkQ"},hashtag:{id:"E8laYz"}};function Da({onSubmit:n,disabled:i,shortcut:s,shortcutIndex:o,onClose:c}){var y,w;const{_:r}=de(),u=!!s,[l,d]=M((s==null?void 0:s.type)||null),[a,m]=M("default"),[b,g]=M([]),[p,f]=M([]);ne(()=>{(async()=>{if(l==="list")try{m("loading");const C=await ln();g(C),m("default")}catch{m("error")}})(),(async()=>{if(l==="hashtag")try{const C=await An();f(C)}catch{}})()},[l]);const v=q();return ne(()=>{if(u&&l&&yn[l]){const C=v.current;yn[l].forEach(({name:S,type:k})=>{const T=C.querySelector(`[name="${S}"]`);T&&s[S]&&(k==="checkbox"?T.checked=s[S]==="on":T.value=s[S])})}},[u,l]),e("div",{id:"shortcut-settings-form",class:"sheet",children:[!!c&&e("button",{type:"button",class:"sheet-close",onClick:c,children:e(x,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:u?pe._({id:"pe1jog"}):pe._({id:"Lsxpe5"})})}),e("main",{tabindex:"-1",children:e("form",{ref:v,onSubmit:C=>{C.preventDefault();const S=new FormData(C.target),k={};S.forEach((T,_)=>{k[_]=T==null?void 0:T.trim(),_==="instance"&&(k[_]=k[_].replace(/^https?:\/\//,"").replace(/\/+$/,""),k[_]=k[_].replace(/^@?[^@]+@/,""))}),k.type&&(n({result:k,mode:u?"edit":"add"}),C.target.reset(),d(null),c==null||c())},children:[e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"cklVjM"})}),e("select",{required:!0,disabled:i,onChange:C=>{d(C.target.value)},defaultValue:u?s.type:void 0,name:"type",dir:"auto",children:[e("option",{}),La.map(C=>e("option",{value:C,children:r(Ys[C])}))]})]})}),(w=(y=yn[l])==null?void 0:y.map)==null?void 0:w.call(y,({text:C,name:S,type:k,placeholder:T,pattern:_,notRequired:I})=>l==="list"?e("p",{children:e("label",{children:[e("span",{children:e(h,{id:"2BBAbc"})}),e("select",{name:"id",required:!I,disabled:i||a==="loading",defaultValue:u?s.id:void 0,dir:"auto",children:[e("option",{value:""}),b.map(R=>e("option",{value:R.id,children:R.title}))]})]})}):e("p",{children:e("label",{children:[e("span",{children:r(C)})," ",e("input",{type:k,switch:k==="checkbox"||void 0,name:S,placeholder:r(T),required:k==="text"&&!I,disabled:i,list:l==="hashtag"?"followed-hashtags-datalist":null,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:_,dir:"auto"}),l==="hashtag"&&p.length>0&&e("datalist",{id:"followed-hashtags-datalist",children:p.map(R=>e("option",{value:R.name}))})]})})),!!ji[l]&&e("p",{class:"form-note insignificant",children:[e(x,{icon:"info"}),r(ji[l])]}),e("footer",{children:[e("button",{type:"submit",class:"block",disabled:i||a==="loading",children:u?pe._({id:"tfDRzk"}):pe._({id:"m16xKo"})}),u&&e("button",{type:"button",class:"light danger",onClick:()=>{A.shortcuts.splice(o,1),c==null||c()},children:e(h,{id:"t/YqKh"})})]})]})})]})}function Na({shortcuts:n,onClose:i}){var g;const{_:s}=de(),{masto:o}=re(),c=_e(()=>!n||!n.filter(Boolean).length?"":qi.compressToEncodedURIComponent(JSON.stringify(n.filter(Boolean))),[n]),[r,u]=M(""),[l,d]=M("default"),a=_e(()=>{if(!r)return d("default"),null;try{const p=JSON.parse(qi.decompressFromEncodedURIComponent(r));if(!Array.isArray(p))throw new Error("Not an array");return d("default"),p}catch{try{const f=JSON.parse(r);if(!Array.isArray(f))throw new Error("Not an array");return d("default"),f}catch{return d("error"),null}}},[r]),m=A.shortcuts.length>0,b=q();return e("div",{id:"import-export-container",class:"sheet",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(x,{icon:"x",alt:pe._({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"OOa7/5",components:{0:e("small",{class:"ib insignificant"})}})})}),e("main",{tabindex:"-1",children:[e("section",{children:[e("h3",{children:[e(x,{icon:"arrow-down-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"l3s5ri"})})]}),e("p",{class:"field-button",children:[e("input",{ref:b,type:"text",name:"import",placeholder:pe._({id:"tBmklN"}),class:"block",onInput:p=>{u(p.target.value)},dir:"auto"}),A.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2 small",disabled:l==="cloud-downloading",onClick:async()=>{d("cloud-downloading");const p=yt();me(pe._({id:"HLqLGx"}));try{const v=(await o.v1.accounts.relationships.fetch({id:[p]}))[0];if(v){const{note:y=""}=v;if(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(y)){const w=y.match(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/)[1],{v:C,dt:S,data:k}=JSON.parse(w);b.current.value=k,b.current.dispatchEvent(new Event("input"))}}d("default")}catch{d("error"),me(pe._({id:"gCDfX+"}))}},title:pe._({id:"B6cG3J"}),children:[e(x,{icon:"cloud"}),e(x,{icon:"arrow-down"})]})]}),!!a&&Array.isArray(a)&&e(O,{children:[e("p",{children:[e("b",{children:a.length})," shortcut",a.length>1?"s":""," ",e("small",{class:"insignificant",children:["(",r.length," characters)"]})]}),e("ol",{class:"import-settings-list",children:a.map(p=>{var f,v;return e("li",{children:[e("span",{style:{opacity:n.some(y=>Object.keys(y).every(w=>y[w]===p[w]))?1:0},children:"*"}),e("span",{children:[s(Ys[p.type]),p.type==="list"&&" ⚠️"," ",(v=(f=yn[p.type])==null?void 0:f.map)==null?void 0:v.call(f,({text:y,name:w,type:C})=>p[w]?e(O,{children:[e("span",{class:"tag collapsed insignificant",children:[y,":"," ",C==="checkbox"?p[w]==="on"?"✅":"❌":p[w]]})," "]}):null)]})]})})}),e("p",{children:[e("small",{children:e(h,{id:"o6sElH"})}),e("br",{}),e("small",{children:["⚠️"," ",e(h,{id:"N4z4P/"})]})]})]}),l==="error"&&e("p",{class:"error",children:e("small",{children:["⚠️ ",e(h,{id:"ZhsPEb"})]})}),e("p",{children:[m&&e(O,{children:[e(ut,{confirmLabel:pe._({id:"6MzUUU"}),menuFooter:e("div",{class:"footer",children:e(h,{id:"nl8sCE"})}),onClick:()=>{const p=a.filter(y=>!A.shortcuts.some(w=>Object.keys(w).every(C=>w[C]===y[C])));if(!p.length){me(pe._({id:"o6L30P"}));return}let f=[...A.shortcuts,...p];const v=f.length>Ct;v&&(f=f.slice(0,Ct)),A.shortcuts=f,me(v?pe._({id:"SBmqmC",values:{SHORTCUTS_LIMIT:Ct}}):pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:e(h,{id:"c89gCv"})})})," "]}),e(ut,{confirmLabel:m?pe._({id:"6ZjzWP"}):pe._({id:"DWumLi"}),menuItemClassName:m?"danger":void 0,onClick:()=>{A.shortcuts=a,me(pe._({id:"QO9uTx"})),i==null||i()},children:e("button",{type:"button",class:"plain2",disabled:!a,children:m?pe._({id:"uIp8WL"}):pe._({id:"Sjnlwj"})})})]})]}),e("section",{children:[e("h3",{children:[e(x,{icon:"arrow-up-circle",size:"l",class:"insignificant"})," ",e("span",{children:e(h,{id:"GS+Mus"})})]}),e("p",{children:e("input",{style:{width:"100%"},type:"text",value:c,readOnly:!0,onClick:p=>{if(p.target.value){p.target.select();try{navigator.clipboard.writeText(p.target.value),me(pe._({id:"cWtH+v"}))}catch{me(pe._({id:"yUWyHa"}))}}},dir:"auto"})}),e("p",{children:[e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.clipboard.writeText(c),me(pe._({id:"+Kq2vY"}))}catch{me(pe._({id:"tFvxZF"}))}},children:[e(x,{icon:"clipboard"})," ",e("span",{children:e(h,{id:"he3ygx"})})]})," ",(navigator==null?void 0:navigator.share)&&((g=navigator==null?void 0:navigator.canShare)==null?void 0:g.call(navigator,{text:c}))&&e("button",{type:"button",class:"plain2",disabled:!c,onClick:()=>{try{navigator.share({text:c})}catch{alert(pe._({id:"TtG3Uh"}))}},children:[e(x,{icon:"share"})," ",e("span",{children:e(h,{id:"Z8lGw6"})})]})," ",A.settings.shortcutSettingsCloudImportExport&&e("button",{type:"button",class:"plain2",disabled:l==="cloud-uploading",onClick:async()=>{d("cloud-uploading");const p=yt();try{const v=(await o.v1.accounts.relationships.fetch({id:[p]}))[0];if(v){const{note:y=""}=v;let w="";const C=JSON.stringify({v:"1",dt:Date.now(),data:c});/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/.test(y)?w=y.replace(/<phanpy-shortcuts-settings>(.*)<\/phanpy-shortcuts-settings>/,`<phanpy-shortcuts-settings>${C}</phanpy-shortcuts-settings>`):w=`${y}


<phanpy-shortcuts-settings>${C}</phanpy-shortcuts-settings>`,me(pe._({id:"9ZYiLz"})),await o.v1.accounts.$select(p).note.create({comment:w}),d("default"),me(pe._({id:"5w02SH"}))}}catch{d("error"),me(pe._({id:"aVsTYo"}))}},title:pe._({id:"gWd6Cu"}),children:[e(x,{icon:"cloud"}),e(x,{icon:"arrow-up"})]})," ",c.length>0&&e("small",{class:"insignificant ib",children:e(h,{id:"IPXOXm",values:{0:c.length}})})]}),!!c&&e("details",{children:[e("summary",{class:"insignificant",children:e("small",{children:e(h,{id:"e5E+WH"})})}),e("textarea",{style:{width:"100%"},rows:10,readOnly:!0,children:JSON.stringify(n.filter(Boolean),null,2)})]})]}),A.settings.shortcutSettingsCloudImportExport&&e("footer",{children:e("p",{children:[e(x,{icon:"cloud"})," ",e(h,{id:"C4T6O/"})]})})]})]})}fs(A,n=>{for(const[i,s,o,c]of n)/^show/i.test(s)&&!o&&Jn()});function Oa(){var c,r,u,l,d,a,m,b;const{_:n}=de(),i=Ve(A),s=ps(),o=Wt();return ne(()=>{setTimeout(yo,1e3)},[]),e(O,{children:[!!i.showCompose&&e(qe,{class:`solid ${i.composerState.minimized?"min":""}`,minimized:!!i.composerState.minimized,children:e(wo,{replyToStatus:typeof i.showCompose!="boolean"?i.showCompose.replyToStatus:((c=window.__COMPOSE__)==null?void 0:c.replyToStatus)||null,editStatus:((r=A.showCompose)==null?void 0:r.editStatus)||((u=window.__COMPOSE__)==null?void 0:u.editStatus)||null,draftStatus:((l=A.showCompose)==null?void 0:l.draftStatus)||((d=window.__COMPOSE__)==null?void 0:d.draftStatus)||null,onClose:g=>{const{newStatus:p,instance:f,type:v,scheduledAt:y}=g||{};A.showCompose=!1,window.__COMPOSE__=null,p&&(A.reloadStatusPage++,y&&A.reloadScheduledPosts++,me({text:{post:n(y?{id:"IrX0sj"}:{id:"aTyHBW"}),reply:n(y?{id:"+38pse"}:{id:"lZdBKl"}),edit:n({id:"a5BN7l"})}[v||"post"],delay:1e3,duration:1e4,onClick:w=>{w.hideToast(),A.prevLocation=o,s(y?"/sp":f?`/${f}/s/${p.id}`:`/s/${p.id}`)}}))}})}),!!i.showSettings&&e(qe,{onClose:()=>{A.showSettings=!1},children:e(Rc,{onClose:()=>{A.showSettings=!1}})}),!!i.showAccounts&&e(qe,{onClose:()=>{A.showAccounts=!1},children:e(vc,{onClose:()=>{A.showAccounts=!1}})}),!!i.showAccount&&e(qe,{onClose:()=>{A.showAccount=!1},children:e(Qc,{account:((a=i.showAccount)==null?void 0:a.account)||i.showAccount,instance:(m=i.showAccount)==null?void 0:m.instance,onClose:({destination:g}={})=>{A.showAccount=!1}})}),!!i.showDrafts&&e(qe,{onClose:()=>{A.showDrafts=!1},children:e(ea,{onClose:()=>A.showDrafts=!1})}),!!i.showMediaModal&&e(qe,{onClick:g=>{(g.target===g.currentTarget||g.target.classList.contains("media"))&&(A.showMediaModal=!1)},children:e(qs,{mediaAttachments:i.showMediaModal.mediaAttachments,instance:i.showMediaModal.instance,index:i.showMediaModal.index,statusID:i.showMediaModal.statusID,onClose:()=>{A.showMediaModal=!1}})}),!!i.showShortcutsSettings&&e(qe,{onClose:()=>{A.showShortcutsSettings=!1},children:e(Pa,{onClose:()=>A.showShortcutsSettings=!1})}),!!i.showGenericAccounts&&e(qe,{onClose:()=>{A.showGenericAccounts=!1},children:e(ia,{instance:i.showGenericAccounts.instance,excludeRelationshipAttrs:i.showGenericAccounts.excludeRelationshipAttrs,postID:i.showGenericAccounts.postID,onClose:()=>A.showGenericAccounts=!1,blankCopy:i.showGenericAccounts.blankCopy})}),!!i.showMediaAlt&&e(qe,{onClose:g=>{A.showMediaAlt=!1},children:e(sa,{alt:i.showMediaAlt.alt||i.showMediaAlt,lang:(b=i.showMediaAlt)==null?void 0:b.lang,onClose:()=>{A.showMediaAlt=!1}})}),!!i.showEmbedModal&&e(qe,{class:"solid",onClose:()=>{A.showEmbedModal=!1},children:e(na,{html:i.showEmbedModal.html,url:i.showEmbedModal.url,width:i.showEmbedModal.width,height:i.showEmbedModal.height,onClose:()=>{A.showEmbedModal=!1}})}),!!i.showReportModal&&e(qe,{onClose:()=>{A.showReportModal=!1},children:e(Sa,{account:i.showReportModal.account,post:i.showReportModal.post,onClose:()=>{A.showReportModal=!1}})})]})}function ei({accountID:n,onChange:i}){const{_:s}=de(),{masto:o}=re(),[c,r]=M("default"),[u,l]=M(null),[d,a]=M(null),m=d!==null;return e("p",{class:"follow-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||m,onClick:()=>{r("loading"),l("accept"),(async()=>{try{const b=await o.v1.followRequests.$select(n).authorize();if(!(b!=null&&b.followedBy))throw new Error("Follow request not accepted");a(b),i()}catch{}r("default")})()},children:e(h,{id:"g3UF2V"})})," ",e("button",{type:"button",disabled:c==="loading"||m,class:"light danger",onClick:()=>{r("loading"),l("reject"),(async()=>{try{const b=await o.v1.followRequests.$select(n).reject();if(b!=null&&b.followedBy)throw new Error("Follow request not rejected");a(b),i()}catch{r("default")}})()},children:e(h,{id:"1t/NnN"})}),e("span",{class:"follow-request-states",children:m&&u?u==="accept"?e(x,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"follow-accepted"}):e(x,{icon:"x-circle",alt:s({id:"ekCRTP"}),class:"follow-rejected"}):e(Ue,{hidden:c!=="loading"})})]})}const Vi={mention:"comment",status:"notification",reblog:"rocket",follow:"follow",follow_request:"follow-add",favourite:"heart",poll:"poll",update:"pencil","admin.signup":"account-edit","admin.report":"account-warning",severed_relationships:"heart-break",moderation_warning:"alert",emoji_reaction:"emoji2","pleroma:emoji_reaction":"emoji2",annual_report:"celebrate"};function Gi({account:n,emoji:i,emoji_url:s}){let o,c;typeof s=="string"?o=s:(o=s==null?void 0:s.url,c=s==null?void 0:s.staticUrl);const r=o?e(Bo,{url:o,staticUrl:c,alt:i}):i;return e(h,{id:"i5uN6K",values:{account:n,emojiObject:r}})}const Yn={status:({account:n})=>e(h,{id:"idiIxW",values:{account:n}}),reblog:({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"jkt9P5",values:{0:Xe(n),1:Xe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),follow:({account:n,count:i,components:{Subject:s}})=>e(h,{id:"+71G9C",values:{0:Xe(i),count:i,account:n},components:{0:e(s,{clickable:i>1}),1:e("span",{title:i})}}),follow_request:({account:n})=>e(h,{id:"eh6NHW",values:{account:n}}),favourite:({account:n,count:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"RqX1mR",values:{0:Xe(i),1:Xe(i),count:i,postsCount:s,postType:o,account:n},components:{0:e(c,{clickable:i>1}),1:e("span",{title:i}),2:e(c,{clickable:i>1}),3:e("span",{title:i})}}),poll:()=>pe._({id:"kIlJaS"}),"poll-self":()=>pe._({id:"kpjzdN"}),"poll-voted":()=>pe._({id:"moT7M8"}),update:()=>pe._({id:"uzt17m"}),"favourite+reblog":({count:n,account:i,postsCount:s,postType:o,components:{Subject:c}})=>e(h,{id:"NunZZQ",values:{0:Xe(n),1:Xe(n),count:n,postsCount:s,postType:o,account:i},components:{0:e(c,{clickable:n>1}),1:e("span",{title:n}),2:e(c,{clickable:n>1}),3:e("span",{title:n})}}),"admin.sign_up":({account:n})=>e(h,{id:"fJCCpx",values:{account:n}}),"admin.report":({account:n,targetAccount:i})=>e(h,{id:"eNfCmq",values:{account:n,targetAccount:i}}),severed_relationships:({name:n})=>e(h,{id:"Xl9v6+",values:{name:n},components:{0:e("i",{})}}),moderation_warning:()=>e("b",{children:e(h,{id:"YqffEv"})}),emoji_reaction:Gi,"pleroma:emoji_reaction":Gi,annual_report:({year:n})=>e(h,{id:"INLTzH",values:{year:n}})},za={account_suspension:({from:n,targetName:i})=>e(h,{id:"uRkcgw",values:{from:n,targetName:i},components:{0:e("i",{}),1:e("i",{})}}),domain_block:({from:n,targetName:i,followersCount:s,followingCount:o})=>e(h,{id:"Q3yArs",values:{from:n,targetName:i,followersCount:s,followingCount:o},components:{0:e("i",{}),1:e("i",{})}}),user_domain_block:({targetName:n,followersCount:i,followingCount:s})=>e(h,{id:"RQKWUa",values:{targetName:n,followersCount:i,followingCount:s},components:{0:e("i",{})}})},Ba={none:{id:"ipnHrn"},disable:{id:"jw0eSZ"},mark_statuses_as_sensitive:{id:"v9jO+F"},delete_statuses:{id:"raUMBQ"},sensitive:{id:"w2OpMr"},silence:{id:"mlycBx"},suspend:{id:"Fz4lZ1"}},jn=30;function Ua({notification:n,instance:i,isStatic:s,disableContextMenu:o}){var U,Y,G,te,ae,ye,Ce;const{_:c}=de(),{masto:r}=re(),{id:u,status:l,account:d,report:a,event:m,moderation_warning:b,annualReport:g,_ids:p,_accounts:f,_statuses:v,_groupKeys:y,sampleAccounts:w,notificationsCount:C,groupKey:S}=n;let{type:k}=n;if(k==="mention"&&!l)return null;const T=(l==null?void 0:l.reblog)||l,_=T==null?void 0:T.id,I=yt(),R=I===(d==null?void 0:d.id),L=(U=l==null?void 0:l.poll)==null?void 0:U.voted,z=!!(l!=null&&l.inReplyToAccountId)&&(l==null?void 0:l.inReplyToAccountId)!==I&&((Y=l==null?void 0:l.account)==null?void 0:Y.id)===I;let P=0,Z=0;if(k==="favourite+reblog"){if(f)for(const j of f)(G=j._types)!=null&&G.includes("favourite")&&P++,(te=j._types)!=null&&te.includes("reblog")&&Z++;!Z&&P&&(k="favourite"),!P&&Z&&(k="reblog")}let ee;k==="poll"?ee=Yn[R?"poll-self":L?"poll-voted":"poll"]:Yn[k]?ee=Yn[k]:ee=pe._({id:"ODqZt1",values:{type:k}});const W=({clickable:j,...he})=>j?e("b",{tabIndex:"0",onClick:F,...he}):e("b",{...he});if(typeof ee=="function"){const j=(f==null?void 0:f.length)||(w==null?void 0:w.length)||(d?1:0),he=(v==null?void 0:v.length)||(l?1:0);if(k==="admin.report"){const Te=a==null?void 0:a.targetAccount;Te&&(ee=ee({account:e(mt,{account:d,showAvatar:!0}),targetAccount:e(mt,{account:Te,showAvatar:!0})}))}else if(k==="severed_relationships"){const Te=m==null?void 0:m.targetName;Te&&(ee=ee({name:Te}))}else if((k==="emoji_reaction"||k==="pleroma:emoji_reaction")&&n.emoji){const Te=n.emoji_url||((ye=(ae=l==null?void 0:l.emojis)==null?void 0:ae.find)==null?void 0:ye.call(ae,Pe=>(Pe==null?void 0:Pe.shortcode)===n.emoji.replace(/^:/,"").replace(/:$/,"")));ee=ee({account:e(mt,{account:d,showAvatar:!0}),emoji:n.emoji,emojiURL:Te})}else k==="annual_report"?ee=ee({...n.annualReport}):ee=ee({account:d?e(mt,{account:d,showAvatar:!0}):(w==null?void 0:w[0])&&e(mt,{account:w[0],showAvatar:!0}),count:j,postsCount:he,postType:z?"reply":"post",components:{Subject:W}})}const V=n.createdAt&&new Date(n.createdAt).toLocaleString(),B={"favourite+reblog":pe._({id:"+XOeb+"}),favourite:pe._({id:"LQFF6J"}),reblog:pe._({id:"phQpSa"}),follow:pe._({id:"Ih01jh"})}[k]||pe._({id:"bPwFdf"}),F=()=>{A.showGenericAccounts={heading:B,accounts:f,showReactions:k==="favourite+reblog",excludeRelationshipAttrs:k==="follow"?["followedBy"]:[],postID:at(_,i)}},$=C>0&&C>(w==null?void 0:w.length)?"remote":"local";if(l!=null&&l.filtered){const j=((Ce=l==null?void 0:l.account)==null?void 0:Ce.id)===I,he=jt(l.filtered,"notifications");if(!R&&!j&&(he==null?void 0:he.action)==="hide")return null}return e("div",{class:`notification notification-${k}`,"data-notification-id":p||u,"data-group-key":(y==null?void 0:y.join(" "))||S,tabIndex:"0",children:[e("div",{class:`notification-type notification-${k}`,title:V,children:k==="favourite+reblog"?e(O,{children:[e(x,{icon:"rocket",size:"xl",alt:k,class:"reblog-icon"}),e(x,{icon:"heart",size:"xl",alt:k,class:"favourite-icon"})]}):e(x,{icon:Vi[k]||"notification",size:"xl",alt:k})}),e("div",{class:"notification-content",children:[k!=="mention"&&e(O,{children:[e("p",{children:ee}),k==="follow_request"&&e(ei,{accountID:d.id}),k==="severed_relationships"&&e("div",{children:[za[m.type]({from:i,...m}),e("br",{}),e("a",{href:`https://${i}/severed_relationships`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(x,{icon:"external",size:"s"})}})}),"."]}),k==="moderation_warning"&&!!b&&e("div",{children:[c(Ba[b.action]()),e("br",{}),e("a",{href:`/disputes/strikes/${b.id}`,target:"_blank",rel:"noopener",children:e(h,{id:"YL6Y8P",components:{0:e(x,{icon:"external",size:"s"})}})})]}),k==="annual_report"&&e("div",{children:e(be,{to:`/annual_report/${g==null?void 0:g.year}`,children:e(h,{id:"5PGPvG"})})})]}),(f==null?void 0:f.length)>1&&e("p",{class:"avatars-stack",children:[f.slice(0,jn).map(j=>e(O,{children:[e("a",{href:j.url,rel:"noopener",class:"account-avatar-stack",onClick:he=>{he.preventDefault(),A.showAccount=j},children:[e(ft,{url:j.avatarStatic,size:f.length<=10?"xxl":f.length<20?"xl":"l",alt:`${j.displayName} @${j.acct}`,squircle:j==null?void 0:j.bot},j.id),k==="favourite+reblog"&&e("div",{class:"account-sub-icons",children:j._types.map(he=>e(x,{icon:Vi[he],size:"s",class:`${he}-icon`}))})]},j.id)," "]},j.id)),k==="favourite+reblog"&&$==="remote"?e("button",{type:"button",class:"small plain","data-group-keys":y==null?void 0:y.join(" "),onClick:()=>{A.showGenericAccounts={heading:B,fetchAccounts:async()=>{const j=await Promise.allSettled(y.map(async Te=>{const Pe=r.v2.notifications.$select(Te).accounts.list();return[Te,(await Pe.next()).value]})),he=[];for(const Te of j){const[Pe,De]=Te.value,Be=/^favourite/.test(Pe)?"favourite":/^reblog/.test(Pe)?"reblog":null;if(Be)for(const Ee of De){const Me=he.find(X=>X.id===Ee.id);Me?Me._types.push(Be):(Ee._types=[Be],he.push(Ee))}}return{done:!0,value:he}},showReactions:!0,postID:at(_,i)}},children:e(x,{icon:"chevron-down"})}):e("button",{type:"button",class:"small plain",onClick:F,children:[f.length>jn&&`+${f.length-jn}`,e(x,{icon:"chevron-down"})]})]}),!(f!=null&&f.length)&&(w==null?void 0:w.length)>1&&e("p",{class:"avatars-stack",children:[w.map(j=>e(O,{children:[e("a",{href:j.url,rel:"noopener",class:"account-avatar-stack",onClick:he=>{he.preventDefault(),A.showAccount=j},children:e(ft,{url:j.avatarStatic,size:"xxl",alt:`${j.displayName} @${j.acct}`,squircle:j==null?void 0:j.bot},j.id)},j.id)," "]},j.id)),C>w.length&&e(be,{to:i?`/${i}/s/${l.id}`:`/s/${l.id}`,class:"button small plain centered",children:["+",C-w.length,e(x,{icon:"chevron-right"})]})]}),(v==null?void 0:v.length)>1&&e("ul",{class:"notification-group-statuses",children:v.map(j=>e("li",{children:e(Ki,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${j.id}`:`/s/${j.id}`,children:e(je,{status:j,size:"s",previewMode:!0,allowContextMenu:!0})})},j.id))}),l&&(!(v!=null&&v.length)||(v==null?void 0:v.length)<=1)&&e(Ki,{class:`status-link status-type-${k}`,to:i?`/${i}/s/${_}`:`/s/${_}`,onContextMenu:o?void 0:j=>{const he=j.target.querySelector(".status");if(he){if(j.metaKey)return;j.preventDefault(),he.dispatchEvent(new MouseEvent("contextmenu",{clientX:j.clientX,clientY:j.clientY}))}},children:s?e(je,{status:T,size:"s",readOnly:!0,allowContextMenu:!0}):e(je,{statusID:_,size:"s",readOnly:!0,allowContextMenu:!0})})]})]})}function Ki(n){const i=Uo();return e(be,{...n,"data-read-more":pe._({id:"8fZueG"}),ref:i})}const an=lt(Ua,(n,i)=>{var s,o;return((s=n.notification)==null?void 0:s.id)===((o=i.notification)==null?void 0:o.id)});"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",n=>{const{type:i,id:s,accessToken:o}=(n==null?void 0:n.data)||{};i==="notification"&&(A.routeNotification={id:s,accessToken:o})});const Fa=lt(function(){const{_:i}=de();if(!("serviceWorker"in navigator))return null;const s=Ve(A),{routeNotification:o}=s,{id:c,accessToken:r}=o||{},[u,l]=M(!1);wt(()=>{if(!c||!r)return;const{instance:a}=re(),{masto:m,instance:b}=re({accessToken:r}),g=a===b,p=r?ko(r):oi();(async()=>{const f=await m.v1.notifications.$select(c).fetch();if(f&&p){const v=p.instanceURL,{type:y,status:w,account:C}=f,S=!!document.querySelector("#modal-container > *"),k=y==="follow"&&!!(C!=null&&C.id),T=!!(C!=null&&C.id),_=!!(w!=null&&w.id);k&&g?A.showAccount={account:C,instance:v}:S||!g||T&&_?l({id:c,account:p,notification:f,sameInstance:g}):_?location.hash=`/${a}/s/${w.id}`:k?location.hash=`/${a}/a/${C.id}`:location.hash="/notifications"}})()},[c,r]),wt(()=>{navigator!=null&&navigator.clearAppBadge&&navigator.clearAppBadge()},[]),Vt(a=>{a&&(navigator!=null&&navigator.clearAppBadge)&&navigator.clearAppBadge()});const d=()=>{l(!1),A.routeNotification=null,/\/notifications\?id=/i.test(location.hash)&&(location.hash="/notifications")};if(u){const{id:a,account:m,notification:b,sameInstance:g}=u;return e(qe,{onClick:p=>{p.target===p.currentTarget&&d()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:d,children:e(x,{icon:"x",alt:i({id:"yz7wBu"})})}),e("header",{children:e("b",{children:e(h,{id:"5+87Pq"})})}),e("main",{children:[!g&&e("p",{children:e(h,{id:"k9N0Xk"})}),e("div",{class:"notification-peek",onClick:p=>{const{target:f}=p;(p.target.tagName==="BUTTON"||p.target.tagName==="A")&&d()},children:e(an,{instance:m.instanceURL,notification:b,isStatic:!0})}),e("div",{style:{textAlign:"end"},children:e(be,{to:"/notifications",class:"button light",onClick:d,children:[e("span",{children:e(h,{id:"/WA/tl"})})," ",e(x,{icon:"arrow-right"})]})})]})]})})}return null}),js=So((n,i)=>{const{_:s}=de(),{instance:o}=re(),[c,r]=bt(),[u,l]=M(!1),[d,a]=M(c.get("q")||""),m=c.get("type"),b=q(null),g=q(null);return Co(i,()=>({setValue:p=>{a(p)},focus:()=>{g.current.focus()},select:()=>{g.current.select()},blur:()=>{g.current.blur()}})),e("form",{ref:b,class:"search-popover-container",onSubmit:p=>{var v;if(p.preventDefault(),/\/search/.test(location.hash))if(d){const y={q:d};m&&(y.type=m),r(y)}else r({});else d?location.hash=`/search?q=${encodeURIComponent(d)}${m?`&type=${m}`:""}`:location.hash="/search";(v=n==null?void 0:n.onSubmit)==null||v.call(n,p)},children:[e("input",{ref:g,value:d,name:"q",type:"search",placeholder:s({id:"A1taO8"}),dir:"auto",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellCheck:"false",onSearch:p=>{p.target.value||r({})},onInput:p=>{a(p.target.value),l(!0)},onFocus:()=>{var p,f;l(!0),(f=(p=b.current)==null?void 0:p.querySelector(".search-popover-item"))==null||f.classList.add("focus")},onBlur:()=>{var p,f;setTimeout(()=>{l(!1)},100),(f=(p=b.current)==null?void 0:p.querySelector(".search-popover-item.focus"))==null||f.classList.remove("focus")},onKeyDown:p=>{var v;const{key:f}=p;switch(f){case"Escape":l(!1);break;case"Down":case"ArrowDown":if(p.preventDefault(),u){const y=b.current.querySelector(".search-popover-item.focus");if(y){let w=y.nextElementSibling;for(;w&&w.hidden;)w=w.nextElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=b.current.querySelector(".search-popover-item");w&&w.classList.add("focus")}}break;case"Up":case"ArrowUp":if(p.preventDefault(),u){const y=document.querySelector(".search-popover-item.focus");if(y){let w=y.previousElementSibling;for(;w&&w.hidden;)w=w.previousElementSibling;w&&(w.classList.add("focus"),Array.from(w.parentElement.children).filter(S=>S!==w).forEach(S=>{S.classList.remove("focus")}))}else{const w=document.querySelector(".search-popover-item:last-child");w&&w.classList.add("focus")}}break;case"Enter":if(u){const y=document.querySelector(".search-popover-item.focus");y&&(p.preventDefault(),y.click()),l(!1),(v=n==null?void 0:n.onSubmit)==null||v.call(n,p)}break}}}),e("div",{class:"search-popover",hidden:!u||!d,children:!!d&&[{label:e(h,{id:"48oDit",values:{query:d},components:{0:e("small",{class:"insignificant"})}}),to:`/search?q=${encodeURIComponent(d)}`,top:!m&&!/\s/.test(d),hidden:!!m},{label:e(h,{id:"o1mMWT",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=statuses`,hidden:/^https?:/.test(d),top:/\s/.test(d),icon:"document",queryType:"statuses"},{label:e(h,{id:"YAZw8D",values:{0:d.replace(/^#/,"")},components:{0:e("mark",{})}}),to:`/${o}/t/${d.replace(/^#/,"")}`,hidden:/^@/.test(d)||/^https?:/.test(d)||/\s/.test(d),top:/^#/.test(d),type:"link",icon:"hashtag",queryType:"hashtags"},{label:e(h,{id:"gEoOUj",values:{query:d},components:{0:e("mark",{})}}),to:`/${d}`,hidden:!/^https?:/.test(d),top:/^https?:/.test(d),type:"link"},{label:e(h,{id:"cDoNQr",values:{query:d},components:{0:e("q",{})}}),to:`/search?q=${encodeURIComponent(d)}&type=accounts`,icon:"group",queryType:"accounts"}].sort((p,f)=>{if(m){if(p.queryType===m)return-1;if(f.queryType===m)return 1}return p.top&&!f.top?-1:!p.top&&f.top?1:0}).filter(({hidden:p})=>!p).map(({label:p,to:f,icon:v,type:y},w)=>e(be,{to:f,class:`search-popover-item ${w===0?"focus":""}`,onClick:C=>{var S;(S=n==null?void 0:n.onSubmit)==null||S.call(n,C)},children:[e(x,{icon:v||(y==="link"?"arrow-right":"search"),class:"more-insignificant"}),e("span",{children:p})," "]}))})]})}),Ha=lt(function({onClose:i=()=>{}}){const[s,o]=M(!1),c=q(null);He(["Slash","/"],u=>{o(!0),setTimeout(()=>{var l,d,a,m;(d=(l=c.current)==null?void 0:l.focus)==null||d.call(l),(m=(a=c.current)==null?void 0:a.select)==null||m.call(a)},0)},{preventDefault:!0,ignoreEventWhen:u=>{const l=/\/search/.test(location.hash),d=!!document.querySelector("#modal-container > *");return l||d}});const r=()=>{o(!1),i()};return He("esc",u=>{var l,d;(d=(l=c.current)==null?void 0:l.blur)==null||d.call(l),r()},{enabled:s,enableOnFormTags:!0,preventDefault:!0}),e("div",{id:"search-command-container",hidden:!s,onClick:u=>{u.target===u.currentTarget&&r()},children:e(js,{ref:c,onSubmit:()=>{r()}})})});function qa(){const{_:n,_:i}=de(),{instance:s}=re(),o=Ve(A),{shortcuts:c,settings:r}=o;if(!c.length)return null;const u=r.shortcutsViewMode==="multi-column"||!r.shortcutsViewMode&&r.shortcutsColumnsMode;if(u)return null;const l=q(),d=q(!1),a=c.map((p,f)=>{const{type:v,...y}=p;if(!Rn[v])return null;let{id:w,path:C,title:S,subtitle:k,icon:T}=Rn[v];return typeof w=="function"&&(w=w(y,f)),typeof C=="function"&&(C=C({...y,instance:y.instance||s},f)),typeof S=="function"?S=S(y,f):S=i(S),typeof k=="function"?k=k(y,f):k=i(k),typeof T=="function"&&(T=T(y,f)),w==="lists"&&(d.current=!0),{id:w,path:C,title:S,subtitle:k,icon:T}}).filter(Boolean),m=ps();He(["1","2","3","4","5","6","7","8","9"],(p,f)=>{var y,w;const v=parseInt(f.keys[0],10)-1;if(v<a.length){const{path:C}=a[v];C&&(m(C),(w=(y=l.current)==null?void 0:y.closeMenu)==null||w.call(y))}},{enabled:!u});const[b,g]=M([]);return e("div",{id:"shortcuts",children:o.settings.shortcutsViewMode==="tab-menu-bar"?e("nav",{class:"tab-bar",onContextMenu:p=>{p.preventDefault(),A.showShortcutsSettings=!0},children:e("ul",{children:a.map(({id:p,path:f,title:v,subtitle:y,icon:w},C)=>e("li",{children:e(be,{class:y?"has-subtitle":"",to:f,onClick:S=>{if(S.target.classList.contains("is-active")){S.preventDefault();const k=document.getElementById(`${p}-page`);if(k){k.scrollTop=0;const T=k.querySelector(".updates-button");T&&T.click()}}},children:[e(x,{icon:w,size:"xl",alt:v}),e("span",{children:[e(vn,{children:v}),y&&e(O,{children:[e("br",{}),e("small",{children:y})]})]})]})},`${C}-${p}-${v}-${y}-${f}`))})}):e(rt,{instanceRef:l,overflow:"auto",viewScroll:"close",menuClassName:"glass-menu shortcuts-menu",gap:8,position:"anchor",onMenuChange:p=>{p.open&&d.current&&ln().then(g)},menuButton:e("button",{type:"button",id:"shortcuts-button",class:"plain",onContextMenu:p=>{p.preventDefault(),A.showShortcutsSettings=!0},onTransitionStart:p=>{var f,v;try{const{target:y}=p;getComputedStyle(y).pointerEvents==="none"&&((v=(f=l.current)==null?void 0:f.closeMenu)==null||v.call(f))}catch{}},children:e(x,{icon:"shortcut",size:"xl",alt:n({id:"CTqTgr"})})}),children:a.map(({id:p,path:f,title:v,subtitle:y,icon:w},C)=>p==="lists"?e(rn,{menuClassName:"glass-menu",overflow:"auto",gap:-8,label:e(O,{children:[e(x,{icon:w,size:"l"}),e("span",{class:"menu-grow",children:e(vn,{children:v})}),e(x,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),e(Ze,{}),b==null?void 0:b.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]}):e(Ye,{to:f,class:"glass-menu-item",children:[e(x,{icon:w,size:"l"})," ",e("span",{class:"menu-grow",children:[e("span",{children:e(vn,{children:v})}),y&&e(O,{children:[" ",e("small",{class:"more-insignificant",children:y})]})]}),e("span",{class:"menu-shortcut hide-until-focus-visible",children:C+1})]},`${C}-${p}-${v}-${y}-${f}`))})})}const Ya=lt(qa);function ja(n){var c;let i=[],s=[],o=0;for(let r=0;r<n.length;r++){const u=n[r];u.reblog&&!((c=u.account)!=null&&c.group)?(s.push(u),o++):(i.push(u),o<3&&(o=0))}if(n.length>10&&(s.length>n.length/4||o>=3)){const r=s.map(u=>u.id);if(s.length>n.length*3/4)i=[...i,{id:r,items:s,type:"boosts"}];else{const u=Math.floor(i.length/2);i=[...i.slice(0,u),{id:r,items:s,type:"boosts"},...i.slice(u)]}return i}else return n}function Zi(n,i){const s=ke.account.get("boostedStatusIDs")||{},o=n.filter(r=>{if(!r.reblog)return!0;const u=`${i}-${r.reblog.id}`,l=s[u];return l&&l!==r.id?!1:(s[u]=r.id,!0)}),c=Object.keys(s);return c.length>50&&c.slice(0,c.length-50).forEach(r=>{delete s[r]}),ke.account.set("boostedStatusIDs",s),o}function Va(n,i){const s=[];let o=0;n.forEach(l=>{for(let a=0;a<s.length;a++){if(s[a].find(m=>m.id===l.id))return;if(s[a].find(m=>m.id===l.inReplyToId)||s[a].find(m=>m.inReplyToId===l.id)){s[a].push(l);return}}const d=n.find(a=>a.id===l.inReplyToId);d&&(s[o++]=[l,d])});for(let l=0;l<s.length;l++)for(let d=l+1;d<s.length;d++)s[l].find(m=>s[d].includes(m))&&(s[l]=[...s[l],...s[d]],s[l]=s[l].filter((m,b,g)=>g.findIndex(p=>p.id===m.id)===b),s.splice(d,1),d--);s.forEach(l=>{l.sort((d,a)=>!d.inReplyToId&&!a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):d.inReplyToId===a.id?1:a.inReplyToId===d.id||!d.inReplyToId?-1:a.inReplyToId?new Date(d.createdAt)-new Date(a.createdAt):1)}),s.forEach(l=>{const d=l[0].account.id;l.forEach(a=>{a.account.id!==d&&(a._differentAuthor=!0)})}),s.length;const c=[],r=[],u=[];return n.forEach(l=>{if(l.reblog){c.push(l);return}for(let d=0;d<s.length;d++)if(s[d].find(a=>a.id===l.id)){if(r.includes(d))return;const a=s[d];a.sort((b,g)=>{const p=new Date(b.createdAt),f=new Date(g.createdAt);return p-f});const m=a[0].account.id;c.push({id:a.map(b=>b.id),items:a,type:a.every(b=>b.account.id===m)?"thread":"conversation"}),r.push(d);return}if(l.inReplyToId&&l.inReplyToAccountId!==l.account.id){const d=at(l.id,i);A.statusReply[d]||u.push({sKey:d,inReplyToId:l.inReplyToId})}c.push(l)}),u!=null&&u.length&&queueMicrotask(()=>{const{masto:l}=re({instance:i});async function d(){for(let a=0;a<u.length;a++){const{sKey:m,inReplyToId:b}=u[a];try{const g=await Ga(b,l);Je(g,i,{skipThreading:!0}),A.statusReply[m]={id:g.id,instance:i},await new Promise(p=>setTimeout(p,1e3))}catch{}}}if(et("@mastodon/fetch-multiple-statuses")){const a=u.map(({inReplyToId:m})=>m);(async()=>{var m;try{const b=await l.v1.statuses.list({id:a});if(b!=null&&b.length)for(const g of b){Je(g,i,{skipThreading:!0});const p=(m=u.find(({inReplyToId:f})=>f===g.id))==null?void 0:m.sKey;p&&(A.statusReply[p]={id:g.id,instance:i})}else d()}catch{d()}})()}else d()}),c}const Ga=gt((n,i)=>i.v1.statuses.$select(n).fetch());async function Vs(n,i){const s=await Ea();if(!s.length)return;const{statusFollowedTags:o}=A,c=[];if(n.forEach(r=>{var g;if(r.reblog)return;const{id:u,content:l,tags:d=[]}=r,a=at(u,i);if((g=o[a])!=null&&g.length)return;const m=Ma(l);if(!m.length&&!d.length)return;const b=s.reduce((p,f)=>((m.some(v=>v.toLowerCase()===f.name.toLowerCase())||d.some(v=>v.name.toLowerCase()===f.name.toLowerCase()))&&p.push(f.name),p),[]);b.length&&c.push({item:r,sKey:a,followedTags:b})}),c.length){const r=c.map(l=>l.item.account),u=await di(r);if(!u)return;c.forEach(l=>{const{item:d,sKey:a,followedTags:m}=l,b=u[d.account.id];b&&!b.following&&(o[a]=m)})}}function Ka(){A.statusFollowedTags={}}function Za({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:r="vertical",distanceFromStartPx:u,distanceFromEndPx:l}={}){const[d,a]=M(null),[m,b]=M(!1),[g,p]=M(!1),[f,v]=M(!1),[y,w]=M(!1),C=r==="vertical";return wt(()=>{const S=n.current;if(!S)return{};let k=C?S.scrollTop:S.scrollLeft;function T(){const{scrollTop:_,scrollLeft:I,scrollHeight:R,scrollWidth:L,clientHeight:z,clientWidth:P}=S,Z=C?_:I,ee=C?R:L,W=C?z:P,V=Math.abs(Z-k),B=u||Math.min(W*i,ee,Z),F=l||Math.min(W*s,ee,ee-Z-W);V>=(k<Z?c:o)&&(a(k<Z?"end":"start"),k=Z),b(Z<=0),p(Z+W>=ee),v(Z<=B),w(Z+W>=ee-F)}return S.addEventListener("scroll",T,{passive:!0}),()=>S.removeEventListener("scroll",T)},[i,s,o,c]),{scrollDirection:d,reachStart:m,reachEnd:g,nearReachStart:f,nearReachEnd:y,init:()=>{n.current&&n.current.dispatchEvent(new Event("scroll"))}}}function Wa({scrollableRef:n,distanceFromStart:i=1,distanceFromEnd:s=1,scrollThresholdStart:o=10,scrollThresholdEnd:c=10,direction:r="vertical",distanceFromStartPx:u,distanceFromEndPx:l,init:d}={},a,m){if(!a)return;const b=r==="vertical",g=q(null),p=q(null),f=Fo(()=>{let v=!1,y=!1,w=!1,C=!1;const S=n.current,{scrollTop:k,scrollLeft:T,scrollHeight:_,scrollWidth:I,clientHeight:R,clientWidth:L}=S,z=b?k:T,P=b?_:I,Z=b?R:L,ee=Math.abs(z-g.current),W=u||Math.min(Z*i,P,z),V=l||Math.min(Z*s,P,P-z-Z);ee>=(g.current<z?c:o)&&(p.current=g.current<z?"end":"start",g.current=z),v=z<=0,y=z+Z>=P,w=z<=W,C=z+Z>=P-V,a({scrollDirection:p.current,reachStart:v,reachEnd:y,nearReachStart:w,nearReachEnd:C})},500);wt(()=>{const v=n.current;return v?(g.current=v[b?"scrollTop":"scrollLeft"],v.addEventListener("scroll",f,{passive:!0}),()=>v.removeEventListener("scroll",f)):{}},[i,s,o,c,...m]),ne(()=>{d&&n.current&&queueMicrotask(()=>{n.current.dispatchEvent(new Event("scroll"))})},[d])}function Xa({class:n,statusID:i,status:s,instance:o,parent:c,onMediaClick:r}){const{_:u}=de();let l=at(i,o);const d=Ve(A);if(s||(s=d.statuses[l]||d.statuses[i],l=at(s==null?void 0:s.id,o)),!s)return null;const{account:{acct:a,avatar:m,avatarStatic:b,id:g,url:p,displayName:f,username:v,emojis:y,bot:w,group:C},id:S,repliesCount:k,reblogged:T,reblogsCount:_,favourited:I,favouritesCount:R,bookmarked:L,poll:z,muted:P,sensitive:Z,spoilerText:ee,visibility:W,language:V,editedAt:B,filtered:F,card:se,createdAt:$,inReplyToId:U,inReplyToAccountId:Y,content:G,mentions:te,mediaAttachments:ae,reblog:ye,uri:Ce,url:j,emojis:he,_deleted:Te,_pinned:Pe}=s;if(!(ae!=null&&ae.length))return null;const De=ge=>{ge.shiftKey},Be=_e(()=>yt(),[]),Ee=_e(()=>Be&&Be===g,[g,Be]),Me=_o(Is),X=!Ee&&jt(F,Me);if((X==null?void 0:X.action)==="hide")return null;const Ie=Z,fe=_e(()=>{var N;return((N=(ke.account.get("preferences")||{})["reading:expand:media"])==null?void 0:N.toLowerCase())||"default"},[])==="show_all",Q=c||"div";return ae.map((ge,N)=>{const ie=`${l}-${ge.id}`,ue=X==null?void 0:X.titlesStr;return e(Q,{"data-state-post-id":l,onMouseEnter:De,"data-spoiler-text":ee||(Z?u({id:"FKojeB"}):void 0),"data-filtered-text":X?u(ue?{id:"7FGvtQ",values:{filterTitleStr:ue}}:{id:"03Qqf9"}):void 0,class:`
          media-post
          ${X?"filtered":""}
          ${Ie?"has-spoiler":""}
          ${fe?"show-media":""}
        `,children:e(_s,{class:n,media:ge,lang:V,to:`/${o}/s/${S}?media-only=${N+1}`,onClick:r?D=>r(D,N,ge,s):void 0})},ie)})}const Wi=lt(Xa);function Ja(n){var S,k,T,_,I;const{_:i}=de(),s=Ve(A),{masto:o,instance:c,authenticated:r}=re(),[u,l]=_e(()=>{const R=ke.local.getJSON("accounts")||[];return[R.find(z=>z.info.id===yt())||R[0],R.length>1]},[]),d=(s.settings.shortcutsViewMode==="multi-column"||!s.settings.shortcutsViewMode&&s.settings.shortcutsColumnsMode)&&!s.shortcuts.find(R=>R.type==="following"),a=bs(()=>{A.showAccounts=!0},{threshold:600,detect:"touch",cancelOnMovement:!0}),m=q(),[b,g]=M(void 0),p=ys([0,0,s.settings.shortcutsViewMode==="tab-menu-bar"?50:0,0]),f=q();async function v(R){return(R||!f.current)&&(f.current=o.v1.mutes.list({limit:80})),await f.current.next()}const y=q();async function w(R){return(R||!y.current)&&(y.current=o.v1.blocks.list({limit:80})),await y.current.next()}const C=q();return e(O,{children:[e("button",{ref:m,type:"button",class:`button plain nav-menu-button ${l?"with-avatar":""} ${b==="open"?"active":""}`,style:{position:"relative"},onClick:()=>{C.current=Date.now(),g(R=>R?void 0:"open")},onContextMenu:R=>{R.preventDefault(),A.showAccounts=!0},...a(),children:[l&&e(ft,{url:((S=u==null?void 0:u.info)==null?void 0:S.avatar)||((k=u==null?void 0:u.info)==null?void 0:k.avatarStatic),size:"l",squircle:(T=u==null?void 0:u.info)==null?void 0:T.bot}),e(x,{icon:"menu",size:l?"s":"l",alt:i({id:"zucql+"})})]}),e(li,{menuClassName:"nav-menu",state:b,anchorRef:m,onClose:()=>{g(void 0)},containerProps:{style:{zIndex:10},onClick:()=>{Date.now()-C.current<300}},portal:{target:document.body},...n,overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:p,unmountOnClose:!0,children:[!!((_=s.appVersion)!=null&&_.commitHash)&&s.appVersion.commitHash!=="649de8ca"&&e("div",{class:"top-menu",children:[e(Se,{onClick:()=>{confirm(i({id:"Djbaby"}))&&(async()=>{try{location.reload()}catch{}})()},children:[e(x,{icon:"sparkles",class:"sparkle-icon",size:"l"})," ",e("span",{children:e(h,{id:"95IFnD"})})]}),e(Ze,{})]}),e("section",{children:[e(Ye,{to:"/",children:[e(x,{icon:"home",size:"l"})," ",e("span",{children:e(h,{id:"i0qMbr"})})]}),r?e(O,{children:[d&&e(Ye,{to:"/following",children:[e(x,{icon:"following",size:"l"})," ",e("span",{children:e(h,{id:"following.title"})})]}),e(Ye,{to:"/catchup",children:[e(x,{icon:"history2",size:"l"}),e("span",{children:e(h,{id:"xrl8fj"})})]}),et("@mastodon/mentions")&&e(Ye,{to:"/mentions",children:[e(x,{icon:"at",size:"l"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(Ye,{to:"/notifications",children:[e(x,{icon:"notification",size:"l"})," ",e("span",{children:e(h,{id:"iDNBZe"})}),s.notificationsShowNew&&e("sup",{title:i({id:"isRobC"}),style:{opacity:.5},children:[" ","•"]})]}),e(Ze,{}),((I=u==null?void 0:u.info)==null?void 0:I.id)&&e(Ye,{to:`/${c}/a/${u.info.id}`,children:[e(x,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"vERlcd"})})]}),e(Qa,{menuState:b}),e(Ye,{to:"/b",children:[e(x,{icon:"bookmark",size:"l"})," ",e("span",{children:e(h,{id:"7Ff7ia"})})]}),e(rn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(x,{icon:"more",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"24misb"})}),e(x,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/f",children:[e(x,{icon:"heart",size:"l"})," ",e("span",{children:e(h,{id:"zZOZj7"})})]}),e(Ye,{to:"/fh",children:[e(x,{icon:"hashtag",size:"l"})," ",e("span",{children:e(h,{id:"Xi1/bw"})})]}),e(Ye,{to:"/sp",children:[e(x,{icon:"schedule",size:"l"})," ",e("span",{children:e(h,{id:"+GkIdc"})})]}),e(Ze,{}),et("@mastodon/filters")&&e(Ye,{to:"/ft",children:[e(x,{icon:"filters",size:"l"})," ",e("span",{children:e(h,{id:"cSev+j"})})]}),e(Se,{onClick:()=>{A.showGenericAccounts={id:"mute",heading:i({id:"sOKhEA"}),fetchAccounts:v,excludeRelationshipAttrs:["muting"]}},children:[e(x,{icon:"mute",size:"l"})," ",e("span",{children:e(h,{id:"n1sANU"})})]}),e(Se,{onClick:()=>{A.showGenericAccounts={id:"block",heading:i({id:"nL8nlr"}),fetchAccounts:w,excludeRelationshipAttrs:["blocking"]}},children:[e(x,{icon:"block",size:"l"})," ",e("span",{children:e(h,{id:"r3RRWo"})})]})," "]}),e(Ze,{}),e(Se,{onClick:()=>{A.showAccounts=!0},children:[e(x,{icon:"group",size:"l"})," ",e("span",{children:e(h,{id:"7e0O8Z"})})]})]}):e(O,{children:[e(Ze,{}),e(Ye,{to:"/login",children:[e(x,{icon:"user",size:"l"})," ",e("span",{children:e(h,{id:"sQia9P"})})]})]})]}),e("section",{children:[e(Ze,{}),e(Ye,{to:"/search",children:[e(x,{icon:"search",size:"l"})," ",e("span",{children:e(h,{id:"A1taO8"})})]}),e(Ye,{to:`/${c}/trending`,children:[e(x,{icon:"chart",size:"l"})," ",e("span",{children:e(h,{id:"4/iCqx"})})]}),e(Ye,{to:`/${c}/p/l`,children:[e(x,{icon:"building",size:"l"})," ",e("span",{children:e(h,{id:"d5zxa4"})})]}),e(Ye,{to:`/${c}/p`,children:[e(x,{icon:"earth",size:"l"})," ",e("span",{children:e(h,{id:"4ERYY7"})})]}),r?e(O,{children:[e(Ze,{className:"divider-grow"}),e(Se,{onClick:()=>{A.showKeyboardShortcutsHelp=!0},children:[e(x,{icon:"keyboard",size:"l"})," ",e("span",{children:e(h,{id:"77Emn0"})})]}),e(Se,{onClick:()=>{A.showShortcutsSettings=!0},children:[e(x,{icon:"shortcut",size:"l"})," ",e("span",{children:e(h,{id:"8Kudkr"})})]}),e(Se,{onClick:()=>{A.showSettings=!0},children:[e(x,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]}):e(O,{children:[e(Ze,{}),e(Se,{onClick:()=>{A.showSettings=!0},children:[e(x,{icon:"gear",size:"l"})," ",e("span",{children:e(h,{id:"uVbUP8"})})]})]})]})]})]})}function Qa({menuState:n}){const i=et("@mastodon/lists"),[s,o]=M([]);return ne(()=>{i&&n==="open"&&ln().then(o)},[n,i]),s.length>0?e(rn,{menuClassName:"nav-submenu",overflow:"auto",gap:-8,label:e(O,{children:[e(x,{icon:"list",size:"l"}),e("span",{class:"menu-grow",children:e(h,{id:"h16FyT"})}),e(x,{icon:"chevron-right"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(s==null?void 0:s.length)>0&&e(O,{children:[e(Ze,{}),s.map(c=>e(Ye,{to:`/l/${c.id}`,children:e("span",{children:c.title})},c.id))]})]}):i&&e(Ye,{to:"/l",children:[e(x,{icon:"list",size:"l"}),e("span",{children:e(h,{id:"h16FyT"})})]})}const Lt=lt(Ja),un={block:"start",inline:"center",behavior:"smooth"};function xt({title:n,titleComponent:i,id:s,instance:o,emptyText:c,errorText:r,useItemID:u,boostsCarousel:l,fetchItems:d=()=>{},checkForUpdates:a=()=>{},checkForUpdatesInterval:m=15e3,headerStart:b,headerEnd:g,timelineStart:p,refresh:f,view:v,filterContext:y,showFollowedTags:w,showReplyParent:C,clearWhenRefresh:S}){const{_:k}=de(),T=Ve(A),[_,I]=M([]),[R,L]=M("start"),[z,P]=M(!1),[Z,ee]=M(!1),[W,V]=M(!0),B=q();__BENCHMARK.start(`timeline-${s}-load`);const F=_e(()=>ci(),[]),se=v!=="media",$=q(0),U=Ho(X=>{ee(!1),L("loading"),(async()=>{try{const Ie=$.current=Date.now();let{done:Ne,value:fe}=await d(X);if(Ie!==$.current)return;if(Array.isArray(fe)){const[Q,ge]=fe.reduce((N,ie)=>(ie._pinned?N[0].push(ie):N[1].push(ie),N),[[],[]]);fe=ge,se&&(l&&(fe=ja(fe)),fe=Va(fe,o)),Q.length&&(fe=Q.concat(fe)),I(X?fe:N=>[...N,...fe]),fe.length||(Ne=!0),P(!Ne)}else P(!1);L("default"),__BENCHMARK.end(`timeline-${s}-load`)}catch{L("error"),X&&!_.length&&r&&me(r)}finally{U.cancel()}})()},1e3,{leading:!0}),Y=".timeline-item, .timeline-item-alt",G=He("j, shift+j",(X,Ie)=>{const Ne=document.activeElement.closest(Y),fe=Ne==null?void 0:Ne.getBoundingClientRect(),Q=Array.from(B.current.querySelectorAll(Y)).filter(ge=>!!ge.offsetHeight);if(Ne&&fe.top<B.current.clientHeight&&fe.bottom>0){const ge=Q.indexOf(Ne);let N=Q[ge+1];Ie.shift&&(N=Q.find((ie,ue)=>ue>ge&&!ie.classList.contains("timeline-item-alt"))),N&&(N.focus(),N.scrollIntoView(un))}else{const ge=Q.find(N=>{const ie=N.getBoundingClientRect();return ie.top>=44&&ie.left>=0});ge&&(ge.focus(),ge.scrollIntoView(un))}}),te=He("k, shift+k",(X,Ie)=>{const Ne=document.activeElement.closest(Y),fe=Ne==null?void 0:Ne.getBoundingClientRect(),Q=Array.from(B.current.querySelectorAll(Y)).filter(ge=>!!ge.offsetHeight);if(Ne&&fe.top<B.current.clientHeight&&fe.bottom>0){const ge=Q.indexOf(Ne);let N=Q[ge-1];Ie.shift&&(N=Q.findLast((ie,ue)=>ue<ge&&!ie.classList.contains("timeline-item-alt"))),N&&(N.focus(),N.scrollIntoView(un))}else{const ge=Q.find(N=>{const ie=N.getBoundingClientRect();return ie.top>=44&&ie.left>=0});ge&&(ge.focus(),ge.scrollIntoView(un))}}),ae=He(["enter","o"],()=>{const X=document.activeElement;X!=null&&X.matches(Y)&&X.click()}),ye=_.length>0&&R!=="loading"&&Z,Ce=st(()=>{var X;ye&&U(!0),(X=B.current)==null||X.scrollTo({top:0,behavior:"smooth"})},[U,ye]),j=He(".",Ce),he=q(),[Te,Pe]=M(!1);Wa({scrollableRef:B,distanceFromEnd:2,scrollThresholdStart:44},({scrollDirection:X,nearReachStart:Ie,reachStart:Ne})=>{if(he.current){const fe=X==="end"&&!Ie;he.current.hidden=fe}Pe(Ie),Ne&&U(!0)},[]),ne(()=>{var X;(X=B.current)==null||X.scrollTo({top:0}),U(!0)},[]);const De=q(!0);ne(()=>{var X;if(De.current){De.current=!1;return}S&&(_!=null&&_.length)&&((X=U.cancel)==null||X.call(U),I([])),U(!0)},[S,f]);const Be=q(v);ne(()=>{Be.current!==v&&(Be.current=v,I([]))},[v]);const Ee=st(async({disableIdleCheck:X=!1}={})=>{const Ie=B.current?getComputedStyle(B.current).pointerEvents==="none":!1;T.settings.autoRefresh&&B.current.scrollTop<16&&(X||window.__IDLE__)&&!ir()&&!Ie?U(!0):await a()&&ee(!0)},[s,U,a,T.settings.autoRefresh]),Me=q();return Vt(X=>{if(X){const Ie=Date.now()-Me.current;(!Me.current||Ie>1e3*3)&&Ee({disableIdleCheck:!0})}else Me.current=Date.now();V(X)},[a,Ee,T.settings.autoRefresh]),ri(Ee,W&&!Z?m*(Te?1:2):null),e(Is.Provider,{value:y,children:e("div",{id:`${s}-page`,class:`deck-container ${F?"deck-container-media-first":""}`,ref:X=>{B.current=X,G(X),te(X),ae(X),j(X)},tabIndex:"-1",onClick:X=>{he.current&&X.target.closest(".timeline-item, .timeline-item-alt")&&setTimeout(()=>{he.current.hidden=!1},250)},children:e("div",{class:"timeline-deck deck",children:[e("header",{ref:he,onClick:X=>{var Ie;X.target.closest("a, button")||(Ie=B.current)==null||Ie.scrollTo({top:0,behavior:"smooth"})},onDblClick:X=>{X.target.closest("a, button")||U(!0)},class:R==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),b??e(be,{to:"/",class:"button plain home-button",children:e(x,{icon:"home",size:"l",alt:k({id:"i0qMbr"})})})]}),n&&(i||e("h1",{children:n})),e("div",{class:"header-side",children:!!g&&g})]}),ye&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:Ce,children:[e(x,{icon:"arrow-up"})," ",e(h,{id:"2yr1/p"})]})]}),!!p&&e("div",{class:`timeline-start ${R==="loading"?"loading":""}`,children:p}),_.length?e(O,{children:[e("ul",{class:`timeline ${v?`timeline-${v}`:""}`,children:[_.map(X=>e(er,{status:X,instance:o,useItemID:u,filterContext:y,view:v,showFollowedTags:w,showReplyParent:C,mediaFirst:F},X.id+(X==null?void 0:X._pinned)+v)),z&&R==="loading"&&(v==="media"?null:e(O,{children:[e("li",{style:{height:"20vh"},children:e(je,{skeleton:!0,mediaFirst:F})}),e("li",{style:{height:"25vh"},children:e(je,{skeleton:!0,mediaFirst:F})})]}))]}),R==="default"&&(z?e(_t,{root:B.current,rootMargin:`0px 0px ${screen.height*1.5}px 0px`,onChange:X=>{X&&U()},children:e("button",{type:"button",class:"plain block",onClick:()=>U(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}))]}):R==="loading"?e("ul",{class:"timeline",children:Array.from({length:5}).map((X,Ie)=>v==="media"?e("div",{style:{height:"50vh"}}):e("li",{children:e(je,{skeleton:!0,mediaFirst:F})},Ie))}):R!=="error"&&R!=="start"&&e("p",{class:"ui-state",children:c}),R==="error"&&e("p",{class:"ui-state",children:[r,e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>U(!_.length),children:e(h,{id:"KDw4GX"})})]})]})})})}const er=lt(({status:n,instance:i,useItemID:s,filterContext:o,view:c,showFollowedTags:r,showReplyParent:u,mediaFirst:l})=>{const{_:d}=de(),{id:a,reblog:m,items:b,type:g,_pinned:p}=n;p&&(s=!1);const f=(m==null?void 0:m.id)||a,v=i?`/${i}/s/${f}`:`/s/${f}`;if(b){let w=Nt(b,o),C="";if(g==="boosts"?C=pe._({id:"NuqppG",values:{0:w.length}}):g==="pinned"&&(C=d({id:"GlfmCu"})),g==="boosts"||g==="pinned"){const T=new Set;if(w.sort((_,I)=>{const R=jt(_.filtered,o),L=jt(I.filtered,o);return R&&T.add(_.id),L&&T.add(I.id),R&&!L?1:!R&&L?-1:0}),T.size>=2){const I=[],R=[];w.forEach(z=>{T.has(z.id)?R.push(z):I.push(z)});const L=[];for(let z=0;z<R.length;z+=5)L.push({_grouped:!0,posts:R.slice(z,z+5)});w=I.concat(L)}return e("li",{class:"timeline-item-carousel",children:e(tr,{title:C,class:`${g}-carousel`,children:w.map(_=>{const{id:I,reblog:R,_pinned:L,_grouped:z}=_;if(z)return e("li",{class:"timeline-item-carousel-group",children:_.posts.map(ee=>{const{id:W,reblog:V,_pinned:B}=ee,F=(V==null?void 0:V.id)||W,se=i?`/${i}/s/${F}`:`/s/${F}`;return B&&(s=!1),e(be,{class:"status-carousel-link timeline-item-alt",to:se,children:s?e(je,{statusID:W,instance:i,size:"s"}):e(je,{status:ee,instance:i,size:"s"})})})},I);const P=(R==null?void 0:R.id)||I,Z=i?`/${i}/s/${P}`:`/s/${P}`;return L&&(s=!1),e("li",{children:e(be,{class:"status-carousel-link timeline-item-alt",to:Z,children:s?e(je,{statusID:I,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:l}):e(je,{status:_,instance:i,size:"s",contentTextWeight:!0,enableCommentHint:!0,mediaFirst:l})})},I)})})},`timeline-${a}`)}const k=w.length>3;return w.map((T,_)=>{const{id:I,_differentAuthor:R}=T,L=i?`/${i}/s/${I}`:`/s/${I}`,z=_>0&&_<w.length-1,P=T.sensitive&&!!T.spoilerText,Z=!R&&P&&_>0||k&&z&&(g==="thread"||g==="conversation"&&!R&&!w[_-1]._differentAuthor&&!w[_+1]._differentAuthor),ee=_===0,W=_===w.length-1;return e("li",{class:`timeline-item-container timeline-item-container-type-${g} timeline-item-container-${ee?"start":W?"end":"middle"} ${R?"timeline-item-diff-author":""}`,children:e(be,{class:"status-link timeline-item",to:L,children:Z?e(nr,{status:T,instance:i,filterContext:o}):s?e(je,{statusID:I,instance:i,enableCommentHint:W,showFollowedTags:r}):e(je,{status:T,instance:i,enableCommentHint:W,showFollowedTags:r})})},`timeline-${I}`)})}const y=`timeline-${a+p}`;return c==="media"?s?e(Wi,{class:"timeline-item",parent:"li",statusID:a,instance:i},y):e(Wi,{class:"timeline-item",parent:"li",status:n,instance:i},y):e("li",{children:e(be,{class:"status-link timeline-item",to:v,children:s?e(je,{statusID:a,instance:i,enableCommentHint:!0,showFollowedTags:r,showReplyParent:u,mediaFirst:l}):e(je,{status:n,instance:i,enableCommentHint:!0,showFollowedTags:r,showReplyParent:u,mediaFirst:l})})},y)},(n,i)=>{var c,r;const s=(((c=n.status)==null?void 0:c.id)||"").toString(),o=(((r=i.status)==null?void 0:r.id)||"").toString();return s===o&&n.instance===i.instance&&n.view===i.view});function tr({title:n,class:i,children:s}){const{_:o}=de(),c=q(),r=q(),u=q(),[l,d]=M(!1);return ne(()=>{setTimeout(()=>{d(!0)},1)},[]),e("div",{class:`status-carousel ${i}`,children:[e("header",{children:[e("h3",{children:n}),e("span",{children:[e("button",{ref:r,type:"button",class:"small plain2",onClick:()=>{var m,b;const a=Math.min(320,(m=c.current)==null?void 0:m.offsetWidth)*(Dt()?1:-1);(b=c.current)==null||b.scrollBy({left:a,behavior:"smooth"})},children:e(x,{icon:"chevron-left",alt:o({id:"DHhJ7s"})})})," ",e("button",{ref:u,type:"button",class:"small plain2",onClick:()=>{var m,b;const a=Math.min(320,(m=c.current)==null?void 0:m.offsetWidth)*(Dt()?-1:1);(b=c.current)==null||b.scrollBy({left:a,behavior:"smooth"})},children:e(x,{icon:"chevron-right",alt:o({id:"hXzOVo"})})})]})]}),e("ul",{ref:c,children:[e(_t,{class:"status-carousel-beacon",onChange:a=>{r.current&&(r.current.disabled=a)}}),s[0],l&&s.slice(1),e(_t,{class:"status-carousel-beacon",onChange:a=>{u.current&&(u.current.disabled=a)}})]})]})}function nr({status:n,instance:i,filterContext:s}){const{_:o}=de(),c=Ve(A),{id:r,visibility:u,language:l}=n,d=Mn(n),a=at(r,i),m=jt(n.filtered,s);return e("article",{class:`status compact-thread ${u==="direct"?"visibility-direct":""}`,tabindex:"-1",children:[c.statusThreadNumber[a]?e("div",{class:"status-thread-badge",children:[e(x,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})}),c.statusThreadNumber[a]?` ${c.statusThreadNumber[a]}/X`:""]}):e("div",{class:"status-thread-badge",children:e(x,{icon:"thread",size:"s",alt:o({id:"e66y2Z"})})}),e("div",{class:"content-compact",title:d,lang:l,dir:"auto",children:m?e("b",{class:"status-filtered-badge badge-meta horizontal",title:(m==null?void 0:m.titlesStr)||"",children:m!=null&&m.titlesStr?e(h,{id:"sr6maL",values:{0:m.titlesStr},components:{0:e("span",{}),1:e("span",{})}}):e("span",{children:e(h,{id:"03Qqf9"})})}):e(O,{children:[d,n.sensitive&&n.spoilerText&&e(O,{children:[" ",e("span",{class:"spoiler-badge",children:e(x,{icon:"eye-close",size:"s",alt:o({id:"gnKo7f"})})})]})]})})]})}function ir(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}const qt=20,Ci=1983,Xi=`${Ci}-01`,sr=(()=>{try{const n=document.createElement("input");return n.setAttribute("type","month"),n.type==="month"}catch{return!1}})();async function or(n){var o;const{masto:i}=re({instance:n}),s=await i.v2.search.fetch({q:"from:me",type:"statuses",limit:1});return!!((o=s==null?void 0:s.statuses)!=null&&o.length)}const cr=gt(or);function ar(){const{i18n:n,_:i}=de(),s=Ve(A),{id:o,...c}=Mt(),[r,u]=bt(),l=r.get("month"),d=!r.get("replies"),a=!!r.get("boosts"),m=r.get("tagged"),b=!!r.get("media"),{masto:g,instance:p,authenticated:f}=re({instance:c.instance}),{masto:v,instance:y}=re(),w=q(),C=[l,d,a,m,b],[S,k]=M(),T=q(0);ne(()=>{T.current=0},C);const _=_e(()=>ci(),[]),I=_e(()=>p===y,[p,y]),[R,L]=M(!1);ne(()=>{I&&S!=null&&S.acct&&(async()=>{const te=await cr(p);L(te)})()},[p,I,S==null?void 0:S.acct]);async function z(te){var Te,Pe,De,Be;const ae=/^\d{4}-[01]\d$/.test(l),ye=((Pe=(Te=l==null?void 0:l.split)==null?void 0:Te.call(l,"-"))==null?void 0:Pe[0])>=Ci;if(ae&&ye){if(!S)return{value:[],done:!0};const[Ee,Me]=l.split("-"),X=parseInt(Me,10)-1,Ie=new Date(Ee,X,0),Ne=`${Ie.getFullYear()}-${(Ie.getMonth()+1).toString().padStart(2,"0")}-${Ie.getDate().toString().padStart(2,"0")}`,fe=new Date(Ee,X+1,1),Q=`${fe.getFullYear()}-${(fe.getMonth()+1).toString().padStart(2,"0")}-${fe.getDate().toString().padStart(2,"0")}`;let ge;te?(ge=qt+1,T.current=0):(ge=qt+T.current+1,T.current+=qt);const N=await g.v2.search.fetch({q:`from:${S.acct} after:${Ne} before:${Q}`,type:"statuses",limit:ge,offset:T.current});if((De=N==null?void 0:N.statuses)!=null&&De.length){const ie=N.statuses.slice(0,qt);ie.forEach(D=>{Je(D,p)});const ue=N.statuses.length<=qt;return{value:ie,done:ue}}else return{value:[],done:!0}}let Ce=[];if(te){const{value:Ee}=await g.v1.accounts.$select(o).statuses.list({pinned:!0}).next();if(Ee!=null&&Ee.length&&!m&&!b){const Me=Ee.map(X=>(Je(X,p),{...X,_pinned:!0}));if(Me.length>=3){const X=Me.map(Ie=>Ie.id);Ce.push({id:X,items:Me,type:"pinned"})}else Ce.push(...Me)}}(te||!w.current)&&(w.current=g.v1.accounts.$select(o).statuses.list({limit:qt,exclude_replies:d,exclude_reblogs:a,only_media:b||void 0,tagged:m}));const{value:j,done:he}=await w.current.next();if(j!=null&&j.length){if(Ce.length){let Ee=[];((Be=Ce[0])==null?void 0:Be.type)==="pinned"?Ee=Ce[0].id:Ee=Ce.filter(X=>X._pinned).map(X=>X.id),Ee.every(X=>j.some(Ie=>Ie.id===X))&&(Ce=[])}Ce.push(...j),j.forEach(Ee=>{Je(Ee,p)})}return{value:Ce,done:he}}const[P,Z]=M([]);let ee=i({id:"/cKnpj"});if(S!=null&&S.acct){const te=(/@/.test(S.acct)?"":"@")+S.acct,ae=S!=null&&S.displayName?`${S.displayName} (${te})`:`${te}`;if(!d)ee=i({id:"hS1Opy",values:{accountDisplay:ae}});else if(a)ee=i({id:"A/CX5F",values:{accountDisplay:ae}});else if(m)ee=i({id:"QQrO94",values:{accountDisplay:ae,tagged:m}});else if(b)ee=i({id:"NoG5wD",values:{accountDisplay:ae}});else if(l){const ye=new Date(l).toLocaleString(n.locale,{month:"long",year:"numeric"});ee=i({id:"8GjLvB",values:{accountDisplay:ae,monthYear:ye}})}else ee=ae}Qe(ee,"/:instance?/a/:id");const W=st(()=>dr(o,g),[o,g]);ne(()=>{(async()=>{try{const te=await W();k(te)}catch{}if(!_)try{const te=await g.v1.accounts.$select(o).featuredTags.list();Z(te)}catch{}})()},[o,_]);const{displayName:V,acct:B,emojis:F}=S||{},se=q(),$=_e(()=>{const te=!d||a||m||b||!!l,ae=s.accounts[`${o}@${p}`];return e(O,{children:[e(Us,{instance:p,account:ae||o,fetchAccount:W,authenticated:f,standalone:!0}),!_&&e("div",{class:"filter-bar",ref:se,style:{position:"relative"},children:[te?e(be,{to:`/${p}/a/${o}`,class:"insignificant filter-clear",title:i({id:"u8JHrO"}),children:e(x,{icon:"x",size:"l",alt:i({id:"xCJdfg"})})},"clear-filters"):e(x,{icon:"filter",class:"insignificant",size:"l",alt:i({id:"cSev+j"})}),e(be,{to:`/${p}/a/${o}${d?"?replies=1":""}`,onClick:()=>{d&&me(i({id:"PIWNSQ"}))},class:d?"":"is-active",children:e(h,{id:"5BFynH"})}),e(be,{to:`/${p}/a/${o}${a?"":"?boosts=0"}`,onClick:()=>{a||me(i({id:"Qd13i0"}))},class:a?"is-active":"",children:e(h,{id:"usxQx0"})}),e(be,{to:`/${p}/a/${o}${b?"":"?media=1"}`,onClick:()=>{b||me(i({id:"rKpfPY"}))},class:b?"is-active":"",children:e(h,{id:"xYilR2"})}),P.map(ye=>e(be,{to:`/${p}/a/${o}${m===ye.name?"":`?tagged=${encodeURIComponent(ye.name)}`}`,onClick:()=>{m!==ye.name&&me(i({id:"L+HFfr",values:{0:ye.name}}))},class:m===ye.name?"is-active":"",children:e("span",{children:[e("span",{class:"more-insignificant",children:"#"}),ye.name]})},ye.id)),R&&(sr?e("label",{class:`filter-field ${l?"is-active":""}`,children:[e(x,{icon:"month",size:"l"}),e("input",{type:"month",disabled:!(S!=null&&S.acct),value:l||"",min:Xi,max:new Date().toISOString().slice(0,7),onInput:ye=>{const{value:Ce,validity:j}=ye.currentTarget;if(!j.valid)return;u(Ce?{month:Ce}:{});const[he,Te]=Ce.split("-"),Pe=parseInt(Te,10)-1,De=new Date(he,Pe);me(i({id:"yKR8NJ",values:{1:De.toLocaleString(n.locale,{month:"long",year:"numeric"})}}))}})]}):e(rr,{class:`filter-field ${l?"is-active":""}`,disabled:!(S!=null&&S.acct),value:l||"",min:Xi,max:new Date().toISOString().slice(0,7),onInput:ye=>{const{value:Ce,validity:j}=ye;j.valid&&u(Ce?{month:Ce}:{})}}))]})]})},[o,p,f,P,W,R,...C]);ne(()=>{var ae;const te=(ae=se.current)==null?void 0:ae.querySelector(".is-active");te&&se.current.scrollTo({behavior:"smooth",left:te.offsetLeft-(se.current.offsetWidth-te.offsetWidth)/2})},[P,R,...C]);const U=_e(()=>S!=null&&S.url?URL.parse(S.url).hostname:null,[S]),G=!!S&&!(p===U);return e(xt,{title:`${S!=null&&S.acct?"@"+S.acct:i({id:"+owNNn"})}`,titleComponent:e("h1",{class:"header-double-lines header-account",children:[e("b",{children:e(Ss,{text:V,emojis:F})}),e("div",{children:e("span",{class:"bidi-isolate",children:["@",B]})})]}),id:"account-statuses",instance:p,emptyText:i({id:"+k97fV"}),errorText:i({id:"scd9lw"}),fetchItems:z,useItemID:!0,view:b||_?"media":void 0,boostsCarousel:s.settings.boostsCarousel,timelineStart:$,refresh:[d,a,m,b,l+(S==null?void 0:S.acct)].toString(),headerEnd:e(rt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(Se,{disabled:!G,onClick:()=>{(async()=>{try{const{masto:te}=re({instance:U}),ae=await te.v1.accounts.lookup({acct:S.acct}),{id:ye}=ae;location.hash=`/${U}/a/${ye}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(x,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"/JFxxT",values:{0:U?e(O,{children:[" ","(",e("b",{children:zt.toUnicode(U)}),")"]}):null}})})]}),!I&&e(Se,{onClick:()=>{(async()=>{try{const te=await v.v1.accounts.lookup({acct:S.acct+"@"+p}),{id:ae}=te;location.hash=`/${y}/a/${ae}`}catch{alert(i({id:"FgdLx0"}))}})()},children:[e(x,{icon:"transfer"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"HkuyOu",values:{currentInstance:y},components:{0:e("b",{})}})})]})]})},o)}function rr(n){const{i18n:i}=de(),{class:s,disabled:o,value:c,min:r,max:u,onInput:l=()=>{}}=n,[d,a]=(c==null?void 0:c.split("-"))||[],m=q(),b=q(),g=(p,f)=>{const[v,y]=(r==null?void 0:r.split("-"))||[],[w,C]=(u==null?void 0:u.split("-"))||[];return!(f<v||f>w||f===v&&p<y||f===w&&p>C)};return e("div",{class:s,children:[e(x,{icon:"month",size:"l"}),e("select",{ref:m,disabled:o,value:a||"",onInput:p=>{const{value:f}=p.currentTarget,v=b.current.value;if(!g(f,v))return{value:"",validity:{valid:!1}};l({value:f?`${v}-${f}`:"",validity:{valid:!0}})},children:[e("option",{value:"",children:e(h,{id:"HajiZl"})}),e("option",{disabled:!0,children:"-----"}),Array.from({length:12},(p,f)=>e("option",{value:(f+1).toString().padStart(2,"0"),children:new Date(0,f).toLocaleString(i.locale,{month:"long"})},f))]})," ",e("input",{ref:b,type:"number",disabled:o,value:d||new Date().getFullYear(),min:(r==null?void 0:r.slice(0,4))||Ci,max:(u==null?void 0:u.slice(0,4))||new Date().getFullYear(),onInput:p=>{const{value:f,validity:v}=p.currentTarget,y=m.current.value;if(!v.valid||!g(y,f))return{value:"",validity:{valid:!1}};l({value:f?`${f}-${y}`:"",validity:{valid:!0}})},style:{width:"4.5em"}})]})}function lr(n,i){return i.v1.accounts.$select(n).fetch()}const dr=gt(lr,{maxAge:30*60*1e3});function ur(){var p;const n=Mt(),{year:i}=n;Qe(i?`Annual Report: ${i}`:"Annual Report");const{masto:s,instance:o}=re(),[c,r]=M(null),[u,l]=M("default");ne(()=>{i&&(async()=>{l("loading");const f=await s.v1.annualReports.$select(i).fetch();r(f),l("default")})()},[i]);const{accounts:d,annualReports:a,statuses:m}=c||{},b=(p=a==null?void 0:a.find(f=>f.year==i))==null?void 0:p.data,g=new Date;return e("div",{id:"annual-report-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"report",children:[e("h1",{children:[i," #Wrapstodon"]}),u==="loading"&&e("p",{children:[e(Ue,{abrupt:!0})," ",e(h,{id:"Pwqkdw"})]}),!!b&&e("dl",{children:Object.entries(b).map(([f,v])=>e(O,{children:[e("dt",{children:f}),e("dd",{class:`report-${f}`,children:Array.isArray(v)?e("table",{children:[e("thead",{children:e("tr",{children:Object.entries(v[0]).map(([y,w])=>e("th",{class:y!=="month"&&typeof w=="number"?"number":"",children:y}))})}),e("tbody",{children:v.map(y=>e("tr",{children:Object.entries(y).map(([w,C])=>e("td",{class:w!=="month"&&typeof C=="number"?"number":"",children:C&&/(accountId)/i.test(w)&&/^(mostRebloggedAccounts|commonlyInteractedWithAccounts)$/i.test(f)?e(mt,{account:d==null?void 0:d.find(S=>S.id===C),showAvatar:!0}):w==="month"?g.setMonth(C-1)&&g.toLocaleString(void 0,{month:"long"}):typeof C=="number"?C.toLocaleString():C}))}))})]}):typeof v=="object"?/^(topStatuses)$/i.test(f)?e("dl",{children:Object.entries(v).map(([y,w])=>e(O,{children:[e("dt",{children:y}),e("dd",{children:w&&e(be,{to:`/${o}/s/${w}`,children:e(je,{status:m==null?void 0:m.find(C=>C.id===w),size:"s",readOnly:!0})})})]}))}):e("table",{children:e("tbody",{children:Object.entries(v).map(([y,w])=>e("tr",{children:[e("th",{children:y}),e("td",{class:typeof w=="number"?"number":"",children:w})]}))})}):typeof v=="string"?v:JSON.stringify(v,null,2)})]}))})]}),e("hr",{}),e("p",{style:{textAlign:"center"},children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}const hr=20;function Gs(){const{_:n}=de();Qe(n({id:"7Ff7ia"}),"/bookmarks");const{masto:i,instance:s}=re(),o=q();async function c(r){return(r||!o.current)&&(o.current=i.v1.bookmarks.list({limit:hr})),await o.current.next()}return e(xt,{title:n({id:"7Ff7ia"}),id:"bookmarks",emptyText:n({id:"8k2w6G"}),errorText:n({id:"UoL+FC"}),instance:s,fetchItems:c})}const fr=""+new URL("catch-up-O5q5C75Z.png",import.meta.url).href,pr="home",dt=[{label:{id:"Ov9hfp"},value:1},{label:{id:"tVE2wM"},value:2},{label:{id:"8+HOWa"},value:3},{label:{id:"1o+mEC"},value:4},{label:{id:"dZZ8oA"},value:5},{label:{id:"lpPucp"},value:6},{label:{id:"r9r5X6"},value:7},{label:{id:"I9uBFA"},value:8},{label:{id:"pBYFlb"},value:9},{label:{id:"wvL7OJ"},value:10},{label:{id:"7Vb+qD"},value:11},{label:{id:"VU1Pnd"},value:12},{label:{id:"vpc27K"},value:13}],mr={original:{id:"HxF6Fk"},replies:{id:"N8UzTV"},boosts:{id:"puY2t0"},followedTags:{id:"lCLRBe"},groups:{id:"zhrjek"},filtered:{id:"03Qqf9"}},gr=["createdAt","repliesCount","favouritesCount","reblogsCount","density"],br=[null,"account"],vr=ms(n=>new Intl.DateTimeFormat(n||void 0,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}));function yr(){const{i18n:n,_:i,_:s}=de(),o=vr(n.locale);Qe("Catch-up","/catchup");const{masto:c,instance:r}=re(),[u,l]=bt(),d=u.get("id"),[a,m]=M("start"),[b,g]=M(!1),p=_e(()=>yt(),[]),f=E=>E===p,v=et("@pixelfed/home-include-reblogs");async function y({maxCreatedAt:E}){var oe,Oe,Le;const K=E?new Date(E):null,ce=[],J=c.v1.timelines.home.list({limit:40});e:for(;;)try{v&&J.nextParams&&(typeof J.nextParams=="string"?J.nextParams+="&include_reblogs=true":J.nextParams.include_reblogs=!0);const $e=await J.next(),{value:Fe}=$e;if(Fe!=null&&Fe.length){await Vs(Fe,r);let Ge=!1;for(let we=0;we<Fe.length;we++){const ze=Fe[we],tt=new Date(ze.createdAt);if(!K||tt>=K){const We=!f(((Oe=(oe=ze.reblog)==null?void 0:oe.account)==null?void 0:Oe.id)||ze.account.id)&&jt(((Le=ze.reblog)==null?void 0:Le.filtered)||ze.filtered,pr);if((We==null?void 0:We.action)==="hide")continue;ze._filtered=We;const kt=at(ze.id,r);ze._followedTags=A.statusFollowedTags[kt]?[...A.statusFollowedTags[kt]]:[],ce.push(ze),Ge=!0}if(!Ge)break e}}else break e;await new Promise(Ge=>setTimeout(Ge,1e3))}catch{break e}return ce.forEach($e=>{if($e!=null&&$e.inReplyToId){const Fe=ce.find(Ge=>Ge.id===$e.inReplyToId);Fe&&!Fe.inReplyToId&&(Fe._thread=!0)}}),ce}const[w,C]=M([]),S=q(),k=q(),T=_e(()=>_n(),[]),_=st(async({duration:E}={})=>{const K=Date.now(),ce=E?K-E:null;m("loading");const J=await y({maxCreatedAt:ce}),oe=`${T}-${qo()}`;try{await pt.catchup.set(oe,{id:oe,posts:J,count:J.length,startAt:ce,endAt:K}),l({id:oe})}catch{}},[]);ne(()=>{d?(async()=>{const E=await pt.catchup.get(d);E&&(E.posts.sort((K,ce)=>K.createdAt>ce.createdAt?1:-1),C(E.posts),m("results"))})():a==="results"&&(C([]),m("start"))},[d]);const[I,R]=Et(E=>E+1,0),[L,z]=M(null),[P,Z]=M([]);ne(()=>{(async()=>{try{const E=await pt.catchup.keys();if(E.length){const K=_n(),ce=E.filter(J=>J.startsWith(`${K}-`));if(ce.length){let J=await pt.catchup.getMany(ce);J.sort(($e,Fe)=>Fe.endAt-$e.endAt);let oe=J.slice(0,3),Oe=J.slice(3);const Le=oe.map($e=>{const{id:Fe,count:Ge,startAt:we,endAt:ze}=$e;return{id:Fe,count:Ge,startAt:we,endAt:ze}});Z(Le),z(oe[0].endAt),J=null,oe=null,queueMicrotask(()=>{Oe.length&&pt.catchup.delMany(Oe.map($e=>$e.id)).then(()=>{Oe=null}).catch($e=>{})});return}}}catch{}Z([])})()},[I]),ne(()=>{a==="start"&&R()},[a==="start"]);const[ee,W]=_e(()=>{var Fe,Ge,we,ze,tt;let E=0,K=0,ce=0,J=0,oe=0,Oe=0;const Le={};for(const Ae of w){Ae._filtered?(E++,Ae.__FILTER="filtered"):Ae.group?(K++,Ae.__FILTER="groups"):Ae.reblog?(ce++,Ae.__FILTER="boosts"):(Fe=Ae._followedTags)!=null&&Fe.length?(oe++,Ae.__FILTER="followedTags"):Ae.inReplyToId&&Ae.inReplyToAccountId!==((Ge=Ae.account)==null?void 0:Ge.id)?(J++,Ae.__FILTER="replies"):(Oe++,Ae.__FILTER="original");const We=Ae.reblog||Ae;if(Ae.__FILTER!=="filtered"&&((we=We.card)!=null&&we.url)&&((ze=We.card)!=null&&ze.image)&&((tt=We.card)==null?void 0:tt.type)==="link"){const{card:kt,favouritesCount:dn,reblogsCount:$t}=We;let{url:nt}=kt;if(nt=nt.replace(/\/$/,""),!Le[nt])Le[nt]={postID:We.id,card:kt,shared:1,sharers:[Ae.account],likes:dn,boosts:$t};else{if(Le[nt].sharers.find(Ut=>Ut.id===Ae.account.id))continue;Le[nt].shared++,Le[nt].sharers.push(Ae.account),Le[nt].postID!==We.id&&(Le[nt].likes+=dn,Le[nt].boosts+=$t)}}}let $e=[];for(const Ae in Le)$e.push({url:Ae,...Le[Ae]});if($e.sort((Ae,We)=>Ae.shared>We.shared?-1:Ae.shared<We.shared?1:Ae.boosts>We.boosts?-1:Ae.boosts<We.boosts?1:Ae.likes>We.likes?-1:Ae.likes<We.likes?1:0),$e.length>10)e:for(let Ae=10;Ae<$e.length;Ae++){const{shared:We}=$e[Ae];if(We<=1){$e=$e.slice(0,Ae);break e}}return[{filtered:E,groups:K,boosts:ce,replies:J,followedTags:oe,original:Oe},$e]},[w]),[V,B]=M("all"),[F,se]=M(null),[$,U]=M(1),[Y,G]=M("createdAt"),[te,ae]=M("asc"),[ye,Ce]=M(null),[j,he,Te]=_e(()=>{const E={},K=new Map;let ce=w.filter(oe=>{const Oe=V==="all"||oe.__FILTER===V;return Oe&&(E[oe.account.id]=oe.account,K.set(oe.account.id,(K.get(oe.account.id)||0)+1)),Oe});const J={};return ce.forEach(oe=>{oe.reblog&&(J[oe.reblog.id]?(J[oe.reblog.id].__BOOSTERS?J[oe.reblog.id].__BOOSTERS.add(oe.account):J[oe.reblog.id].__BOOSTERS=new Set([oe.account]),oe.__HIDDEN=!0):J[oe.reblog.id]=oe)}),F&&K.has(F)&&(ce=ce.filter(oe=>oe.account.id===F||[...oe.__BOOSTERS||[]].find(Oe=>Oe.id===F))),[ce,E,Object.fromEntries(K)]},[V,F,w]),Pe=_e(()=>{const E={};return j.forEach(K=>{E[K.id]=K}),E},[j]),De=_e(()=>Object.keys(Te).sort((E,K)=>Te[K]-Te[E]),[Te]),Be=_e(()=>{const E={};return De.forEach((K,ce)=>{E[K]=ce}),j.filter(K=>!K.__HIDDEN).sort((K,ce)=>{if(ye==="account"){const J=K.account.id,oe=ce.account.id,Oe=E[J],Le=E[oe],$e=Oe-Le;if($e!==0)return $e}if(Y!=="createdAt"&&(K=K.reblog||K,ce=ce.reblog||ce,Y!=="density"&&K[Y]===ce[Y]))return K.createdAt>ce.createdAt?1:-1;if(Y==="density"){const J=Ji(K),oe=Ji(ce);return te==="asc"?J>oe?1:-1:oe>J?1:-1}return te==="asc"?K[Y]>ce[Y]?1:-1:ce[Y]>K[Y]?1:-1})},[j,Y,te,ye,De]),Ee=q(null),Me=q(null),X=q(!1);ne(()=>{w.length>100||X.current||Me.current&&(Ps(Me.current,{duration:200}),X.current=!0)},[w,Me]);const Ie=w.length>160?"3d":"2d",Ne=_e(()=>Ie!=="2d"?null:w.map(E=>{const K=Pe[E.id];return e("span",{class:`post-dot ${K?"post-dot-highlight":""}`},E.id)}),[Pe]),fe=_e(()=>Ie!=="3d"||!(w!=null&&w.length)?null:xr(w,"createdAt",320).map((K,ce)=>e("div",{class:"posts-bin",children:K.map(J=>{const oe=Pe[J.id];return e("span",{class:`post-dot ${oe?"post-dot-highlight":""}`},J.id)})},ce)),[Pe]),Q=q(null),ge=_e(()=>L?(Date.now()-L)/1e3/60/60:null,[L,$]);ne(()=>{if(a!=="results")return;const E=F&&he[F]?he[F].username:"",K=te==="asc"?0:1,ce={account:"authors"};let J=me({duration:5e3,text:s({id:"TLYeLT",values:{selectedFilterCategory:V,sortBy:Y,sortOrder:te,groupBy:ye}})});return()=>{var oe;(oe=J==null?void 0:J.hideToast)==null||oe.call(J)}},[a,V,F,Y,te,ye,he]),ne(()=>{var E;if(F&&he[F]){const K=Me.current.querySelector(`[data-author="${F}"]`),ce=(E=Me.current)==null?void 0:E.getBoundingClientRect(),J=K==null?void 0:K.getBoundingClientRect();J.left<ce.left||J.right>ce.right?K.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}):J.top<0&&K.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}},[F,he]);const[N,ie]=M(!1),ue=".catchup-list > li > a",D=He("j",()=>{const E=document.activeElement.closest(ue),K=E==null?void 0:E.getBoundingClientRect(),ce=Array.from(Q.current.querySelectorAll(ue));if(E&&K.top<Q.current.clientHeight&&K.bottom>0){const J=ce.indexOf(E),oe=ce[J+1];oe&&(oe.focus(),oe.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const J=ce.find(oe=>oe.getBoundingClientRect().top>=0);J&&(J.focus(),J.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),le=He("k",()=>{const E=document.activeElement.closest(ue),K=E==null?void 0:E.getBoundingClientRect(),ce=Array.from(Q.current.querySelectorAll(ue));if(E&&K.top<Q.current.clientHeight&&K.bottom>0){const J=ce.indexOf(E);let oe=ce[J-1];oe&&(oe.focus(),oe.scrollIntoView({block:"center",inline:"center",behavior:"smooth"}))}else{const J=ce.find(oe=>{const Oe=oe.getBoundingClientRect();return Oe.top>=44&&Oe.left>=0});J&&(J.focus(),J.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"}))}},{preventDefault:!0,ignoreModifiers:!0}),xe=He("h, l",(E,K)=>{var J,oe,Oe;const ce=K.keys[0];if(F){const Le=De.indexOf(F);ce==="h"?Le>0&&Le<De.length&&(se(De[Le-1]),(J=Q.current)==null||J.focus()):ce==="l"&&Le<De.length-1&&Le>=0&&(se(De[Le+1]),(oe=Q.current)==null||oe.focus())}else ce==="l"&&(se(De[0]),(Oe=Q.current)==null||Oe.focus())},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),H=He("esc",()=>{var E;se(null),(E=Q.current)==null||E.focus()},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),ve=He(".",()=>{var E;(E=Q.current)==null||E.scrollTo({top:0,behavior:"smooth"})},{preventDefault:!0,ignoreModifiers:!0,enableOnFormTags:["input"]}),Re=st(E=>{const K=document.activeElement,ce=(K==null?void 0:K.tagName)==="INPUT"&&K.type==="radio";if((E.key==="ArrowDown"||E.key==="ArrowUp"||E.key==="ArrowLeft"||E.key==="ArrowRight")&&ce){K.blur();return}},[]);return e("div",{ref:E=>{Q.current=E,D(E),le(E),xe(E),H(E)},id:"catchup-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck wide",children:[e("header",{class:`${a==="loading"?"loading":""}`,onClick:E=>{var K;E.target.closest("a, button")||(K=Q.current)==null||K.scrollTo({top:0,behavior:"smooth"})},children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),a==="results"&&e(be,{to:"/catchup",class:"button plain",children:e(x,{icon:"history2",size:"l",alt:s({id:"xrl8fj"})})}),a==="start"&&e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:a!=="start"&&e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("div",{class:"header-side",children:a!=="start"&&a!=="loading"&&e("button",{type:"button",class:"plain",onClick:()=>{ie(!0)},children:e(h,{id:"c3XJ18"})})})]})}),e("main",{onKeyDown:Re,children:[a==="start"&&e("div",{class:"catchup-start",children:[e("h1",{children:e(h,{id:"wyL/3/",components:{0:e("sup",{})}})}),e("details",{children:[e("summary",{children:e(h,{id:"CxKPv6"})}),e("p",{children:e(h,{id:"YMU1CK"})}),e("img",{src:fr,width:"1200",height:"900",alt:s({id:"CeInO2"})}),e("p",{children:e("button",{type:"button",onClick:E=>{E.target.closest("details").open=!1},children:e(h,{id:"2jI8hh"})})})]}),e("p",{children:e(h,{id:"1RfGk7"})}),e("p",{children:e("b",{children:e(h,{id:"OOEonE"})})}),e("div",{class:"catchup-form",children:[e("input",{ref:S,type:"range",value:$,min:dt[0].value,max:dt[dt.length-1].value,step:"1",list:"catchup-ranges",onChange:E=>U(+E.target.value)})," ",e("span",{style:{width:"8em"},children:[i(dt[$-1].label),e("br",{}),e("small",{class:"insignificant",children:$==dt[dt.length-1].value?s({id:"NMNiaO"}):ot(new Date(Date.now()-$*60*60*1e3))})]}),e("datalist",{id:"catchup-ranges",children:dt.map(({label:E,value:K})=>e("option",{value:K,label:i(E)}))})," ",e("button",{type:"button",onClick:()=>{var E;if($<dt[dt.length-1].value){let K;$===dt[dt.length-1].value&&((E=k.current)!=null&&E.checked)?K=Date.now()-L:K=$*60*60*1e3,_({duration:K})}else _()},children:e(h,{id:"R0yu2l"})})]}),ge&&$>ge?e("p",{class:"catchup-info",children:[e(x,{icon:"info"})," ",e(h,{id:"AGyV7s"})]}):$===dt[dt.length-1].value&&L?e("p",{class:"catchup-info",children:e("label",{children:[e("input",{type:"checkbox",switch:!0,checked:!0,ref:k})," ",e(h,{id:"dDJEHI",values:{0:o.format(new Date(L))}})]})}):null,e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"EAjFM0"})})}),!!(P!=null&&P.length)&&e("div",{class:"catchup-prev",children:[e("p",{children:e(h,{id:"Yfb9A8"})}),e("ul",{children:P.map(E=>e("li",{children:[e(be,{to:`/catchup?id=${E.id}`,children:[e(x,{icon:"history2"})," ",e("span",{children:E.startAt?o.formatRange(new Date(E.startAt),new Date(E.endAt)):`… – ${o.format(new Date(E.endAt))}`})]})," ",e("span",{children:[e("small",{class:"ib insignificant",children:e(h,{id:"S6XZwv",values:{0:E.count}})})," ",e("button",{type:"button",class:"light danger small",onClick:async()=>{var ce;if(confirm(s({id:"D9CmP2"}))){let J=me(s({id:"xJUo4P",values:{0:E.id}}));await pt.catchup.del(E.id),(ce=J==null?void 0:J.hideToast)==null||ce.call(J),me(s({id:"bRDKRy",values:{1:E.id}})),R()}},children:e(x,{icon:"x",alt:s({id:"t/YqKh"})})})]})]},E.id))}),P.length>=3&&e("p",{children:e("small",{children:e(h,{id:"sXmrl4"})})})]})]}),a==="loading"&&e("div",{class:"ui-state catchup-start",children:[e(Ue,{abrupt:!0}),e("p",{class:"insignificant",children:e(h,{id:"rbUTzD"})}),e("p",{class:"insignificant",children:e(h,{id:"q9urQO"})})]}),a==="results"&&e(O,{children:[e("div",{class:"catchup-header",children:[w.length>0&&e("p",{children:e("b",{class:"ib",children:o.formatRange(new Date(w[0].createdAt),new Date(w[w.length-1].createdAt))})}),e("aside",{children:[e("button",{hidden:V==="all"&&!F&&Y==="createdAt"&&te==="asc",type:"button",class:"plain4 small",onClick:()=>{B("all"),se(null),G("createdAt"),Ce(null),ae("asc")},children:e(h,{id:"I9EnzM"})}),(W==null?void 0:W.length)>0&&e("button",{type:"button",class:"plain small",onClick:()=>g(!b),children:[e(h,{id:"EIZREX"})," ",e(x,{icon:"chevron-down",style:{transform:b?"rotate(180deg)":"rotate(0deg)"}})]})]})]}),e("div",{class:"shazam-container no-animation",hidden:!b,children:e("div",{class:"shazam-container-inner",children:e("div",{class:"catchup-top-links links-bar",children:W.map(E=>{const{card:K,shared:ce,sharers:J,likes:oe,boosts:Oe}=E,{blurhash:Le,title:$e,description:Fe,url:Ge,image:we,imageDescription:ze,language:tt,width:Ae,height:We,publishedAt:kt}=K,dn=zt.toUnicode(URL.parse(Ge).hostname.replace(/^www\./,"").replace(/\/$/,""));let $t;if(Le){const nt=ui(Le),Ut=Si(nt);$t=ki([.6,Ut[1],Ut[2]])}return e("a",{href:Ge,target:"_blank",rel:"noopener",class:"link-block",style:$t?{"--accent-color":`rgb(${$t.join(",")})`,"--accent-alpha-color":`rgba(${$t.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:we,alt:ze,width:Ae,height:We,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:dn})," ",!!kt&&e(O,{children:"· "}),!!kt&&e(O,{children:e(It,{datetime:kt,format:"micro"})})]}),!!$e&&e("h1",{class:"title",lang:tt,dir:"auto",title:$e,children:$e})]}),!!Fe&&e("p",{class:"description",lang:tt,dir:"auto",title:Fe,children:Fe}),e("hr",{}),e("p",{style:{whiteSpace:"nowrap"},children:e(h,{id:"bfSr6z",values:{0:J.map(nt=>{const{avatarStatic:Ut,displayName:fo}=nt;return e("button",{type:"button",class:"plain",style:{padding:0},onClick:Ii=>{Ii.preventDefault(),Ii.stopPropagation();const{id:po}=nt;se(po),B("all")},children:e(ft,{url:Ut,size:"s",alt:fo})})})}})})]})]})},Ge)})})})}),w.length>=5&&(Ie==="3d"?e("div",{class:"catchup-posts-viz-time-bar",children:fe}):e("div",{class:"catchup-posts-viz-bar",children:Ne})),w.length>=2&&e("div",{class:"catchup-filters",children:[e("label",{class:"filter-cat",children:[e("input",{type:"radio",name:"filter-cat",checked:V.toLowerCase()==="all",onChange:()=>{B("all")}}),e(h,{id:"N40H+G"})," ",e("span",{class:"count",children:w.length})]}),Object.entries(mr).map(([E,K])=>!!ee[E]&&e("label",{class:"filter-cat",title:(ee[E]/w.length*100).toFixed(2)+"%",children:[e("input",{type:"radio",name:"filter-cat",checked:V.toLowerCase()===E.toLowerCase(),onChange:()=>{B(E),E==="boosts"&&(G("reblogsCount"),ae("desc"),Ce(null))}}),i(K)," ",e("span",{class:"count",children:ee[E]})]},i(K)))]}),w.length>=2&&!!Te&&e("div",{class:"catchup-filters authors-filters",ref:Me,children:[De.map(E=>e("label",{class:"filter-author","data-author":E,children:[e("input",{type:"radio",name:"filter-author",checked:F===E,onChange:()=>{se(E)},onClick:()=>{F===E&&se(null)}}),e(ft,{url:he[E].avatarStatic||he[E].avatar,size:"xxl",alt:`${he[E].displayName} (@${he[E].acct})`})," ",e("span",{class:"count",children:Te[E]}),e("span",{class:"username",children:he[E].username})]},`${E}-${Te[E]}`)),De.length>5&&e("small",{style:{whiteSpace:"nowrap",paddingInline:"1em",opacity:.33},children:e(h,{id:"HHtYi7",values:{0:De.length}})},"authors-count")]}),w.length>=2&&e("div",{class:"catchup-filters",children:[e("span",{class:"filter-label",children:e(h,{id:"f6Hub0"})})," ",e("fieldset",{class:"radio-field-group",children:gr.map(E=>e("label",{class:"filter-sort",onClick:K=>{Y===E&&(K.preventDefault(),K.stopPropagation(),ae(te==="asc"?"desc":"asc"))},children:[e("input",{type:"radio",name:"filter-sort-cat",checked:Y===E,onChange:()=>{G(E);const K=/(replies|favourites|reblogs)/.test(E)?"desc":"asc";ae(K)}}),{createdAt:s({id:"mYGY3B"}),repliesCount:s({id:"N8UzTV"}),favouritesCount:s({id:"zZOZj7"}),reblogsCount:s({id:"puY2t0"}),density:s({id:"0tQ7AD"})}[E],Y===E&&(te==="asc"?" ↑":" ↓")]},E))}),e("span",{class:"filter-label",children:e(h,{id:"group.filter"})})," ",e("fieldset",{class:"radio-field-group",children:br.map(E=>e("label",{class:"filter-group",children:[e("input",{type:"radio",name:"filter-group",checked:ye===E,onChange:()=>{Ce(E)},disabled:E==="account"&&F}),{account:s({id:"dpqPBg"})}[E]||s({id:"EdQY6l"})]},E||"none"))}),F&&De.length>1?e("button",{type:"button",class:"plain6 small",onClick:()=>{se(null)},style:{whiteSpace:"nowrap"},children:e(h,{id:"/dlmrZ"})}):null]}),e("ul",{class:`catchup-list catchup-filter-${V||""} ${Y?`catchup-sort-${Y}`:""} ${F&&he[F]?"catchup-selected-author":""} ${ye?`catchup-group-${ye}`:""}`,children:Be.map((E,K)=>{var oe;const ce=((oe=E.reblog)==null?void 0:oe.id)||E.id;let J=!1;return ye==="account"&&(Ee.current&&E.account.id!==Ee.current&&K>0&&(J=!0),Ee.current=E.account.id),e(O,{children:[J&&e("li",{class:"separator"}),e(kr,{to:`/${r}/s/${ce}`,post:E,root:Q.current})]},`${E.id}-${J}`)})}),e("footer",{children:j.length>5&&e("p",{children:[s(V==="boosts"?{id:"eVosYr"}:{id:"rhmyFK"})," ",e("button",{type:"button",class:"textual",onClick:()=>{Q.current.scrollTop=0},children:e(h,{id:"0MgdN+"})}),"."]})})]})]})]}),N&&e(qe,{onClose:()=>ie(!1),children:e("div",{class:"sheet",id:"catchup-help-sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>ie(!1),children:e(x,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"c3XJ18"})})}),e("main",{children:e("dl",{children:[e("dt",{children:e(h,{id:"EIZREX"})}),e("dd",{children:e(h,{id:"YmGrIy"})}),e("dt",{children:e(h,{id:"coaNtr"})}),e("dd",{children:e(h,{id:"UUrqX1"})}),e("dt",{children:e(h,{id:"ScQBC/"})}),e("dd",{children:e(h,{id:"srocAr"})}),e("dt",{children:e(h,{id:"77Emn0"})}),e("dd",{children:e("table",{children:e("tbody",{children:[e("tr",{children:[e("td",{children:e(h,{id:"Gy9P9T"})}),e("td",{children:e("kbd",{children:"j"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"6XYpYY"})}),e("td",{children:e("kbd",{children:"k"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"f5dduh"})}),e("td",{children:e("kbd",{children:"l"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"rj0vxZ"})}),e("td",{children:e("kbd",{children:"h"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"jsFF8C"})}),e("td",{children:e("kbd",{children:"Enter"})})]}),e("tr",{children:[e("td",{children:e(h,{id:"bUUv3P"})}),e("td",{children:e("kbd",{children:"."})})]})]})})})]})})]})})]})}const wr=lt(function({post:n}){const{id:i,account:s,group:o,reblog:c,inReplyToId:r,inReplyToAccountId:u,_followedTags:l,_filtered:d,visibility:a,__BOOSTERS:m}=n,b=r&&u!==s.id,g=!!d,p=f=>{f.shiftKey};return e("article",{class:`post-line ${o?"group":c?"reblog":l!=null&&l.length?"followed-tags":""} ${b?"reply-to":""} ${g?"filtered":""} visibility-${a}`,onMouseEnter:p,children:[e("span",{class:"post-author",children:c?e("span",{class:"post-reblog-avatar",children:[e(ft,{url:s.avatarStatic||s.avatar,squircle:s.bot}),(m==null?void 0:m.size)>0?[...m].map(f=>e(ft,{url:f.avatarStatic||f.avatar,squircle:f.bot})):""," ",e(x,{icon:"rocket"})," ",e(mt,{account:c.account,showAvatar:!0})]}):e(mt,{account:s,showAvatar:!0})}),e(_r,{post:c||n,filterInfo:d}),e("span",{class:"post-meta",children:[e(Ir,{post:c||n})," ",e(It,{datetime:new Date((c==null?void 0:c.createdAt)||n.createdAt),format:"micro"})]})]})},(n,i)=>{var s,o;return((s=n==null?void 0:n.post)==null?void 0:s.id)===((o=i==null?void 0:i.post)==null?void 0:o.id)}),kr=({root:n,to:i,...s})=>{const o=q(),[c,r]=M(!1);return ne(()=>{const u=new IntersectionObserver(l=>{l[0].isIntersecting&&(queueMicrotask(()=>r(!0)),u.unobserve(o.current))},{root:n,rootMargin:`${Math.max(320,screen.height*.75)}px`});return o.current&&u.observe(o.current),()=>{o.current&&u.unobserve(o.current)}},[]),c?e("li",{children:e(be,{to:i,children:e(wr,{...s})})}):e("li",{ref:o,style:{height:"4em"}})},Sr=8,Cr=8;function Ji(n){var d;const{spoilerText:i,content:s,poll:o,mediaAttachments:c,card:r}=n,u=(d=o==null?void 0:o.options)!=null&&d.length?o.options.reduce((a,m)=>a+m.title,""):"";return(i.length+xs(s)+u.length)/140+(c!=null&&c.length?Sr*c.length:r!=null&&r.image?Cr:0)}const Tt=48;function _r({post:n,filterInfo:i}){var S;const{_:s}=de(),{spoilerText:o,sensitive:c,content:r,emojis:u,poll:l,mediaAttachments:d,card:a,inReplyToId:m,inReplyToAccountId:b,account:g,_thread:p}=n,f=m&&b===g.id||!!p,v=_e(()=>!!(ke.account.get("preferences")||{})["reading:expand:spoilers"],[]),y=v||!o&&!c,w=r?Mn(n):"",C=!o||v;return e("div",{class:"post-peek",title:o?"":w,children:[e("span",{class:"post-peek-content",children:[f&&!C&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:"Thread"})," "]}),i?e("span",{class:"post-peek-filtered",children:i!=null&&i.titlesStr?s({id:"suKjh3",values:{0:i.titlesStr}}):s({id:"03Qqf9"})}):e(O,{children:[!!o&&e("span",{class:"post-peek-spoiler",children:[e(x,{icon:`${v?"eye-open":"eye-close"}`})," ",o]}),C&&e("div",{class:"post-peek-html",children:[f&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-thread",children:e(h,{id:"e66y2Z"})})," "]}),!!r&&e("div",{dangerouslySetInnerHTML:{__html:Yo(r,u)}}),!!((S=l==null?void 0:l.options)!=null&&S.length)&&l.options.map(k=>e("div",{children:[l.multiple?"▪️":"•"," ",k.title]})),!r&&(d==null?void 0:d.length)===1&&d[0].description&&e(O,{children:[e("span",{class:"post-peek-tag post-peek-alt",children:"ALT"})," ",e("div",{children:d[0].description})]})]})]})]}),!i&&e("span",{class:"post-peek-post-content",children:[!!l&&e("span",{class:"post-peek-tag post-peek-poll",children:[e(x,{icon:"poll",size:"s"}),e(h,{id:"4WUbF1"})]}),d!=null&&d.length?d.map(k=>{var L,z,P,Z,ee,W,V,B,F,se;const T=k.previewUrl||k.url,_=k.previewRemoteUrl||k.remoteUrl,I=(L=k.meta)!=null&&L.original?k.meta.original.width:((P=(z=k.meta)==null?void 0:z.small)==null?void 0:P.width)||((ee=(Z=k.meta)==null?void 0:Z.original)==null?void 0:ee.width),R=(W=k.meta)!=null&&W.original?k.meta.original.height:((B=(V=k.meta)==null?void 0:V.small)==null?void 0:B.height)||((se=(F=k.meta)==null?void 0:F.original)==null?void 0:se.height);return e("span",{class:"post-peek-media",children:{image:(T||_)&&y?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:$=>{const{src:U}=$.target;U===T&&($.target.src=_)},style:{"--anim-duration":`${Math.min(Math.max(Math.max(I,R)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🖼"}),gifv:(T||_)&&y?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:$=>{const{src:U}=$.target;U===T&&($.target.src=_)}}):e("span",{class:"post-peek-faux-media",children:"🎞️"}),video:(T||_)&&y?e("img",{src:T,width:Tt,height:Tt,alt:k.description,loading:"lazy",onError:$=>{const{src:U}=$.target;U===T&&($.target.src=_)}}):e("span",{class:"post-peek-faux-media",children:"📹"}),audio:e("span",{class:"post-peek-faux-media",children:"🎵"})}[k.type]||null},k.id)}):!!a&&a.image&&y&&e("span",{class:`post-peek-media post-peek-card card-${a.type||""}`,children:a.image?e("img",{src:a.image,width:Tt,height:Tt,alt:a.title||a.description||a.imageDescription,loading:"lazy",style:{"--anim-duration":a.width&&a.height&&`${Math.min(Math.max(Math.max(a.width,a.height)/100,5),120)}s`}}):e("span",{class:"post-peek-faux-media",children:"🔗"})})]})]})}function Ir({post:n}){const{_:i}=de(),{reblogsCount:s,repliesCount:o,favouritesCount:c}=n;return e("span",{class:"post-stats",children:[o>0&&e("span",{class:"post-stat-replies",children:[e(x,{icon:"comment2",size:"s",alt:i({id:"N8UzTV"})})," ",Xe(o)]}),c>0&&e("span",{class:"post-stat-likes",children:[e(x,{icon:"heart",size:"s",alt:i({id:"zZOZj7"})})," ",Xe(c)]}),s>0&&e("span",{class:"post-stat-boosts",children:[e(x,{icon:"rocket",size:"s",alt:i({id:"puY2t0"})})," ",Xe(s)]})]})}function xr(n,i,s){const o=n.map(d=>new Date(d[i])),c=o.reduce((d,a)=>a<d?a:d,o[0]),r=o.reduce((d,a)=>a>d?a:d,o[0]),u=Math.min(r.getTime(),Date.now())-c.getTime(),l=Array.from({length:s},()=>[]);return n.forEach(d=>{const a=new Date(d[i]);if(a.getTime()>Date.now())l[l.length-1].push(d);else{const m=(a.getTime()-c.getTime())/u,b=Math.floor(m*(s-1));l[b].push(d)}}),l}const Tr=20;function Ks(){const{_:n}=de();Qe(n({id:"zZOZj7"}),"/favourites");const{masto:i,instance:s}=re(),o=q();async function c(r){return(r||!o.current)&&(o.current=i.v1.favourites.list({limit:Tr})),await o.current.next()}return e(xt,{title:n({id:"zZOZj7"}),id:"favourites",emptyText:n({id:"PHIrMr"}),errorText:n({id:"khVljG"}),instance:s,fetchItems:c})}const Ar=["home","public","notifications","thread","account"],Qi=["notifications","thread","account"],Rr={home:{id:"Buy2bt"},notifications:{id:"iDNBZe"},public:{id:"RO10dm"},thread:{id:"EnJuK0"},account:{id:"vrQQgz"}},Er=[0,30*60,60*60,6*60*60,12*60*60,60*60*24,60*60*24*7,60*60*24*30],Vn={0:{id:"qqeAJM"},1800:it(30,"minute"),3600:it(1,"hour"),21600:it(6,"hour"),43200:it(12,"hour"),86400:it(24,"hour"),604800:it(7,"day"),2592e3:it(30,"day")};function Mr(){const{_:n}=de(),{masto:i}=re();Qe(n({id:"cSev+j"}),"/ft");const[s,o]=M("default"),[c,r]=M(!1),[u,l]=Et(m=>m+1,0),[d,a]=M([]);return ne(()=>{o("loading"),(async()=>{try{const m=await i.v2.filters.list();m.sort((b,g)=>b.title.localeCompare(g.title)),m.forEach(b=>{var g;(g=b.keywords)!=null&&g.length&&b.keywords.sort((p,f)=>p.id-f.id)}),a(m),o("default")}catch{o("error")}})()},[u]),e("div",{id:"filters-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"cSev+j"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{r(!0)},children:e(x,{icon:"plus",size:"l",alt:n({id:"yFfBdX"})})})})]})}),e("main",{children:d.length>0?e(O,{children:[e("ul",{class:"filters-list",children:d.map(m=>{const{id:b,title:g,expiresAt:p,keywords:f}=m;return e("li",{children:[e("div",{children:[e("h2",{children:g}),(f==null?void 0:f.length)>0&&e("div",{children:f.map(v=>e(O,{children:[e("span",{class:"tag collapsed insignificant",children:v.wholeWord?`“${v.keyword}”`:v.keyword})," "]}))}),e("small",{class:"insignificant",children:e(Zs,{expiresAt:p})})]}),e("button",{type:"button",class:"plain",onClick:()=>{r({filter:m})},children:e(x,{icon:"pencil",size:"l",alt:"Edit filter"})})]},b)})}),d.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"5vzJxv",values:{0:d.length}})})})]}):s==="loading"?e("p",{class:"ui-state",children:e(Ue,{})}):s==="error"?e("p",{class:"ui-state",children:e(h,{id:"qcAUwp"})}):e("p",{class:"ui-state",children:e(h,{id:"cWIHTt"})})})]}),!!c&&e(qe,{title:n({id:"vCSBPD"}),onClose:()=>{r(!1)},children:e(Pr,{filter:c==null?void 0:c.filter,onClose:m=>{m.state==="success"&&l(),r(!1)}})})]})}let Lr=1;const $r=()=>Lr++;function Pr({filter:n,onClose:i}){const{_:s,_:o}=de(),{masto:c}=re(),[r,u]=M("default"),l=!!n,{context:d,expiresAt:a,id:m,keywords:b,title:g,filterAction:p}=n||{},f=!!a,v=f&&new Date(a),[y,w]=M(b||[]),C=q(),[S,k]=M([]),[T,_]=M([]),I=y.filter(R=>!S.includes(R.id)&&!T.includes(R._id));return e("div",{class:"sheet",id:"filters-add-edit-modal",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(x,{icon:"x",alt:o({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:o(l?{id:"3mOee6"}:{id:"yFfBdX"})})}),e("main",{children:e("form",{onSubmit:R=>{R.preventDefault();const L=new FormData(R.target),z=L.get("title"),P=L.getAll("keyword_attributes[][id]"),Z=L.getAll("keyword_attributes[][keyword]"),ee=[...C.current.querySelectorAll('input[name="keyword_attributes[][whole_word]"]')].map(se=>se.checked),W=Z.map((se,$)=>({id:P[$]||void 0,keyword:se,wholeWord:ee[$]}));l&&(S!=null&&S.length)&&S.forEach(se=>{W.push({id:se,_destroy:!0})});const V=L.getAll("context");let B=L.get("expires_in");const F=L.get("filter_action");!z||!(V!=null&&V.length)||(u("loading"),(async()=>{try{let se;l?(B===""||B===null?f?B=Math.floor((v-new Date)/1e3):B=null:B==="0"||B===0?B=null:B=+B,se=await c.v2.filters.$select(m).update({title:z,context:V,expiresIn:B,keywordsAttributes:W,filterAction:F})):(B=+B||null,se=await c.v2.filters.create({title:z,context:V,expiresIn:B,keywordsAttributes:W,filterAction:F})),u("default"),i==null||i({state:"success",filter:se})}catch{u("error"),alert(o(l?{id:"H8RP+h"}:{id:"Fr0hAN"}))}})())},children:[e("div",{class:"filter-form-row",children:e("label",{children:[e("b",{children:e(h,{id:"MHrjPM"})}),e("input",{type:"text",name:"title",defaultValue:g,disabled:r==="loading",dir:"auto",required:!0})]})}),e("div",{class:"filter-form-keywords",ref:C,children:[I.length?e("ul",{class:"filter-keywords",children:I.map(R=>{const{id:L,keyword:z,wholeWord:P,_id:Z}=R;return e("li",{children:[e("input",{type:"hidden",name:"keyword_attributes[][id]",value:L}),e("input",{name:"keyword_attributes[][keyword]",type:"text",defaultValue:z,disabled:r==="loading",required:!0,dir:"auto"}),e("div",{class:"filter-keyword-actions",children:[e("label",{children:[e("input",{name:"keyword_attributes[][whole_word]",type:"checkbox",value:L,defaultChecked:P,disabled:r==="loading"})," ",e(h,{id:"/7UQ7y"})]}),e("button",{type:"button",class:"light danger small",disabled:r==="loading",onClick:()=>{L?(S.push(L),k([...S])):Z&&(T.push(Z),_([...T]))},children:e(x,{icon:"x",alt:o({id:"t/YqKh"})})})]})]},`${L}-${Z}`)})}):e("div",{class:"filter-keywords",children:e("div",{class:"insignificant",children:e(h,{id:"SYKm3p"})})}),e("footer",{class:"filter-keywords-footer",children:[e("button",{type:"button",class:"light",onClick:()=>{w([...y,{_id:$r(),keyword:"",wholeWord:!0}]),setTimeout(()=>{var L,z;const R=C.current.querySelectorAll('input[type="text"]');(z=(L=R[R.length-1])==null?void 0:L.focus)==null||z.call(L)},10)},children:e(h,{id:"qn5Dbn"})})," ",(I==null?void 0:I.length)>1&&e("small",{class:"insignificant",children:e(h,{id:"1JZ175",values:{0:I.length}})})]})]}),e("div",{class:"filter-form-cols",children:[e("div",{class:"filter-form-col",children:[e("div",{children:e("b",{children:e(h,{id:"uqf7Yq"})})}),Ar.map(R=>e("div",{children:[e("label",{class:Qi.includes(R)?"insignificant":"",children:[e("input",{type:"checkbox",name:"context",value:R,defaultChecked:d?d.includes(R):!0,disabled:r==="loading"})," ",s(Rr[R]),Qi.includes(R)?"*":""]})," "]})),e("p",{children:e("small",{class:"insignificant",children:e(h,{id:"m0G499"})})})]}),e("div",{class:"filter-form-col",children:[l&&e(h,{id:"ucJk3m",components:{0:e("b",{}),1:e(Zs,{expiresAt:a,showNeverExpires:!0})}}),e("div",{children:[e("label",{for:"filters-expires_in",children:o(l?{id:"BcNdg+"}:{id:"agO/T/"})}),e("select",{id:"filters-expires_in",name:"expires_in",disabled:r==="loading",defaultValue:l?void 0:0,children:[l&&e("option",{}),Er.map(R=>e("option",{value:R,children:typeof Vn[R]=="function"?Vn[R]():s(Vn[R])}))]})]}),e("p",{children:[e(h,{id:"blQMpa"}),e("br",{}),e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"warn",defaultChecked:p==="warn"||!l,disabled:r==="loading"})," ",e(h,{id:"jbreWy"})]})," ",e("label",{class:"ib",children:[e("input",{type:"radio",name:"filter_action",value:"hide",defaultChecked:p==="hide",disabled:r==="loading"})," ",e(h,{id:"zNCBmf"})]})]})]})]}),e("footer",{class:"filter-form-footer",children:[e("span",{children:[e("button",{type:"submit",disabled:r==="loading",children:o(l?{id:"tfDRzk"}:{id:"hYgDIe"})})," ",e(Ue,{abrupt:!0,hidden:r!=="loading"})]}),l&&e(ut,{disabled:r==="loading",align:"end",menuItemClassName:"danger",confirmLabel:o({id:"BPjyR2"}),onClick:()=>{u("loading"),(async()=>{try{await c.v2.filters.$select(m).remove(),u("default"),i==null||i({state:"success"})}catch{u("error"),alert(o({id:"4Dh9J1"}))}})()},children:e("button",{type:"button",class:"light danger",onClick:()=>{},disabled:r==="loading",children:e(h,{id:"Jb6/SB"})})})]})]})})]})}function Zs({expiresAt:n,showNeverExpires:i}){const{_:s}=de(),o=!!n,c=o&&new Date(n),r=o&&c<=new Date,[u,l]=Et(d=>d+1,0);return ri(l,r||3e4),r?s({id:"M1RnFv"}):o?e(h,{id:"urGtsw",components:{0:e(It,{datetime:c})}}):i&&s({id:"O1Aswy"})}function Dr(){const{_:n}=de(),{masto:i,instance:s}=re();Qe(n({id:"Xi1/bw"}),"/fh");const[o,c]=M("default"),[r,u]=M([]);return ne(()=>{c("loading"),(async()=>{try{const l=await An();u(l),c("default")}catch{c("error")}})()},[]),e("div",{id:"followed-hashtags-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"Xi1/bw"})}),e("div",{class:"header-side"})]})}),e("main",{children:r.length>0?e(O,{children:[e("ul",{class:"link-list",children:r.map(l=>e("li",{children:e(be,{to:s?`/${s}/t/${l.name}`:`/t/${l.name}`,children:[e(x,{icon:"hashtag",alt:"#"})," ",e("span",{children:l.name})]})}))}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"2S/uvJ",values:{0:r.length}})})})]}):o==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):o==="error"?e("p",{class:"ui-state",children:e(h,{id:"2AeREO"})}):e("p",{class:"ui-state",children:e(h,{id:"vKsGhk"})})})]})})}const Nr=20;function _i({title:n,path:i,id:s,...o}){const{_:c}=de();Qe(n||c({id:"following.title"}),i||"/following");const{masto:r,streaming:u,instance:l}=re(),d=Ve(A),a=q(),m=q();__BENCHMARK.end("time-to-following");const b=et("@pixelfed/home-include-reblogs");async function g(f){var w;(f||!a.current)&&(__BENCHMARK.start("fetch-home-first"),a.current=r.v1.timelines.home.list({limit:Nr})),b&&((w=a.current)!=null&&w.nextParams)&&(typeof a.current.nextParams=="string"?a.current.nextParams+="&include_reblogs=true":a.current.nextParams.include_reblogs=!0);const v=await a.current.next();let{value:y}=v;if(y!=null&&y.length){let C=!1;f&&(y[0].id!==m.current&&(C=!0),m.current=y[0].id),y.forEach(S=>{Je(S,l)}),y=Zi(y,l),f&&C&&Ka(),Vs(y,l),y.sort((S,k)=>{const T=new Date(S.createdAt);return new Date(k.createdAt)-T})}return __BENCHMARK.end("fetch-home-first"),{...v,value:y}}async function p(){var f;try{const v={limit:5,since_id:m.current};et("@pixelfed/home-include-reblogs")&&(v.include_reblogs=!0);const y=await r.v1.timelines.home.list(v).next();let{value:w}=y;const C=((f=w[0])==null?void 0:f.id)===m.current;return!!(w!=null&&w.length&&!C&&(m.current=w[0].id,w=Zi(w,l),w=Nt(w,"home"),w.some(S=>!S.reblog)))}catch{return!1}}return ne(()=>{let f;return(async()=>{if(u){f=u.user.subscribe();for await(const v of f){if(!f)break;if(v.event==="status.update"){const y=v.payload;Je(y,l)}else if(v.event==="delete"){const y=v.payload,w=gs(y,l);w&&(w._deleted=!0)}}}})(),()=>{var v;(v=f==null?void 0:f.unsubscribe)==null||v.call(f),f=null}},[u]),e(xt,{title:n||c({id:"following.title"}),id:s||"following",emptyText:c({id:"nJEKbY"}),errorText:c({id:"7QSeK6"}),instance:l,fetchItems:g,checkForUpdates:p,useItemID:!0,boostsCarousel:d.settings.boostsCarousel,...o,filterContext:"home",showFollowedTags:!0,showReplyParent:!0})}const Or=20,zr=4,es=zr+1;function Ws({media:n,columnMode:i,...s}){const{_:o}=de();let{hashtag:c,...r}=i?{}:Mt();s.hashtag&&(c=s.hashtag);let u=c.trim().split(/[\s+]+/);u.sort(),c=u[0];const[l,d]=bt(),a=n||!!l.get("media"),m=a?"?media=1":"",{masto:b,instance:g,authenticated:p}=re({instance:(s==null?void 0:s.instance)||r.instance}),{masto:f,instance:v,authenticated:y}=re(),w=u.map($=>`#${$}`).join(" "),C=o(g?a?{id:"kH0rA0",values:{hashtagTitle:w,instance:g}}:{id:"IK0zKi",values:{hashtagTitle:w,instance:g}}:a?{id:"hHSI3w",values:{hashtagTitle:w}}:{id:"+ZzjRY",values:{hashtagTitle:w}});Qe(C,"/:instance?/t/:hashtag");const S=q(),k=_e(()=>ci(),[]),T=q(void 0);async function _($){const U=await b.v1.timelines.tag.$select(c).list({limit:Or,any:u.slice(1),maxId:$?void 0:T.current,onlyMedia:a?!0:void 0}).next();let{value:Y}=U;return Y!=null&&Y.length&&($&&(S.current=Y[0].id),Y.forEach(G=>{Je(G,g,{skipThreading:a||k})}),T.current=Y[Y.length-1].id),{...U,value:Y}}async function I(){var $;try{const U=await b.v1.timelines.tag.$select(c).list({limit:1,any:u.slice(1),since_id:S.current,onlyMedia:a}).next();let{value:Y}=U;const G=(($=Y[0])==null?void 0:$.id)===S.current;return Y!=null&&Y.length&&!G?(Y=Nt(Y,"public"),!0):!1}catch{return!1}}const[R,L]=M("default"),[z,P]=M();ne(()=>{(async()=>{try{const $=await b.v1.tags.$select(c).fetch();P($)}catch{}})()},[c]);const Z=u.length>=es,[ee,W]=M("default"),[V,B]=M([]),[F,se]=M(!1);return ne(()=>{p&&(async()=>{try{const $=await b.v1.featuredTags.list();B($),se($.some(U=>U.name.toLowerCase()===c.toLowerCase()))}catch{}})()},[]),e(xt,{title:C,titleComponent:!!g&&e("h1",{class:"header-double-lines",children:[e("b",{dir:"auto",children:w}),e("div",{children:g})]}),id:"hashtag",instance:g,emptyText:o({id:"CNSLAW"}),errorText:o({id:"yjj6Ll"}),fetchItems:_,checkForUpdates:I,useItemID:!0,view:a||k?"media":void 0,refresh:a,filterContext:"public",headerEnd:e(rt,{portal:!0,setDownOverflow:!0,overflow:"auto",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[!!z&&u.length===1&&e(O,{children:[e(ut,{subMenu:!0,confirm:z.following,confirmLabel:o({id:"ctJi7k",values:{hashtag:c}}),disabled:R==="loading"||!p,onClick:()=>{L("loading"),z.following?b.v1.tags.$select(c).unfollow().then(()=>{P({...z,following:!1}),me(o({id:"doK/ij",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{L("default")}):b.v1.tags.$select(c).follow().then(()=>{P({...z,following:!0}),me(o({id:"R9+aEN",values:{hashtag:c}}))}).catch($=>{alert($)}).finally(()=>{L("default")})},children:z.following?e(O,{children:[e(x,{icon:"check-circle"})," ",e("span",{children:e(h,{id:"HOSk7R"})})]}):e(O,{children:[e(x,{icon:"plus"})," ",e("span",{children:e(h,{id:"MKEPCY"})})]})}),e(Se,{type:"checkbox",checked:F,disabled:ee==="loading"||!p,onClick:()=>{if(W("loading"),F){const $=V.find(U=>U.name.toLowerCase()===c.toLowerCase()).id;$?b.v1.featuredTags.$select($).remove().then(()=>{se(!1),me(o({id:"VH+Tf9"})),B(V.filter(U=>U.id!==$))}).catch(U=>{}).finally(()=>{W("default")}):me(o({id:"3OLv47"}))}else b.v1.featuredTags.create({name:c}).then($=>{se(!0),me(o({id:"9ra4hn"})),B(V.concat($))}).catch($=>{}).finally(()=>{W("default")})},children:F?e(O,{children:[e(x,{icon:"check-circle"}),e("span",{children:e(h,{id:"9ra4hn"})})]}):e(O,{children:[e(x,{icon:"check-circle"}),e("span",{children:e(h,{id:"UlJ3QN"})})]})}),e(Ze,{})]}),!k&&e(O,{children:[e(Ts,{className:"plain",children:e(h,{id:"cSev+j"})}),e(Se,{type:"checkbox",checked:!!a,onClick:()=>{a?l.delete("media"):l.set("media","1"),d(l)},children:[e(x,{icon:"check-circle",alt:"☑️"})," ",e("span",{class:"menu-grow",children:e(h,{id:"eK4SL/"})})]}),e(Ze,{})]}),e(jo,{className:"menu-field",disabled:Z,children:({ref:$})=>e("form",{onSubmit:U=>{var G,te;U.preventDefault();const Y=(te=(G=U.target[0].value)==null?void 0:G.trim)==null?void 0:te.call(G);Y&&!u.some(ae=>ae.toLowerCase()===Y.toLowerCase())&&(u.push(Y),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${m}`:`/t/${u.join("+")}${m}`)},children:[e(x,{icon:"hashtag"}),e("input",{ref:$,type:"text",placeholder:Z?pe._({id:"ouWc/D",values:{TOTAL_TAGS_LIMIT:es}}):o({id:"cxL5F9"}),required:!0,autocorrect:"off",autocapitalize:"off",spellCheck:!1,pattern:"[^#][^\\s#]+[^#]",disabled:Z,dir:"auto"})]})}),e(Vo,{takeOverflow:!0,children:u.map(($,U)=>e(Se,{disabled:u.length===1,onClick:Y=>{u.splice(U,1),u.sort(),location.hash=g?`/${g}/t/${u.join("+")}${m}`:`/t/${u.join("+")}${m}`},children:[e(x,{icon:"x",alt:o({id:"OISAkj"}),class:"danger-icon"}),e("span",{class:"bidi-isolate",children:[e("span",{class:"more-insignificant",children:"#"}),$]})]},$))}),e(Ze,{}),e(Se,{disabled:!y,onClick:()=>{if(A.shortcuts.length>=Ct){alert(pe._({id:"XN1xAY",values:{SHORTCUTS_LIMIT:Ct}}));return}const $={type:"hashtag",hashtag:u.join(" "),instance:g,media:a?"on":void 0};A.shortcuts.some(Y=>Y.type===$.type&&Y.hashtag.split(/[\s+]+/).sort().join(" ")===$.hashtag.split(/[\s+]+/).sort().join(" ")&&(Y.instance?Y.instance===$.instance:!0)&&(Y.media?!!Y.media==!!$.media:!0))?alert(o({id:"kfeQnS"})):(A.shortcuts.push($),me(o({id:"MIhb91"})))},children:[e(x,{icon:"shortcut"})," ",e("span",{children:e(h,{id:"i02Lq/"})})]}),e(Se,{onClick:()=>{let $=prompt(o({id:"2MQ2cd"}));if(!/\./.test($)){$&&alert(o({id:"7WddtO"}));return}$&&($=$.toLowerCase().trim(),location.hash=`/${$}/t/${u.join("+")}${m}`)},children:[e(x,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),v!==g&&e(Se,{onClick:()=>{location.hash=`/${v}/t/${u.join("+")}${m}`},children:[e(x,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:v},components:{0:e("b",{})}})})]})]})},g+w)}const Br=20;function Xs(n){var C;const{_:i}=de(),s=Ve(A),{masto:o,instance:c}=re(),r=(n==null?void 0:n.id)||((C=Mt())==null?void 0:C.id),u=q(),l=q();async function d(S){(S||!l.current)&&(l.current=o.v1.timelines.list.$select(r).list({limit:Br}));const k=await l.current.next();let{value:T}=k;return T!=null&&T.length&&(S&&(u.current=T[0].id),T.forEach(_=>{Je(_,c)})),{...k,value:T}}async function a(){var S;try{const k=await o.v1.timelines.list.$select(r).list({limit:1,since_id:u.current});let{value:T}=k;const _=((S=T[0])==null?void 0:S.id)===u.current;return T!=null&&T.length&&!_?(T=Nt(T,"home"),!0):!1}catch{return!1}}const[m,b]=M([]);ne(()=>{ln().then(b)},[]);const[g,p]=M({title:"List"});Qe(g.title,"/l/:id"),ne(()=>{(async()=>{try{const S=await zs(r);p(S)}catch{}})()},[r]);const[f,v]=M(!1),[y,w]=M(!1);return e(O,{children:[e(xt,{title:g.title,id:"list",emptyText:i({id:"KkDhfU"}),errorText:i({id:"7QSeK6"}),instance:c,fetchItems:d,checkForUpdates:a,useItemID:!0,boostsCarousel:s.settings.boostsCarousel,filterContext:"home",showReplyParent:!0,headerStart:e(rt,{overflow:"auto",menuButton:e("button",{type:"button",class:"plain",children:[e(x,{icon:"list",size:"l",alt:i({id:"h16FyT"})}),e(x,{icon:"chevron-down",size:"s"})]}),children:[e(Ye,{to:"/l",children:e("span",{children:e(h,{id:"BHWx+g"})})}),(m==null?void 0:m.length)>0&&e(O,{children:[e(Ze,{}),m.map(S=>e(Ye,{to:`/l/${S.id}`,children:e("span",{children:S.title})},S.id))]})]}),headerEnd:e(rt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:i({id:"2FYpfJ"})})}),children:[e(Se,{onClick:()=>v({list:g}),children:[e(x,{icon:"pencil",size:"l"}),e("span",{children:e(h,{id:"ePK91l"})})]}),e(Se,{onClick:()=>w(!0),children:[e(x,{icon:"group",size:"l"}),e("span",{children:e(h,{id:"hB02vO"})})]})]})},r),f&&e(qe,{onClick:S=>{S.target===S.currentTarget&&v(!1)},children:e(wi,{list:f==null?void 0:f.list,onClose:S=>{S.state==="success"&&S.list?p(S.list):S.state==="deleted"&&(location.hash="/l"),v(!1)}})}),y&&e(qe,{onClick:S=>{S.target===S.currentTarget&&w(!1)},children:e(Fr,{listID:r,onClose:()=>w(!1)})})]})}const Ur=40;function Fr({listID:n,onClose:i}){const{_:s}=de(),{masto:o,instance:c}=re(),[r,u]=M([]),[l,d]=M("default"),[a,m]=M(!1),b=q();async function g(p){m(!1),d("loading"),(async()=>{try{(p||!b.current)&&(b.current=o.v1.lists.$select(n).accounts.list({limit:Ur}));const f=await b.current.next();let{done:v,value:y}=f;y!=null&&y.length?(u(p?y:r.concat(y)),m(!v)):m(!1),d("default")}catch{d("error")}})()}return ne(()=>{g(!0)},[]),e("div",{class:"sheet",id:"list-manage-members-container",children:[!!i&&e("button",{type:"button",class:"sheet-close",onClick:i,children:e(x,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"hB02vO"})})}),e("main",{children:e("ul",{children:[r.map(p=>e("li",{children:[e(ht,{account:p,instance:c}),e(Hr,{account:p,listID:n})]},p.id)),a&&l==="default"&&e(_t,{as:"li",onChange:p=>p&&g(),children:e("button",{type:"button",class:"light block",onClick:g,children:e(h,{id:"uXRAkV"})})})]})})]})}function Hr({account:n,listID:i}){const{_:s}=de(),{masto:o}=re(),[c,r]=M("default"),[u,l]=M(!1);return e(ut,{confirm:!u,confirmLabel:e("span",{children:e(h,{id:"j5n9Ry",values:{0:n.username},components:{0:e("span",{class:"bidi-isolate"})}})}),align:"end",menuItemClassName:"danger",onClick:()=>{u?(r("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.create({accountIds:[n.id]}),r("default"),l(!1)}catch{r("error")}})()):(r("loading"),(async()=>{try{await o.v1.lists.$select(i).accounts.remove({accountIds:[n.id]}),r("default"),l(!0)}catch{r("error")}})())},children:e("button",{type:"button",class:`light ${u?"":"danger"}`,disabled:c==="loading",children:s(u?{id:"m16xKo"}:{id:"MWIaew"})})})}const qr={mention:["account","status"],status:["account","status"],reblog:["account","status"],follow:["account"],follow_request:["account"],favourite:["account","status"],poll:["status"],update:["status"]},Yr=["favourite","reblog","follow"],Js=n=>Yr.includes(n);function Qs(n){return n.filter(i=>{const{type:s,id:o,createdAt:c}=i;if(!s)return!1;const r=qr[s];return r!=null&&r.length?r.every(u=>!!i[u]):!0})}function eo(n){if(n!=null&&n.notificationGroups){const{accounts:i=[],notificationGroups:s=[],statuses:o=[]}=n;return s.map(c=>{const{sampleAccountIds:r,statusId:u}=c,l=(r==null?void 0:r.map(a=>i.find(m=>m.id===a)))||[],d=(o==null?void 0:o.find(a=>a.id===u))||null;return{...c,sampleAccounts:l,status:d}})}return n}function jr(n){const i=n.map(u=>{const{latestPageNotificationAt:l,mostRecentNotificationId:d,sampleAccounts:a,notificationsCount:m}=u;return{id:""+d,createdAt:l,account:a[0],...u}}),s={},o=[];for(let u=0;u<i.length;u++){const l=i[u],{type:d,status:a,createdAt:m,notificationsCount:b,sampleAccounts:g,groupKey:p}=l,f=m?new Date(m).toLocaleDateString():"";let v=d;b>0&&(g==null||g.length),(d==="favourite"||d==="reblog")&&(v="favourite+reblog");const y=`${a==null?void 0:a.id}-${v}-${f}`,w=s[y];if(!Js(d))o.push(l);else if(w)g.forEach(C=>{const S=w.sampleAccounts.find(k=>k.id===C.id);S?(S._types.push(d),S._types.sort().reverse()):w.sampleAccounts.push({...C,_types:[d]})}),w.notificationsCount=Math.min(w.notificationsCount,b),w._notificationsCount.push(b),w._accounts=w.sampleAccounts,w._groupKeys.push(p);else{const C=g.map(S=>({...S,_types:[d]}));s[y]={...l,sampleAccounts:C,type:v,_accounts:C,_groupKeys:p?[p]:[],_notificationsCount:[b]},o.push(s[y])}}const c={},r=[];for(let u=0;u<o.length;u++){const l=o[u],{type:d,account:a,_accounts:m,sampleAccounts:b,createdAt:g,groupKey:p}=l,f=g?new Date(g).toLocaleDateString():"",v=(b==null?void 0:b.length)===1||(m==null?void 0:m.length)===1;if((d==="favourite"||d==="reblog"||d==="favourite+reblog")&&v){const y=`${a==null?void 0:a.id}-${d}-${f}`,w=c[y];if(w)w._statuses.push(l.status),w._ids+=`-${l.id}`,w._groupKeys.push(p);else{let C=c[y]={...l,type:d,_ids:l.id,_statuses:[l.status],_groupKeys:p?[p]:[]};r.push(C)}}else r.push(l)}return r}function Vr(n){n=Qs(n);const i={},s=[];for(let r=0,u=0;r<n.length;r++){const l=n[r],{id:d,status:a,account:m,type:b,createdAt:g}=l,p=g?new Date(g).toLocaleDateString():"";let f=b;(b==="favourite"||b==="reblog")&&(f="favourite+reblog");const v=`${a==null?void 0:a.id}-${f}-${p}`,y=i[v];if(!Js(b))s[u++]=l;else if(y!=null&&y.account){const w=y._accounts.find(C=>C.id===m.id);w?(w._types.push(b),w._types.sort().reverse(),y._ids+=`-${d}`):(m._types=[b],y._accounts.push(m),y._ids+=`-${d}`)}else{m&&(m._types=[b]);let w=i[v]={...l,type:f,_ids:d,_accounts:m?[m]:[]};s[u++]=w}}const o={},c=[];for(let r=0,u=0;r<s.length;r++){const l=s[r],{id:d,account:a,_accounts:m,type:b,createdAt:g}=l,p=g?new Date(g).toLocaleDateString():"";if(b==="favourite+reblog"&&a&&m.length===1){const f=`${a==null?void 0:a.id}-${b}-${p}`,v=o[f];if(v)v._statuses.push(l.status),v._ids+=`-${d}`;else{let y=o[f]={...l,type:b,_ids:d,_statuses:[l.status]};c[u++]=y}}else c[u++]=l}return c}const ts=20,Gr=new URLSearchParams;function to({columnMode:n,...i}){const{_:s}=de(),{masto:o,instance:c}=re(),[r]=n?[Gr]:bt(),[u,l]=M(null),d=(i==null?void 0:i.type)||r.get("type")||u;Qe(s(d==="private"?{id:"2BApYc"}:{id:"/bZzdR"}),"/mentions");const a=q(),m=q();async function b(C){(C||!a.current)&&(a.current=o.v1.notifications.list({limit:ts,types:["mention"]}));const S=await a.current.next();let{value:k}=S;return k!=null&&k.length&&(k=Qs(k),C&&(m.current=k[0].id),k.forEach(({status:T})=>{Je(T,c)})),{...S,value:k==null?void 0:k.map(T=>T.status)}}const g=q(),p=q();async function f(C){(C||!g.current)&&(g.current=o.v1.conversations.list({limit:ts}));const S=await g.current.next();let{value:k}=S;return k=k==null?void 0:k.filter(T=>T.lastStatus),k!=null&&k.length&&(C&&(p.current=k[0].lastStatus.id),k.forEach(({lastStatus:T})=>{Je(T,c)})),{...S,value:k==null?void 0:k.map(T=>T.lastStatus)}}function v(...C){return d==="private"?f(...C):b(...C)}async function y(){var C;if(d==="private")try{const S=await o.v1.conversations.list({limit:1,since_id:p.current}).next();let{value:k}=S;const T=((C=k[0])==null?void 0:C.id)===p.current;return k!=null&&k.length&&!T?(p.current=k[0].lastStatus.id,!0):!1}catch{return!1}else try{const S=await o.v1.notifications.list({limit:1,types:["mention"],since_id:m.current}).next();let{value:k}=S;return k!=null&&k.length?(m.current=k[0].id,!0):!1}catch{return!1}}const w=_e(()=>e("div",{class:"filter-bar centered",children:[e(be,{to:"/mentions",class:d?"":"is-active",onClick:C=>{n&&(C.preventDefault(),l(null))},children:e(h,{id:"N40H+G"})}),e(be,{to:"/mentions?type=private",class:d==="private"?"is-active":"",onClick:C=>{n&&(C.preventDefault(),l("private"))},children:e(h,{id:"zwBp5t"})})]}),[d]);return e(xt,{title:s({id:"/bZzdR"}),id:"mentions",emptyText:s({id:"03jFGT"}),errorText:s({id:"pqR9KF"}),instance:c,fetchItems:v,checkForUpdates:y,useItemID:!0,timelineStart:w,refresh:d})}const Kr=80,Zr=20,Wr=new URLSearchParams,hn={block:"center",inline:"center",behavior:"smooth"},no=ms(()=>et("@mastodon/grouped-notifications"),{maxAge:1e3*60*5});function ti(n={}){const{masto:i}=re();return A.settings.groupedNotificationsAlpha&&no()?i.v2.notifications.list({limit:Zr,...n}):i.v1.notifications.list({limit:Kr,...n})}function io(n){return A.settings.groupedNotificationsAlpha&&no()?jr(n):Vr(n)}const Xr=["forNotFollowing","forNotFollowers","forNewAccounts","forPrivateMentions","forLimitedAccounts"],Jr={forNotFollowing:{id:"d+hDoa"},forNotFollowers:{id:"oAwuQj"},forNewAccounts:{id:"Srs8u7"},forPrivateMentions:{id:"IDC5Uw"},forLimitedAccounts:{id:"XMGM2e"}};function Qr({columnMode:n}){var ue;const{_:i,_:s}=de();Qe(s({id:"iDNBZe"}),"/notifications");const{masto:o,instance:c}=re(),r=Ve(A),[u,l]=M("default"),[d]=n?[Wr]:bt(),a=d.get("id"),m=d.get("access_token"),[b,g]=M(!1),[p,f]=M(!1),v=q(),{nearReachEnd:y,scrollDirection:w,reachStart:C,nearReachStart:S}=Za({scrollableRef:v}),k=w==="end"&&!S,[T,_]=M([]),[I,R]=M([]),L=q();async function z(D){var H;if((D||!L.current)&&(L.current=ti({excludeTypes:["follow_request"]})),/max_id=($|&)/i.test((H=L.current)==null?void 0:H.nextParams))return{done:!0};const le=await L.current.next(),xe=eo(le.value);if(xe!=null&&xe.length){xe.forEach(Re=>{Je(Re.status,c,{skipThreading:!0})});const ve=io(xe);D?(A.notificationsLast=ve[0],A.notifications=ve,o.v1.markers.create({notifications:{lastReadId:ve[0].id}}).catch(()=>{})):A.notifications.push(...ve)}return A.notificationsShowNew=!1,A.notificationsLastFetchTime=Date.now(),le}async function P(){try{return await o.v1.followRequests.list({limit:80})}catch{return[]}}const Z=()=>{l("loading"),(async()=>{try{const D=await P();_(D),l("default")}catch{l("error")}})()};async function ee(){try{return await o.v1.announcements.list()}catch{return[]}}const W=et("@mastodon/filtered-notifications"),[V,B]=M(!1),[F,se]=M({});function $(){return o.v2.notifications.policy.fetch().catch(()=>{})}function U(){$().then(D=>{se(D)}).catch(()=>{})}const[Y,G]=M(null);function te(){return o.v1.notifications.requests.list()}const ae=D=>{Ce(!1),l("loading"),(async()=>{try{const le=z(D);D&&(ee().then(H=>{H.sort((ve,Re)=>{const E=new Date(ve.updatedAt||ve.createdAt);return new Date(Re.updatedAt||Re.createdAt)-E}),R(H)}).catch(()=>{}),P().then(H=>{_(H)}).catch(()=>{}),W&&U());const{done:xe}=await le;g(!xe),l("default")}catch{l("error")}})()};ne(()=>{ae(!0)},[]),ne(()=>{C&&ae(!0)},[C]);const[ye,Ce]=M(!1),j=st(({disableIdleCheck:D=!1}={})=>{var le;u!=="loading"&&r.settings.autoRefresh&&((le=v.current)==null?void 0:le.scrollTop)<16&&(D||window.__IDLE__)&&!el()&&ae(!0)},[r.notificationsShowNew,r.settings.autoRefresh,u]),he=q();Vt(D=>{if(D){const le=Date.now()-he.current;!he.current||le>1e3*3?j({disableIdleCheck:!0}):he.current=Date.now()}});const Te=q(!0);ne(()=>{let D=Io(A,"notificationsShowNew",le=>{if(Te.current){Te.current=!1;return}u!=="loading"&&(le&&j(),Ce(le))});return()=>D==null?void 0:D()},[]);const Pe=new Date,De=new Date(Pe-24*60*60*1e3);let Be=new Date;const Ee=!r.notifications.some(D=>new Date(D.createdAt).toDateString()===Pe.toDateString()),Me=q();ne(()=>{a&&(A.routeNotification={id:a,accessToken:atob(m)})},[a,m]);const[X,Ie]=M(null);ne(async()=>{var H,ve,Re;const D=new Date;if(D.getMonth()!==11||!et("@mastodon/annual-report"))return;let le=ke.account.get("annualReportNotification");if(le){Ie(le);return}const xe=ti({types:["annual_report"]});try{const E=await xe.next();le=(ve=(H=E==null?void 0:E.value)==null?void 0:H.notificationGroups)==null?void 0:ve[0],((Re=le==null?void 0:le.annualReport)==null?void 0:Re.year)==D.getFullYear()&&(Ie(le),ke.account.set("annualReportNotification",le))}catch{}},[]);const Ne=".notification",fe=He("j",()=>{const D=document.activeElement.closest(Ne),le=D==null?void 0:D.getBoundingClientRect(),xe=Array.from(v.current.querySelectorAll(Ne));if(D&&le.top<v.current.clientHeight&&le.bottom>0){const H=xe.indexOf(D);let ve=xe[H+1];ve&&(ve.focus(),ve.scrollIntoView(hn))}else{const H=xe.find(ve=>{const Re=ve.getBoundingClientRect();return Re.top>=44&&Re.left>=0});H&&(H.focus(),H.scrollIntoView(hn))}}),Q=He("k",()=>{const D=document.activeElement.closest(Ne),le=D==null?void 0:D.getBoundingClientRect(),xe=Array.from(v.current.querySelectorAll(Ne));if(D&&le.top<v.current.clientHeight&&le.bottom>0){const H=xe.indexOf(D);let ve=xe[H-1];ve&&(ve.focus(),ve.scrollIntoView(hn))}else{const H=xe.find(ve=>{const Re=ve.getBoundingClientRect();return Re.top>=44&&Re.left>=0});H&&(H.focus(),H.scrollIntoView(hn))}}),ge=He(["enter","o"],()=>{const D=document.activeElement.closest(Ne),le=D==null?void 0:D.querySelector(".status-link");le&&le.click()}),N=new Date,ie=_e(()=>ot(N,{forceOpts:{weekday:"long"}}),[N]);return e("div",{id:"notifications-page",class:"deck-container",ref:D=>{v.current=D,fe(D),Q(D),ge(D)},tabIndex:"-1",children:[e("div",{class:`timeline-deck deck ${p?"only-mentions":""}`,children:[e("header",{hidden:k,onClick:D=>{var le;D.target.closest("a, button")||(le=v.current)==null||le.scrollTo({top:0,behavior:"smooth"})},onDblClick:D=>{D.target.closest("a, button")||ae(!0)},class:u==="loading"?"loading":"",children:[e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l",alt:s({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"iDNBZe"})}),e("div",{class:"header-side",children:W&&e("button",{type:"button",class:"button plain4",onClick:()=>{B(!0)},children:e(x,{icon:"settings",size:"l",alt:s({id:"a/+arl"})})})})]}),ye&&u!=="loading"&&e("button",{class:"updates-button shiny-pill",type:"button",onClick:()=>{var D;ae(!0),(D=v.current)==null||D.scrollTo({top:0,behavior:"smooth"})},children:[e(x,{icon:"arrow-up"})," ",e(h,{id:"Jy9RU/"})]})]}),I.length>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("details",{class:"announcements",children:[e("summary",{children:[e("span",{children:[e(x,{icon:"announce",class:"announcement-icon",size:"l"})," ",e(h,{id:"0whvLM",values:{0:I.length}})," ",e("small",{class:"insignificant",children:c})]}),I.length>1&&e("span",{class:"announcements-nav-buttons",children:I.map((D,le)=>e("button",{type:"button",class:"plain2 small",onClick:()=>{var xe;(xe=Me.current)==null||xe.children[le].scrollIntoView({behavior:"smooth",block:"nearest"})},children:le+1}))})]}),e("ul",{class:`announcements-list-${I.length>1?"multiple":"single"}`,ref:Me,children:I.map(D=>e("li",{children:e(tl,{announcement:D})}))})]})})}),T.length>0&&e("div",{class:"follow-requests",children:[e("h2",{class:"timeline-header",children:e(h,{id:"6Fs1Ba"})}),T.length>5?e("details",{children:[e("summary",{children:e(h,{id:"7dHKu4",values:{0:T.length}})}),e("ul",{children:T.map(D=>e("li",{children:[e(ht,{account:D}),e(ei,{accountID:D.id,onChange:()=>{}})]},D.id))})]}):e("ul",{children:T.map(D=>e("li",{children:[e(ht,{account:D}),e(ei,{accountID:D.id,onChange:()=>{}})]},D.id))})]}),W&&((ue=F==null?void 0:F.summary)==null?void 0:ue.pendingRequestsCount)>0&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e("div",{class:"filtered-notifications",children:e("details",{onToggle:async D=>{const{open:le}=D.target;if(le){const xe=await te();G(xe)}},children:[e("summary",{children:e(h,{id:"N3Bq0f",values:{0:F.summary.pendingRequestsCount}})}),Y?(Y==null?void 0:Y.length)>0&&e("ul",{children:Y.map(D=>{var le,xe;return e("li",{children:[e("div",{class:"request-notifcations",children:[!((le=D.lastStatus)!=null&&le.id)&&e(ht,{useAvatarStatic:!0,showStats:!0,account:D.account}),((xe=D.lastStatus)==null?void 0:xe.id)&&e("div",{class:"last-post",children:e(be,{class:"status-link",to:`/${c}/s/${D.lastStatus.id}`,children:e(je,{status:D.lastStatus,size:"s",readOnly:!0})})}),e(il,{request:D})]}),e(sl,{request:D,onChange:()=>{ae(!0)}})]},D.id)})}):e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})})]})})})}),X&&e("div",{class:"shazam-container",children:e("div",{class:"shazam-container-inner",children:e(an,{notification:X})})}),e("div",{id:"mentions-option",children:e("label",{children:[e("input",{type:"checkbox",checked:p,onChange:D=>{f(D.target.checked)}})," ",e(h,{id:"0udtPI"})]})}),e("h2",{class:"timeline-header",children:[e(h,{id:"ecUA8p"})," ",e("small",{class:"insignificant bidi-isolate",children:ie})]}),Ee&&e("p",{class:"ui-state insignificant",children:u==="default"?s({id:"KS7iJH"}):e(O,{children:"…"})}),r.notifications.length?e(O,{children:r.notifications.filter(D=>D.type!=="follow_request").map(D=>{if(p&&D.type!=="mention")return null;const le=new Date(D.createdAt),xe=le.toDateString()!==Be.toDateString();xe&&(Be=le);const H=le.toDateString()===De.toDateString()?s({id:"y/0uwd"}):ot(Be,{hideTime:!0}),ve=ot(Be,{forceOpts:{weekday:"long"}});return e(O,{children:[xe&&e("h2",{class:"timeline-header",children:[e("span",{children:H})," ",e("small",{class:"insignificant bidi-isolate",children:ve})]}),e(an,{instance:c,notification:D},D._ids||D.id)]},D._ids||D.id)})}):e(O,{children:[u==="loading"&&e(O,{children:e("ul",{class:"timeline flat",children:Array.from({length:5}).map((D,le)=>e("li",{class:"notification skeleton",children:[e("div",{class:"notification-type",children:e(x,{icon:"notification",size:"xl"})}),e("div",{class:"notification-content",children:e("p",{children:"███████████ ████"})})]}))})}),u==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"gjzl8E"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>ae(!0),children:e(h,{id:"KDw4GX"})})]})]}),b&&e(_t,{onChange:D=>{D&&ae()},children:e("button",{type:"button",class:"plain block",disabled:u==="loading",onClick:()=>ae(),style:{marginBlockEnd:"6em"},children:u==="loading"?e(Ue,{abrupt:!0}):e(h,{id:"uXRAkV"})})})]}),W&&V&&e(qe,{onClick:D=>{D.target===D.currentTarget&&B(!1)},children:e("div",{class:"sheet",id:"notifications-settings",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:()=>B(!1),children:e(x,{icon:"x",alt:s({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:e(h,{id:"a/+arl"})})}),e("main",{children:e("form",{onSubmit:D=>{D.preventDefault();const{forNotFollowing:le,forNotFollowers:xe,forNewAccounts:H,forPrivateMentions:ve,forLimitedAccounts:Re}=D.target,E={...F,forNotFollowing:le.value,forNotFollowers:xe.value,forNewAccounts:H.value,forPrivateMentions:ve.value,forLimitedAccounts:Re.value};se(E),B(!1),(async()=>{try{await o.v2.notifications.policy.update(E),me(s({id:"4+7X9i"}))}catch{}})()},children:[e("p",{children:e(h,{id:"WrkPTf"})}),e("div",{class:"notification-policy-fields",children:Xr.map(D=>{const le=F[D];return e("div",{children:e("label",{children:[i(Jr[D]),e("select",{name:D,defaultValue:le,class:"small",children:[e("option",{value:"accept",children:e(h,{id:"g3UF2V"})}),e("option",{value:"filter",children:e(h,{id:"o7J4JM"})}),e("option",{value:"drop",children:e(h,{id:"gbbkE7"})})]})]})},D)})}),e("p",{children:e("button",{type:"submit",children:e(h,{id:"tfDRzk"})})})]})})]})})]})}function el(){return!!document.querySelector(".deck-backdrop, #modal-container > *")}function tl({announcement:n}){const{instance:i}=re(),{contact:s}=hs(),o=s==null?void 0:s.account,{id:c,content:r,startsAt:u,endsAt:l,published:d,allDay:a,publishedAt:m,updatedAt:b,read:g,mentions:p,statuses:f,tags:v,emojis:y,reactions:w}=n,C=new Date(m),S=ot(C),k=new Date(b),T=ot(k);return e("div",{class:"announcement-block",children:[e(ht,{account:o}),e("div",{class:"announcement-content",onClick:ks({mentions:p,instance:i}),dangerouslySetInnerHTML:{__html:Zn(r,{emojis:y})}}),e("p",{class:"insignificant",children:[e("time",{datetime:C.toISOString(),children:ot(C)}),b&&T!==S&&e(O,{children:[" ","•"," ",e("span",{class:"ib",children:e(h,{id:"TbFrLc",values:{0:ot(k)},components:{0:e("time",{datetime:k.toISOString()})}})})]})]}),e("div",{class:"announcement-reactions",hidden:!0,children:w.map(_=>{const{name:I,count:R,me:L,staticUrl:z,url:P}=_;return e("button",{type:"button",class:`plain4 small ${L?"reacted":""}`,children:[P||z?e("img",{src:P||z,alt:I,width:"16",height:"16"}):e("span",{children:I})," ",e("span",{class:"count",children:Xe(R)})]})})})]})}function nl(n){const{masto:i}=re();return i.v1.notifications.list({accountID:n})}function il({request:n}){var b;const{instance:i}=re(),[s,o]=M("loading"),{account:c,lastStatus:r}=n,[u,l]=M(!1),[d,a]=M([]);function m(){l(!1)}return ne(()=>{var g;(g=n==null?void 0:n.account)!=null&&g.id&&u&&(o("loading"),(async()=>{const p=await nl(n.account.id);a(p||[]),o("default")})())},[u,(b=n==null?void 0:n.account)==null?void 0:b.id]),e(O,{children:[e("button",{type:"button",class:"plain4 request-notifications-account",onClick:()=>{l(!0)},children:[e(x,{icon:"notification",class:"more-insignificant"})," ",e("small",{children:e(h,{id:"H0wUNM",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})," ",e(x,{icon:"chevron-down"})]}),u&&e(qe,{onClick:g=>{g.target===g.currentTarget&&m()},children:e("div",{class:"sheet",tabIndex:"-1",children:[e("button",{type:"button",class:"sheet-close",onClick:m,children:e(x,{icon:"x",alt:t`Close`})}),e("header",{children:e("b",{children:e(h,{id:"MXOmPt",values:{0:c.username},components:{0:e("span",{class:"bidi-isolate"})}})})}),e("main",{children:s==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):d.map(g=>e("div",{class:"notification-peek",onClick:p=>{const{target:f}=p;(p.target.tagName==="BUTTON"||p.target.tagName==="A")&&m()},children:e(an,{instance:i,notification:g,isStatic:!0})}))})]})})]})}function sl({request:n,onChange:i}){const{_:s}=de(),{masto:o}=re(),[c,r]=M("default"),[u,l]=M(null),d=u!==null;return e("p",{class:"notification-request-buttons",children:[e("button",{type:"button",disabled:c==="loading"||d,onClick:()=>{r("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).accept(),l("accept"),r("default"),i({request:n,state:"accept"}),me(s({id:"ZtBMwU",values:{0:n.account.username}}))}catch{r("error"),me(s({id:"S92JKG"}))}})()},children:e(h,{id:"h7peZQ"})})," ",e("button",{type:"button",disabled:c==="loading"||d,class:"light danger",onClick:()=>{r("loading"),(async()=>{try{await o.v1.notifications.requests.$select(n.id).dismiss(),l("dismiss"),r("default"),i({request:n,state:"dismiss"}),me(s({id:"pRqdUf",values:{1:n.account.username}}))}catch{r("error"),me(s({id:"S5aemF"}))}})()},children:e(h,{id:"1QfxQT"})}),e("span",{class:"notification-request-states",children:c==="loading"?e(Ue,{abrupt:!0}):u==="accept"?e(x,{icon:"check-circle",alt:s({id:"bzMKg7"}),class:"notification-accepted"}):u==="dismiss"&&e(x,{icon:"x-circle",alt:s({id:"J6hrEy"}),class:"notification-dismissed"})})]})}const so=lt(Qr),ol=20;function ni({local:n,columnMode:i,...s}){const{_:o}=de(),c=Ve(A),r=!!n,u=i?{}:Mt(),{masto:l,instance:d}=re({instance:(s==null?void 0:s.instance)||u.instance}),{masto:a,instance:m}=re(),b=o(r?{id:"u96B/B",values:{instance:d}}:{id:"PgVqvd",values:{instance:d}});Qe(b,r?"/:instance?/p/l":"/:instance?/p");const g=q(),p=q();async function f(y){if(y||!p.current){const S={limit:ol,local:r||void 0};!r&&et("@pixelfed/global-feed")&&(S.remote=!0),p.current=l.v1.timelines.public.list(S)}const w=await p.current.next();let{value:C}=w;return C!=null&&C.length&&(y&&(g.current=C[0].id),C.forEach(S=>{Je(S,d)})),{...w,value:C}}async function v(){var y;try{const w=await l.v1.timelines.public.list({limit:1,local:r,since_id:g.current}).next();let{value:C}=w;const S=((y=C[0])==null?void 0:y.id)===g.current;return C!=null&&C.length&&!S?(C=Nt(C,"public"),!0):!1}catch{return!1}}return e(xt,{title:b,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:o(r?{id:"pJQgQV"}:{id:"cg0I+x"})}),e("div",{children:d})]}),id:"public",instance:d,emptyText:o({id:"BiZJ6G"}),errorText:o({id:"scd9lw"}),fetchItems:f,checkForUpdates:v,useItemID:!0,headerStart:e(O,{}),boostsCarousel:c.settings.boostsCarousel,filterContext:"public",headerEnd:e(rt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:o({id:"2FYpfJ"})})}),children:[e(Se,{href:r?`/#/${d}/p`:`/#/${d}/p/l`,children:r?e(O,{children:[e(x,{icon:"transfer"})," ",e("span",{children:e(h,{id:"dXMiUw"})})]}):e(O,{children:[e(x,{icon:"transfer"})," ",e("span",{children:e(h,{id:"t2B/we"})})]})}),e(Ze,{}),e(Se,{onClick:()=>{let y=prompt(o({id:"2MQ2cd"}));if(!/\./.test(y)){y&&alert(o({id:"7WddtO"}));return}y&&(y=y.toLowerCase().trim(),location.hash=r?`/${y}/p/l`:`/${y}/p`)},children:[e(x,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),m!==d&&e(Se,{onClick:()=>{location.hash=r?`/${m}/p/l`:`/${m}/p`},children:[e(x,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:m},components:{0:e("b",{})}})})]})]})},d+r)}const fn=5,Gn=40,cl=new URLSearchParams,pn={block:"nearest",inline:"center",behavior:"smooth"};function oo({columnMode:n,...i}){const{_:s}=de(),o=n?{}:Mt(),{masto:c,instance:r,authenticated:u}=re({instance:o.instance}),[l,d]=M("default"),[a]=n?[cl]:bt(),m=q(),b=(i==null?void 0:i.query)||a.get("q"),g=n?"statuses":(i==null?void 0:i.type)||a.get("type");let p=s({id:"A1taO8"});if(b)switch(g){case"statuses":p=s({id:"6YeoAt",values:{q:b}});break;case"accounts":p=s({id:"fpgumQ",values:{q:b}});break;case"hashtags":p=s({id:"AuiMZZ",values:{q:b}});break;default:p=s({id:"wr3GZI",values:{q:b}})}Qe(p,"/search");const[f,v]=M(!1),y=q(0);ne(()=>{y.current=0},[b,g]);const w=q();wt(()=>{var $,U;(U=($=w.current)==null?void 0:$.scrollTo)==null||U.call($,0,0)},[b,g]);const[C,S]=M([]),[k,T]=M([]),[_,I]=M([]);ne(()=>{S([]),T([]),I([])},[b]);const R={statuses:C,accounts:k,hashtags:_},L={statuses:S,accounts:T,hashtags:I},[z,P]=M({}),Z=async $=>{if(!($!=null&&$.length))return;const U=await di($,z);U&&P({...z,...U})};function ee($){$&&(y.current=0),!(!$&&!u)&&(d("loading"),$&&!g&&(S(C.slice(0,fn)),T(k.slice(0,fn)),I(_.slice(0,fn))),(async()=>{var Y,G,te,ae,ye,Ce;const U={q:b,resolve:u,limit:fn};g&&(U.limit=Gn,U.type=g,u&&(U.offset=y.current));try{const j=await c.v2.search.fetch(U);if(g)if($){L[g](j[g]);const he=(Y=j[g])==null?void 0:Y.length;y.current=Gn,v(!!he)}else if(((te=(G=j[g])==null?void 0:G[0])==null?void 0:te.id)===((ye=(ae=R[g])==null?void 0:ae[0])==null?void 0:ye.id))v(!1);else{L[g](Te=>[...Te,...j[g]]);const he=(Ce=j[g])==null?void 0:Ce.length;y.current=y.current+Gn,v(!!he)}else S(j.statuses||[]),T(j.accounts||[]),I(j.hashtags||[]),y.current=0,v(!1);Z(j.accounts),d("default")}catch{d("error")}})())}const W=q();Vt($=>{var Y;const U=((Y=w.current)==null?void 0:Y.scrollTop)===0;if($&&U){const G=Date.now()-W.current;!W.current||G>1e3*3?ee(!0):W.current=Date.now()}}),ne(()=>{var U,Y;let $;return(Y=(U=m.current)==null?void 0:U.setValue)==null||Y.call(U,b||""),b?ee(!0):$=setTimeout(()=>{var G,te;(te=(G=m.current)==null?void 0:G.focus)==null||te.call(G)},150),()=>clearTimeout($)},[b,g,r]),He(["/","Slash"],$=>{var U,Y,G,te;(Y=(U=m.current)==null?void 0:U.focus)==null||Y.call(U),(te=(G=m.current)==null?void 0:G.select)==null||te.call(G)},{preventDefault:!0});const V=".timeline > li > a, .hashtag-list > li > a",B=He("j",()=>{const $=document.activeElement.closest(V),U=$==null?void 0:$.getBoundingClientRect(),Y=Array.from(w.current.querySelectorAll(V));if($&&U.top<w.current.clientHeight&&U.bottom>0){const G=Y.indexOf($);let te=Y[G+1];te&&(te.focus(),te.scrollIntoView(pn))}else{const G=Y.find(te=>{const ae=te.getBoundingClientRect();return ae.top>=44&&ae.left>=0});G&&(G.focus(),G.scrollIntoView(pn))}}),F=He("k",()=>{const $=document.activeElement.closest(V),U=$==null?void 0:$.getBoundingClientRect(),Y=Array.from(w.current.querySelectorAll(V));if($&&U.top<w.current.clientHeight&&U.bottom>0){const G=Y.indexOf($);let te=Y[G-1];te&&(te.focus(),te.scrollIntoView(pn))}else{const G=Y.find(te=>{const ae=te.getBoundingClientRect();return ae.top>=44&&ae.left>=0});G&&(G.focus(),G.scrollIntoView(pn))}}),[se]=gi();return e("div",{id:"search-page",class:"deck-container",tabIndex:"-1",ref:$=>{w.current=$,B($),F($)},children:e("div",{class:"timeline-deck deck",children:[e("header",{class:l==="loading"?"loading":"",children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:e(Lt,{})}),e(js,{ref:m}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>{ee(!0)},disabled:l==="loading",children:e(x,{icon:"search",size:"l",alt:s({id:"A1taO8"})})})})]})}),e("main",{children:[!!b&&!n&&e("div",{ref:se,class:`filter-bar ${l==="loading"?"loading":""}`,children:[!!g&&e(be,{to:`/search${b?`?q=${encodeURIComponent(b)}`:""}`,children:[e(x,{icon:"chevron-left"})," ",e(h,{id:"N40H+G"})]}),[{label:s({id:"bPwFdf"}),type:"accounts",to:`/search?q=${encodeURIComponent(b)}&type=accounts`},{label:s({id:"VwUsHI"}),type:"hashtags",to:`/search?q=${encodeURIComponent(b)}&type=hashtags`},{label:s({id:"+owNNn"}),type:"statuses",to:`/search?q=${encodeURIComponent(b)}&type=statuses`}].sort(($,U)=>$.type===g?-1:U.type===g?1:0).map($=>e(be,{to:$.to,children:$.label},$.type))]}),b?e(O,{children:[(!g||g==="accounts")&&e(O,{children:[g!=="accounts"&&e("h2",{class:"timeline-header",children:[e(h,{id:"bPwFdf"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=accounts`,children:e(x,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),k.length>0?e(O,{children:[e("ul",{class:"timeline flat accounts-list",children:k.map($=>e("li",{children:e(ht,{account:$,instance:r,showStats:!0,relationship:z[$.id]})},$.id))}),g!=="accounts"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=accounts`,children:[e(h,{id:"BMmtZ8"})," ",e(x,{icon:"arrow-right"})]})})]}):!g&&(l==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"YYB61U"})}))]}),(!g||g==="hashtags")&&e(O,{children:[g!=="hashtags"&&e("h2",{class:"timeline-header",children:[e(h,{id:"VwUsHI"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=hashtags`,children:e(x,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),_.length>0?e(O,{children:[e("ul",{class:"link-list hashtag-list",children:_.map($=>{var te;const{name:U,history:Y}=$,G=(te=Y==null?void 0:Y.reduce)==null?void 0:te.call(Y,(ae,ye)=>ae+ +ye.uses,0);return e("li",{children:e(be,{to:r?`/${r}/t/${U}`:`/t/${U}`,children:[e(x,{icon:"hashtag",alt:"#"}),e("span",{children:U}),!!G&&e("span",{class:"count",children:Xe(G)})]})},`${U}-${G}`)})}),g!=="hashtags"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=hashtags`,children:[e(h,{id:"Nc/W5J"})," ",e(x,{icon:"arrow-right"})]})})]}):!g&&(l==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"4MFM3P"})}))]}),(!g||g==="statuses")&&e(O,{children:[g!=="statuses"&&e("h2",{class:"timeline-header",children:[e(h,{id:"+owNNn"})," ",e(be,{to:`/search?q=${encodeURIComponent(b)}&type=statuses`,children:e(x,{icon:"arrow-right",size:"l",alt:s({id:"V1fa9u"})})})]}),C.length>0?e(O,{children:[e("ul",{class:"timeline",children:C.map($=>e("li",{children:e(be,{class:"status-link",to:r?`/${r}/s/${$.id}`:`/s/${$.id}`,children:e(je,{status:$})})},$.id))}),g!=="statuses"&&e("div",{class:"ui-state",children:e(be,{class:"plain button",to:`/search?q=${encodeURIComponent(b)}&type=statuses`,children:[e(h,{id:"LYCgej"})," ",e(x,{icon:"arrow-right"})]})})]}):!g&&(l==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"Hzi9AA"})}))]}),!!g&&(l==="default"?f?e(_t,{onChange:$=>{$&&ee()},children:e("button",{type:"button",class:"plain block",onClick:()=>ee(),style:{marginBlockEnd:"6em"},children:e(h,{id:"uXRAkV"})})}):e("p",{class:"ui-state insignificant",children:e(h,{id:"2EYeAZ"})}):l==="loading"&&e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}))]}):l==="loading"?e("p",{class:"ui-state",children:e(Ue,{abrupt:!0})}):e("p",{class:"ui-state",children:e(h,{id:"fGn1Hk"})})]})]})})}const al=20,co=10*60*1e3,rl=gt(n=>n.v1.trends.links.list().next(),{maxAge:co}),ll=gt(n=>n.v1.trends.tags.list().next(),{maxAge:co});function dl(n){return et("@pixelfed/trending")?n.pixelfed.v2.discover.posts.trending.list({range:"daily"}):n.v1.trends.statuses.list({limit:al})}function ul(n,i){return n.v1.timelines.link.list(i)}function ao({columnMode:n,...i}){const{_:s}=de(),o=Ve(A),c=n?{}:Mt(),{masto:r,instance:u}=re({instance:(i==null?void 0:i.instance)||c.instance}),{masto:l,instance:d}=re(),a=s({id:"cI3UEs",values:{instance:u}});Qe(a,"/:instance?/trending");const m=q(),b=u===d,[g,p]=M([]),[f,v]=M([]),y=q();async function w(W){var F;if(W||!y.current){if(y.current=dl(r),et("@mastodon/trending-hashtags"))try{const{value:se}=await ll(r);se!=null&&se.length&&p(se)}catch{}if(et("@mastodon/trending-links"))try{const{value:se}=await rl(r,u),$=(F=se==null?void 0:se.filter)==null?void 0:F.call(se,U=>U.type==="link");$!=null&&$.length&&v($)}catch{}}const V=await y.current.next();let{value:B}=V;return B!=null&&B.length&&(W&&(m.current=B[0].id),B.forEach(se=>{Je(se,u)})),{...V,value:B}}const[C,S]=M(!1),k=q(),[T,_]=M(null),I=!!T,R=q(),L=b&&et("@mastodon/trending-link-posts");ne(()=>{T&&R.current&&R.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},[T]);const z=q();async function P(W){(W||!k.current)&&(S(!0),k.current=ul(r,{url:T})),z.current=T;const V=await k.current.next();let{value:B}=V;return B!=null&&B.length&&(B=Nt(B,"public"),B.forEach(F=>{Je(F,u)})),z.current===T&&S(!1),{...V,value:B}}async function Z(){try{const W=await r.v1.trends.statuses.list({limit:1}).next();let{value:V}=W;return V=Nt(V,"public"),V!=null&&V.length&&V[0].id!==m.current?(m.current=V[0].id,!0):!1}catch{return!1}}const ee=_e(()=>e(O,{children:[!!g.length&&e("div",{class:"filter-bar expandable",children:[e(x,{icon:"chart",class:"insignificant",size:"l"}),g.map((W,V)=>{const{name:B,history:F}=W,se=F.reduce(($,U)=>$+ +U.uses,0);return e(be,{to:`/${u}/t/${B}`,children:[e("span",{dir:"auto",children:[e("span",{class:"more-insignificant",children:"#"}),B]}),e("span",{class:"filter-count",children:Xe(se)})]},B)})]}),!!f.length&&e("div",{class:"links-bar",children:[e("header",{children:e("h3",{children:e(h,{id:"9veeTb"})})}),f.map(W=>{var X,Ie;const{authors:V,authorName:B,authorUrl:F,blurhash:se,description:$,height:U,image:Y,imageDescription:G,language:te,providerName:ae,providerUrl:ye,publishedAt:Ce,title:j,url:he,width:Te}=W,Pe=(Ie=(X=V==null?void 0:V[0])==null?void 0:X.account)!=null&&Ie.id?V[0].account:null,De=j.length<30,Be=!!(B||Pe),Ee=zt.toUnicode(URL.parse(he).hostname.replace(/^www\./,"").replace(/\/$/,""));let Me;if(se){const Ne=ui(se),fe=Si(Ne);Me=ki([.6,fe[1],fe[2]])}return e("div",{children:[e("a",{ref:T===he?R:null,href:he,target:"_blank",rel:"noopener",class:`link-block ${I?T===he?"active":"inactive":""}`,style:Me?{"--accent-color":`rgb(${Me.join(",")})`,"--accent-alpha-color":`rgba(${Me.join(",")}, 0.4)`}:{},children:e("article",{children:[e("figure",{children:e("img",{src:Y,alt:G,width:Te,height:U,loading:"lazy"})}),e("div",{class:"article-body",children:[e("header",{children:[e("div",{class:"article-meta",children:[e("span",{class:"domain",children:Ee})," ",!!Ce&&e(O,{children:"· "}),!!Ce&&e(O,{children:e(It,{datetime:Ce,format:"micro"})})]}),!!j&&e("h1",{class:"title",lang:te,dir:"auto",title:j,children:j})]}),!!$&&e("p",{class:`description ${Be&&!De?"":"more-lines"}`,lang:te,dir:"auto",title:$,children:$}),Be&&e(O,{children:[e("hr",{}),e("p",{class:"byline",children:e("small",{children:e(h,{id:"aavdrC",values:{0:Pe?e(mt,{account:Pe,showAvatar:!0}):F?e("a",{href:F,target:"_blank",rel:"noopener",children:B}):B}})})})]})]})]})}),L&&e("button",{type:"button",class:"small plain4 block",onClick:()=>{_(he)},disabled:he===T,children:[e(x,{icon:"comment2"})," ",e("span",{children:e(h,{id:"/bZzdR"})})," ",e(x,{icon:"chevron-down"})]})]},he)})]}),L&&!!f.length&&e("div",{class:`timeline-header-block ${I?"blended":""}`,children:I?e(O,{children:[e("div",{style:{width:50,flexShrink:0,textAlign:"center"},children:C?e(Ue,{abrupt:!0}):e("button",{type:"button",class:"light",onClick:()=>{_(null)},children:e(x,{icon:"x",alt:s({id:"9Q/4xJ"})})})}),e("p",{children:e(h,{id:"BATCqf",values:{0:T.replace(/^https?:\/\/(www\.)?/i,"").replace(/\/$/,"")},components:{0:e("span",{class:"link-text"})}})})]}):e("p",{class:"insignificant",children:e(h,{id:"Vosm4k"})})})]}),[g,f,T,C]);return e(xt,{title:a,titleComponent:e("h1",{class:"header-double-lines",children:[e("b",{children:e(h,{id:"4/iCqx"})}),e("div",{children:u})]}),id:"trending",instance:u,emptyText:s({id:"6HA9+s"}),errorText:s({id:"scd9lw"}),fetchItems:I?P:w,checkForUpdates:I?void 0:Z,checkForUpdatesInterval:5*60*1e3,useItemID:!0,headerStart:e(O,{}),boostsCarousel:o.settings.boostsCarousel,filterContext:"public",timelineStart:ee,refresh:T,clearWhenRefresh:!0,view:I?"link-mentions":void 0,headerEnd:e(rt,{portal:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:s({id:"2FYpfJ"})})}),children:[e(Se,{onClick:()=>{let W=prompt(s({id:"2MQ2cd"}));if(!/\./.test(W)){W&&alert(s({id:"7WddtO"}));return}W&&(W=W.toLowerCase().trim(),location.hash=`/${W}/trending`)},children:[e(x,{icon:"bus"})," ",e("span",{children:e(h,{id:"Sq04Yc"})})]}),d!==u&&e(Se,{onClick:()=>{location.hash=`/${d}/trending`},children:[e(x,{icon:"bus"})," ",e("small",{class:"menu-double-lines",children:e(h,{id:"iAzCp4",values:{currentInstance:d},components:{0:e("b",{})}})})]})]})},u)}const ns={block:"nearest",inline:"nearest",behavior:"smooth"};function hl(){const{_:n}=de();Qe(n({id:"i0qMbr"}),"/");const i=Ve(A),{shortcuts:s}=i,o=s.map(c=>{if(!c)return null;const{type:r,...u}=c,l={following:_i,notifications:so,list:Xs,public:ni,bookmarks:Gs,favourites:Ks,hashtag:Ws,mentions:to,trending:ao,search:oo}[r];return!l||r==="search"&&!u.query||r==="list"&&!u.id?null:e(l,{...u,columnMode:!0},r+JSON.stringify(u))});return He(["1","2","3","4","5","6","7","8","9"],(c,r)=>{try{const u=parseInt(r.keys[0],10)-1,l=document.querySelectorAll("#columns > *")[u];l&&(l.focus(),l.scrollIntoView(ns))}catch{}}),He(["[","]"],(c,r)=>{const u=r.keys[0],l=document.activeElement.closest("#columns > *"),d=Dt(),a=d?"]":"[",m=d?"[":"]";let b;u===a?b=l?l.previousElementSibling:document.querySelectorAll("#columns > *")[0]:u===m&&(b=l?l.nextElementSibling:document.querySelectorAll("#columns > *")[1]),b&&(b.focus(),b.scrollIntoView(ns))}),e("div",{id:"columns",onContextMenu:c=>{c.target.closest(".deck > header")&&!c.target.closest("a")&&!c.target.closest("button")&&(c.preventDefault(),A.showShortcutsSettings=!0)},onFocus:()=>{const c=document.activeElement.closest("#columns > *");c&&document.querySelectorAll("#columns > *").forEach(r=>{r.classList.toggle("focus",r===c)})},children:o})}function fl(){var s;const{_:n}=de(),i=Ve(A);return __BENCHMARK.end("time-to-home"),ne(()=>{(async()=>{const o=await pt.drafts.keys();if(o.length){const c=_n();o.filter(u=>u.startsWith(c)).length&&(A.showDrafts=!0)}})()},[]),e(O,{children:(i.settings.shortcutsViewMode==="multi-column"||!i.settings.shortcutsViewMode&&i.settings.shortcutsColumnsMode)&&((s=i.shortcuts)!=null&&s.length)?e(hl,{}):e(_i,{title:n({id:"i0qMbr"}),path:"/",id:"home",headerStart:!1,headerEnd:e(pl,{})})})}function pl(){const{_:n}=de(),i=Ve(A),s=q(),[o,c]=M(void 0);return e(O,{children:[e(be,{ref:s,to:"/notifications",class:`button plain notifications-button ${i.notificationsShowNew?"has-badge":""} ${o||""}`,onClick:r=>{r.stopPropagation(),window.matchMedia("(min-width: calc(40em))").matches&&(r.preventDefault(),c(u=>u?void 0:"open"))},children:e(x,{icon:"notification",size:"l",alt:n({id:"iDNBZe"})})}),e(gl,{state:o,anchorRef:s,onClose:()=>c(void 0)})]})}const ml=5;function gl({anchorRef:n,state:i,onClose:s}){const{masto:o,instance:c}=re(),r=Ve(A),[u,l]=M("default"),d=ti();async function a(){const v=await d.next(),y=eo(v.value);if(y!=null&&y.length){y.forEach(C=>{Je(C.status,c,{skipThreading:!0})});const w=io(y);A.notificationsLast=w[0],A.notifications=w,o.v1.markers.create({notifications:{lastReadId:w[0].id}}).catch(()=>{})}return A.notificationsShowNew=!1,A.notificationsLastFetchTime=Date.now(),v}const[m,b]=M(!1);function g(){return o.v1.followRequests.list({limit:1})}function p(){l("loading"),(async()=>{try{await a();const v=await g();b(!!(v!=null&&v.length)),l("default")}catch{l("error")}})()}ne(()=>{i==="open"&&p()},[i]);const f=q();return e(li,{ref:f,menuClassName:"notifications-menu",state:i,anchorRef:n,onClose:s,portal:{target:document.body},containerProps:{onClick:()=>{var v,y;(y=(v=f.current)==null?void 0:v.closeMenu)==null||y.call(v)}},overflow:"auto",viewScroll:"close",position:"anchor",align:"center",boundingBoxPadding:"8 8 8 8",children:[e("header",{children:e("h2",{children:e(h,{id:"iDNBZe"})})}),e("main",{children:r.notifications.length?e(O,{children:r.notifications.slice(0,ml).map(v=>e(an,{instance:c,notification:v,disableContextMenu:!0},v._ids||v.id))}):u==="loading"?e("div",{class:"ui-state",children:e(Ue,{abrupt:!0})}):u==="error"&&e("div",{class:"ui-state",children:[e("p",{children:e(h,{id:"5GFQTh"})}),e("p",{children:e("button",{type:"button",onClick:p,children:e(h,{id:"KDw4GX"})})})]})}),e("footer",{children:[e(be,{to:"/mentions",class:"button plain",children:[e(x,{icon:"at"})," ",e("span",{children:e(h,{id:"/bZzdR"})})]}),e(be,{to:"/notifications",class:"button plain2",children:[m?e(h,{id:"OdVhdR",components:{0:e("span",{class:"tag collapsed"}),1:e("span",{})}}):e("b",{children:e(h,{id:"gukqfD"})})," ",e(x,{icon:"arrow-right"})]})]})]})}const bl=lt(fl),vl=[/^\/@[^@\/]+\/(?:statuses|posts)\/([^\/]+)/i,/\/notes\/([^\/]+)/i,/^\/(?:notice|objects)\/([a-z0-9-]+)/i,/\/@[^@\/]+\/post\/([^\/]+)/i,/\/@[^@\/]+@?[^\/]+?\/([^\/]+)/i,/^\/p\/[^\/]+\/([^\/]+)/i];function ro(n){const{hostname:i,pathname:s}=URL.parse(n);for(const o of vl){const[,c]=s.match(o)||[];if(c)return{instance:i,id:c}}return{}}function yl(n){const{instance:i,id:s}=ro(n);return i&&s?`/${i}/s/${s}`:null}function wl(){const i=Wt().pathname.replace(/^\//,""),s=ro(i),o=s!=null&&s.instance?`/${s.instance}/s/${s.id}`:null,[c,r]=M("loading");return wt(()=>{r("loading"),(async()=>{try{const{instance:u,id:l}=s;if(l){const{masto:d}=re({instance:u});if(await d.v1.statuses.$select(l).fetch()){window.location.hash=o+"?view=full";return}}}catch{}{const{masto:u,instance:l}=re(),d=await u.v2.search.fetch({q:i,limit:1,resolve:!0});if(d.statuses.length){const a=d.statuses[0];window.location.hash=`/${l}/s/${a.id}?view=full`}else if(d.accounts.length){const a=d.accounts[0];window.location.hash=`/${l}/a/${a.id}`}else o?window.location.hash=o+"?view=full":r("error")}})()},[o]),e("div",{class:"ui-state",tabIndex:"-1",children:[c==="loading"?e(O,{children:[e(Ue,{abrupt:!0}),e("h2",{children:e(h,{id:"RTAr/z"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}):e(O,{children:[e("h2",{children:e(h,{id:"ufzZSJ"})}),e("p",{children:e("a",{href:i,target:"_blank",rel:"noopener",children:i})})]}),e("hr",{}),e("p",{children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})})]})}function kl(){const{_:n}=de();Qe(n({id:"h16FyT"}),"/l");const[i,s]=M("default"),[o,c]=Et(a=>a+1,0),[r,u]=M([]);ne(()=>{s("loading"),(async()=>{try{const a=await Qn();u(a),s("default")}catch{s("error")}})()},[o]);const[l,d]=M(!1);return e("div",{id:"lists-page",class:"deck-container",tabIndex:"-1",children:[e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l"})})]}),e("h1",{children:e(h,{id:"h16FyT"})}),e("div",{class:"header-side",children:e("button",{type:"button",class:"plain",onClick:()=>d(!0),children:e(x,{icon:"plus",size:"l",alt:n({id:"Sb2gYF"})})})})]})}),e("main",{children:r.length>0?e(O,{children:[e("ul",{class:"link-list",children:r.map(a=>e("li",{children:e(be,{to:`/l/${a.id}`,children:e("span",{children:[e(x,{icon:"list"})," ",e("span",{children:a.title})]})})}))}),r.length>1&&e("footer",{class:"ui-state",children:e("small",{class:"insignificant",children:e(h,{id:"8prZNK",values:{0:r.length}})})})]}):i==="loading"?e("p",{class:"ui-state",children:e(Ue,{})}):i==="error"?e("p",{class:"ui-state",children:e(h,{id:"v/l5uA"})}):e("p",{class:"ui-state",children:e(h,{id:"IvPikw"})})})]}),l&&e(qe,{onClick:a=>{a.target===a.currentTarget&&d(!1)},children:e(wi,{list:l==null?void 0:l.list,onClose:a=>{a.state==="success"&&c(),d(!1)}})})]})}const Sl=""+new URL("instances-LA7224ZB.json",import.meta.url).href;function Cl(n){return("0"+n.toString(16)).slice(-2)}function _l(){var n=new Uint32Array(28);return window.crypto.getRandomValues(n),Array.from(n,Cl).join("")}function Il(n){const s=new TextEncoder().encode(n);return window.crypto.subtle.digest("SHA-256",s)}function xl(n){let i="";const s=new Uint8Array(n),o=s.byteLength;for(var c=0;c<o;c++)i+=String.fromCharCode(s[c]);return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lo(n){const i=await Il(n);return xl(i)}async function Tl({instanceURL:n}){var i;if(!n)return!1;try{const s=await fetch(`https://${n}/.well-known/oauth-authorization-server`);return!s.ok||s.status!==200?!1:!!((i=(await s.json()).code_challenge_methods_supported)!=null&&i.includes("S256"))}catch{return!1}}window.__generateCodeChallenge=lo;const Al={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{DEV:Rl,PHANPY_CLIENT_NAME:El,PHANPY_WEBSITE:En}=Al,Dn="read write follow push",Ml=En?En.toLowerCase().includes(location.hostname):!1,Ll=location.origin+location.pathname,Nn=Rl||!Ml?Ll:En;async function $l({instanceURL:n}){const i=new URLSearchParams({client_name:El,redirect_uris:Nn,scopes:Dn,website:En});return await(await fetch(`https://${n}/api/v1/apps`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()})).json()}async function Pl({instanceURL:n,client_id:i}){const s=_l(),o=await lo(s),c=new URLSearchParams({client_id:i,code_challenge_method:"S256",code_challenge:o,redirect_uri:Nn,response_type:"code",scope:Dn});return[`https://${n}/oauth/authorize?${c.toString()}`,s]}async function Dl({instanceURL:n,client_id:i}){const s=new URLSearchParams({client_id:i,scope:Dn,redirect_uri:Nn,response_type:"code"});return`https://${n}/oauth/authorize?${s.toString()}`}async function Nl({instanceURL:n,client_id:i,client_secret:s,code:o,code_verifier:c}){const r=new URLSearchParams({client_id:i,redirect_uri:Nn,grant_type:"authorization_code",code:o,scope:Dn});return s&&r.append("client_secret",s),c&&r.append("code_verifier",c),await(await fetch(`https://${n}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()})).json()}const Ol={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:zl}=Ol;function Bl(){var S,k;const{_:n}=de();Qe(n({id:"sQia9P"}),"/login");const i=q(),s=ke.local.get("instanceURL"),[o,c]=M("default"),[r]=bt(),u=r.get("instance"),l=r.get("submit"),[d,a]=M(u||(s==null?void 0:s.toLowerCase())||""),[m,b]=M([]),g=q();ne(()=>{(async()=>{try{const _=await(await fetch(Sl)).json();b(_),g.current=new Go(_)}catch{}})()},[]);const p=T=>{T&&(async()=>{try{const I=await(await fetch(`https://${T}/.well-known/host-meta`)).text(),P=new DOMParser().parseFromString(I,"text/xml").getElementsByTagName("Link")[0].getAttribute("template"),Z=URL.parse(P),{host:ee}=Z;T!==ee&&(T=ee)}catch{}ke.local.set("instanceURL",T),c("loading");try{const{client_id:_,client_secret:I,vapid_key:R}=await $l({instanceURL:T});if(await Tl({instanceURL:T}))if(_&&I){ke.sessionCookie.set("clientID",_),ke.sessionCookie.set("clientSecret",I),ke.sessionCookie.set("vapidKey",R);const[z,P]=await Pl({instanceURL:T,client_id:_});ke.sessionCookie.set("codeVerifier",P),location.href=z}else alert(n({id:"ZP1FIA"}));else _&&I?(ke.sessionCookie.set("clientID",_),ke.sessionCookie.set("clientSecret",I),ke.sessionCookie.set("vapidKey",R),location.href=await Dl({instanceURL:T,client_id:_})):alert(n({id:"ZP1FIA"}));c("default")}catch{c("error")}})()},f=d?d.replace(/^https?:\/\//,"").replace(/\/+$/,"").replace(/^@?[^@]+@/,"").trim():null,v=/[^\s\r\n\t\/\\]+\.[^\s\r\n\t\/\\]+/.test(f)&&!/[\s\/\\@]/.test(f),y=f?(k=(S=g.current)==null?void 0:S.search(f,{limit:10}))==null?void 0:k.map(T=>T.item):[],w=v?f:y!=null&&y.length?y[0]:d?m.find(T=>T.includes(d)):null,C=T=>{T.preventDefault(),p(w)};return l&&ne(()=>{p(u||w)},[]),e("main",{id:"login",style:{textAlign:"center"},children:e("form",{onSubmit:C,children:[e("h1",{children:[e("img",{src:bi,alt:"",width:"80",height:"80"}),e("br",{}),e(h,{id:"sQia9P"})]}),e("label",{children:[e("p",{children:e(h,{id:"kyAi7k"})}),e("input",{value:d,required:!0,type:"text",class:"large",id:"instanceURL",ref:i,disabled:o==="loading",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellCheck:!1,placeholder:n({id:"u3gOdY"}),onInput:T=>{a(T.target.value)},dir:"auto"}),(y==null?void 0:y.length)>0?e("ul",{id:"instances-suggestions",children:y.map((T,_)=>e("li",{children:e("button",{type:"button",class:"plain5",onClick:()=>{p(T)},children:T})}))}):e("div",{id:"instances-eg",children:e(h,{id:"/OvbEC"})})]}),o==="error"&&e("p",{class:"error",children:e(h,{id:"rmBHZn"})}),e("div",{children:[e("button",{disabled:o==="loading"||!d||!w,children:n(w?{id:"2xahsi",values:{selectedInstanceText:w}}:{id:"xGVfLh"})})," "]}),e(Ue,{hidden:o!=="loading"}),e("hr",{}),!zl&&e("p",{children:e("a",{href:"https://joinmastodon.org/servers",target:"_blank",children:e(h,{id:"LcOiWS"})})}),e("p",{children:e(be,{to:"/",children:e(h,{id:"iWpEwy"})})}),e(vi,{})]})})}const Ul=40;function Fl(){const{_:n}=de(),i=Ve(A);Qe(n({id:"+GkIdc"}),"/sp");const{masto:s}=re(),[o,c]=M([]),[r,u]=M("default"),[l,d]=Et(b=>b+1,0),[a,m]=M(!1);return ne(d,[i.reloadScheduledPosts]),ne(()=>{u("loading"),(async()=>{try{const b=s.v1.scheduledStatuses.list({limit:Ul}),g=[];let p;do p=(await b.next()).value,p!=null&&p.length&&g.push(...p);while(p!=null&&p.length);c(g)}catch{u("error")}finally{u("default")}})()},[l]),e("div",{id:"scheduled-posts-page",class:"deck-container",tabIndex:"-1",children:e("div",{class:"timeline-deck deck",children:[e("header",{children:e("div",{class:"header-grid",children:[e("div",{class:"header-side",children:[e(Lt,{}),e(be,{to:"/",class:"button plain",children:e(x,{icon:"home",size:"l",alt:n({id:"i0qMbr"})})})]}),e("h1",{children:e(h,{id:"+GkIdc"})}),e("div",{class:"header-side",children:e(rt,{portal:!0,setDownOverflow:!0,overflow:"auto",viewScroll:"close",position:"anchor",menuButton:e("button",{type:"button",class:"plain",children:e(x,{icon:"more",size:"l",alt:n({id:"2FYpfJ"})})}),children:e(Se,{onClick:()=>{d()},children:[e(x,{icon:"refresh",size:"l"}),e("span",{children:e(h,{id:"lCF0wC"})})]})})})]})}),e("main",{children:[o.length?e("ul",{class:"posts-list",children:o.map(b=>{const{id:g,params:p,scheduledAt:f,mediaAttachments:v}=b,{inReplyToId:y,language:w,poll:C,sensitive:S,spoilerText:k,text:T,visibility:_}=p,I={id:g,inReplyToId:y,language:w,mediaAttachments:v,poll:C?{...C,expiresAt:new Date(Date.now()+C.expiresIn*1e3),options:C.options.map(R=>({title:R,votesCount:0}))}:void 0,sensitive:S,spoilerText:k,text:T,visibility:_,content:`<p>${T}</p>`};return e("li",{children:e(Hl,{status:I,scheduledAt:f,onClick:()=>{m({post:I,scheduledAt:new Date(f)})}})},g)})}):e("p",{class:"ui-state",children:r==="loading"?e(Ue,{}):n({id:"mZYb1f"})}),a&&e(qe,{onClick:b=>{b.target===b.currentTarget&&m(!1)},children:e(ql,{post:a.post,scheduledAt:a.scheduledAt,onClose:()=>m(!1)})})]})]})})}function Hl({status:n,scheduledAt:i,onClick:s}){const o=_e(()=>{const c=(new Date(i).getTime()-Date.now())/36e5;return c<24?"time":c<720?"day":"month"},[i]);return e("button",{type:"button",class:"textual block",onClick:s,children:[e("div",{class:`post-schedule-meta post-schedule-${o}`,children:[e(x,{icon:o,class:"insignificant"})," ",e("span",{children:e(h,{id:"aEp6lO",values:{0:ot(i,{formatOpts:{weekday:"short",second:"numeric"}})},components:{0:e("b",{}),1:e(It,{datetime:i}),2:e("small",{})}})})]}),e(je,{status:n,size:"s",previewMode:!0,readOnly:!0})]})}function ql({post:n,scheduledAt:i,onClose:s}){const{masto:o}=re(),{_:c}=de(),[r,u]=M("default"),[l,d]=M(),a=l&&l.getTime()!==i.getTime(),m=Ko(),b=i&&i<=Date.now(),{inReplyToId:g}=n,[p,f]=M(null);return e("div",{id:"scheduled-post-sheet",class:"sheet",children:[e("button",{type:"button",class:"sheet-close",onClick:s,children:e(x,{icon:"x",size:"l",alt:c({id:"yz7wBu"})})}),e("header",{children:e("h2",{children:[e(h,{id:"orjBLU",components:{0:e("b",{}),1:e(It,{datetime:i})}}),e("br",{}),e("small",{children:ot(i,{formatOpts:{weekday:"short",second:"numeric"}})})]})}),e("main",{tabIndex:"-1",children:[!!p&&e("div",{class:"status-reply",children:e(je,{status:p,size:"s",previewMode:!0,readOnly:!0})}),e(je,{status:n,size:"s",previewMode:!0,readOnly:!0,onMediaClick:(v,y,w,C)=>{v.preventDefault(),A.showMediaModal={mediaAttachments:n.mediaAttachments,mediaIndex:y}}}),e("form",{onSubmit:v=>{v.preventDefault(),u("loading"),(async()=>{try{await o.v1.scheduledStatuses.$select(n.id).update({scheduledAt:l.toISOString()}),me(c({id:"40naR1"})),s(),u("default"),A.reloadScheduledPosts++}catch{u("error"),me(c({id:"ZM3jAs"}))}})()},children:e("footer",{children:[e("div",{class:"row",children:e("span",{children:[e(Zo,{scheduledAt:i,setScheduledAt:v=>{d(v)}})," ",e("small",{class:"ib",children:m})]})}),e("div",{class:"row",children:[e("button",{disabled:!a||r==="loading"||b,children:e(h,{id:"QqW27M"})}),e("span",{class:"grow"}),e(ut,{align:"end",menuItemClassName:"danger",confirmLabel:c({id:"09u3Kk"}),onClick:()=>{u("loading"),(async()=>{try{await re().masto.v1.scheduledStatuses.$select(n.id).remove(),me(c({id:"/zL/Mq"})),s(),u("default"),A.reloadScheduledPosts++}catch{u("error"),me(c({id:"aOh6Md"}))}})()},children:e("button",{type:"button",class:"light danger",disabled:r==="loading"||b,children:e(h,{id:"Jb6/SB"})})})]})]})})]})]})}const Yl={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:is}=Yl,mn=40,jl=10,Vl=5;let ii={},wn={},kn={};function Sn(n){delete wn[n],delete kn[n]}const Qt={block:"nearest",inline:"center",behavior:"smooth"},ss=".status-link:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *), .status-focus:not(details:not([open]) > summary ~ *, details:not([open]) > summary ~ * *)",os=/\/s\//i;function Gl(n){var T;const{_:i}=de(),{id:s}=n,{masto:o,instance:c}=re({instance:n.instance}),r=Ve(A),[u,l]=bt(),d=u.get("media"),a=u.get("media-only"),m=parseInt(d||a,10);let b=m>0;const g=u.get("mediaStatusID"),p=gs(g,c);g&&!p&&(b=!1);const f=b&&!!a,v=at(s,c),[y,w]=M(A.statuses[v]);ne(()=>{A.statuses[v]&&w(A.statuses[v])},[v]);const C=_e(()=>{const{prevLocation:_}=A,I=((_==null?void 0:_.pathname)||"")+((_==null?void 0:_.search)||""),R=sn("/:instance/s/:id",I)||sn("/s/:id",I);return!I||R?"/":I},[]);ne(()=>{!y&&b&&(async()=>{try{const _=await o.v1.statuses.$select(s).fetch();Je(_,c),w(_)}catch{alert("Unable to load post."),location.hash=C}})()},[b]);const S=g?(T=r.statuses[at(g,c)])==null?void 0:T.mediaAttachments:y==null?void 0:y.mediaAttachments,k=st(()=>{!window.matchMedia("(min-width: calc(40em + 350px))").matches&&r.prevLocation?history.back():f?location.hash=C:(u.delete("media"),u.delete("mediaStatusID"),l(u))},[f,C,r.prevLocation]);return ne(()=>{let _=setTimeout(()=>{const I=document.querySelector(".carousel");I&&I.focus()},100);return()=>clearTimeout(_)},[f]),ne(()=>{const _=document.querySelectorAll(".deck-container");return _.forEach(I=>{I.setAttribute("inert","")}),()=>{_.forEach(I=>{I.removeAttribute("inert")})}},[]),e("div",{class:"deck-backdrop",children:[b?S!=null&&S.length?e(qs,{mediaAttachments:S,statusID:g||s,instance:c,lang:y==null?void 0:y.language,index:m-1,onClose:k}):e("div",{class:"media-modal-container loading",children:e(Ue,{abrupt:!0})}):e(be,{to:C}),!f&&e(Zl,{id:s,instance:n.instance,closeLink:C})]})}function Kl(n){const{linkable:i,to:s,onClick:o,...c}=n;return i?e(be,{class:"status-link",to:s,onClick:o,...c}):e("div",{class:"status-focus",tabIndex:0,...c})}function cs(n,i){return new Date(i.created_at)-new Date(n.created_at)}function Zl({id:n,closeLink:i="/",instance:s}){var Q,ge;const{_:o}=de(),[c,r]=bt(),u=c.get("media"),l=c.get("mediaStatusID"),d=parseInt(u,10)>0,a=q(!A.prevLocation&&(history.length===1||"navigation"in window&&((ge=(Q=navigation==null?void 0:navigation.entries)==null?void 0:Q.call(navigation))==null?void 0:ge.length)===1)),[m,b]=M(c.get("view")||a.current?"full":null),g=!!parseInt(c.get("translate")),{masto:p,instance:f}=re({instance:s}),{masto:v,instance:y,authenticated:w}=re(),C=f===y,S=Ve(A),[k,T]=M([]),[_,I]=M("default"),R=q(),L=at(n,f),z=q(0),P=q();ne(()=>{var N;(N=P.current)==null||N.focus()},[]),ne(()=>{var ie;const N=As(()=>{if(!P.current)return;const{scrollTop:ue}=P.current;_!=="loading"&&(kn[n]=ue)},50);return(ie=P.current)==null||ie.addEventListener("scroll",N,{passive:!0}),N(),()=>{var ue;N.cancel(),(ue=P.current)==null||ue.removeEventListener("scroll",N)}},[n,_!=="loading"]);const Z=q(),ee=q(),W=({reloadHero:N}={})=>{I("loading");let ie;const ue=wn[n];if(ue){const D=ue.filter(le=>A.statuses[L]);T(D)}else T([{id:n}]);return(async()=>{var ve,Re;const D=()=>Mi(()=>p.v1.statuses.$select(n).fetch(),{retries:4}),le=Mi(()=>p.v1.statuses.$select(n).context.fetch(),{retries:8}),xe=!!S.statuses[L];let H=S.statuses[L];if(!(xe&&!N))try{H=await D(),Je(H,f),await new Promise(E=>{setTimeout(E,100)})}catch{I("error");return}try{let E=function(we,ze){const tt=ze+1;return tt>$e&&($e=ze),we==null?void 0:we.map(Ae=>({id:Ae.id,account:Ae.account,repliesCount:Ae.repliesCount,content:Ae.content,weight:nn(Ae),level:tt,replies:E(Ae.__replies,tt)}))};const K=await le,{ancestors:ce,descendants:J}=K;ce.sort(cs),J.sort(cs),z.current=(J==null?void 0:J.length)||0;const oe=new Set;ce.forEach(we=>{Je(we,f,{skipThreading:!0}),we.inReplyToId&&!ce.find(ze=>ze.id===we.inReplyToId)&&oe.add(we.inReplyToId)});const Oe=ce.every(we=>we.account.id===H.account.id),Le=[];J.forEach(we=>{if(Je(we,f,{skipThreading:!0}),we.inReplyToId&&!J.find(ze=>ze.id===we.inReplyToId)&&we.inReplyToId!==H.id&&oe.add(we.inReplyToId),we.inReplyToAccountId===we.account.id)Le.push(we);else if(we.inReplyToId===H.id)Le.push(we);else if(!we.inReplyToAccountId&&Le.find(ze=>ze.id===we.inReplyToId&&ze.account.id===H.account.id)&&we.account.id===H.account.id)Le.push(we);else{const ze=J.find(tt=>tt.id===we.inReplyToId);ze&&(ze.__replies||(ze.__replies=[]),ze.__replies.push(we))}}),Le.sort((we,ze)=>{const tt=H.account.id;return we.account.id===tt&&ze.account.id!==tt?-1:ze.account.id===tt&&we.account.id!==tt?1:0}),oe.size;let $e=1;const Fe=[...ce.map(we=>({id:we.id,ancestor:!0,isThread:Oe,accountID:we.account.id,account:we.account,repliesCount:we.repliesCount,weight:nn(we)})),{id:n,accountID:H.account.id,weight:nn(H)},...Le.map(we=>({id:we.id,account:we.account,accountID:we.account.id,descendant:!0,thread:we.account.id===H.account.id,weight:nn(we),level:1,replies:E(we.__replies,1)}))];I("default"),Z.current={offsetTop:(ve=R.current)==null?void 0:ve.offsetTop,scrollTop:(Re=P.current)==null?void 0:Re.scrollTop};const Ge=ce.length||0;Ge>=G&&te(Ge+1),T(Fe),wn[n]=Fe,xo(H,f)}catch{I("error")}})(),ee.current=Date.now(),()=>{clearTimeout(ie)}};ne(W,[n,p]);const[V,B]=M(!1);ne(()=>{let N=setInterval(()=>{const ie=Date.now();ee.current&&ie-ee.current>=6e4&&B(!0)},6e4);return()=>{clearInterval(N)}},[]),wt(()=>{var ie,ue;if(!k.length)return;const N=kn[n];if(N)P.current.scrollTop=N;else if(Z.current){const D={offsetTop:(ie=R.current)==null?void 0:ie.offsetTop,scrollTop:(ue=P.current)==null?void 0:ue.scrollTop},le=D.offsetTop-Z.current.offsetTop+D.scrollTop;P.current.scrollTop=le}else k.length===1&&(P.current.scrollTop=0);Z.current=null},[k]),ne(()=>{S.reloadStatusPage<=0||(async()=>{try{const{instanceURL:N}=oi(),ie=`https://${N}/api/v1/statuses/${n}/context`;return await(await caches.open("api")).delete(ie,{ignoreVary:!0}),W({reloadHero:!0})}catch{}})()},[S.reloadStatusPage]),ne(()=>()=>{kn={},A.reloadStatusPage=0,wn={},ii={},si.clear()},[]);const F=S.statuses[L]||S.statuses[n],se=_e(()=>{if(!F)return"";const{account:N}=F,ie=document.createElement("div");return ie.innerHTML=N.displayName,ie.innerText.trim()},[F]),$=_e(()=>{if(!F)return"";let N=Mn(F);return N.length>64&&(N=N.slice(0,64)+"…"),N},[F]);Qe(se&&$?`${se}: "${$}"`:o({id:"post.title"}),"/:instance?/s/:id");const U=_e(()=>{if(!F)return;const{url:N}=F;if(N)return URL.parse(N).hostname},[F]),Y=_e(()=>{if(U)return U===f},[U,f]),[G,te]=M(mn),ae=_e(()=>k.length-G,[k.length,G]),ye=k.some(N=>N.descendant),Ce=k.filter(N=>N.ancestor),[j,he]=M(!0),Te=_e(()=>{if(!R.current||j)return null;const{top:N}=R.current.getBoundingClientRect();return N>0?"down":"up"},[j]);He("esc",()=>{location.hash=i},{enabled:!d,ignoreEventWhen:N=>!!document.querySelector("#modal-container > *")}),He("backspace",()=>{location.hash=i}),He("j",()=>{const N=document.activeElement.closest(".status-link, .status-focus"),ie=N==null?void 0:N.getBoundingClientRect(),ue=Array.from(P.current.querySelectorAll(ss));if(N&&ie.top<P.current.clientHeight&&ie.bottom>0){const D=ue.indexOf(N);let le=ue[D+1];le&&(le.focus(),le.scrollIntoView(Qt))}else{const D=ue.find(le=>{const xe=le.getBoundingClientRect();return xe.top>=44&&xe.left>=0});D&&(D.focus(),D.scrollIntoView(Qt))}}),He("k",()=>{const N=document.activeElement.closest(".status-link, .status-focus"),ie=N==null?void 0:N.getBoundingClientRect(),ue=Array.from(P.current.querySelectorAll(ss));if(N&&ie.top<P.current.clientHeight&&ie.bottom>0){const D=ue.indexOf(N);let le=ue[D-1];le&&(le.focus(),le.scrollIntoView(Qt))}else{const D=ue.find(le=>{const xe=le.getBoundingClientRect();return xe.top>=44&&xe.left>=0});D&&(D.focus(),D.scrollIntoView(Qt))}}),He("x",()=>{const N=document.activeElement.closest(".status-link, .status-focus");if(N){const ie=N.nextElementSibling;ie&&ie.tagName.toLowerCase()==="details"&&(ie.open=!ie.open)}});const[Pe,De]=M(!1),Be=q(d?"media+status":"status"),Ee=st((N,ie,ue,D)=>{N.preventDefault(),N.stopPropagation(),r({media:ie+1,mediaStatusID:D.id})},[n]),Me=st((N,ie)=>{Sn(ie.id)},[]);ne(()=>{let N;return l&&d&&(N=setTimeout(()=>{var ue;const ie=(ue=P.current)==null?void 0:ue.querySelector(`.status-link[href*="/${l}"]`);ie&&ie.scrollIntoView(Qt)},400)),()=>{clearTimeout(N)}},[l,d]);const X=st((N,ie)=>{const{id:ue,ancestor:D,isThread:le,descendant:xe,thread:H,replies:ve,repliesCount:Re,weight:E,level:K}=N,ce=ue===n;return e("li",{ref:ce?R:null,class:`${D?"ancestor":""} ${xe?"descendant":""} ${H?"thread":""} ${ce?"hero":""}`,children:[ce?e(O,{children:[e(_t,{threshold:.1,onChange:oe=>{queueMicrotask(()=>{requestAnimationFrame(()=>{he(oe)})})},class:"status-focus",tabIndex:0,children:e(je,{statusID:ue,instance:f,withinContext:!0,size:"l",enableTranslate:!0,forceTranslate:g})}),_!=="loading"&&!w?e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"Vyeh4F"})}),e(be,{to:is?`/login?instance=${is}&submit=1`:"/login",class:"button",children:e(h,{id:"sQia9P"})})]}):!C&&e("div",{class:"post-status-banner",children:[e("p",{children:e(h,{id:"j5roNG",values:{instance:f},components:{0:e("b",{})}})}),e("button",{type:"button",disabled:_==="loading",onClick:()=>{I("loading"),(async()=>{try{const oe=await v.v2.search.fetch({q:F.url,type:"statuses",resolve:!0,limit:1});if(oe.statuses.length){const Oe=oe.statuses[0];location.hash=y?`/${y}/s/${Oe.id}`:`/s/${Oe.id}`}else throw new Error("No results")}catch(oe){I("default"),alert(o({id:"DnepCE",values:{e:oe}}))}})()},children:[e(x,{icon:"transfer"})," ",e(h,{id:"ejAVrO"})]})]})]}):e(Kl,{linkable:le||D,to:f?`/${f}/s/${ue}`:`/s/${ue}`,onClick:()=>{Sn(ue)},children:[ie===0&&D?e(_t,{threshold:.5,onChange:oe=>{queueMicrotask(()=>{requestAnimationFrame(()=>{De(oe)})})},children:e(je,{statusID:ue,instance:f,withinContext:!0,size:H||D?"m":"s",enableTranslate:!0,onMediaClick:Ee,onStatusLinkClick:Me})}):e(je,{statusID:ue,instance:f,withinContext:!0,size:H||D?"m":"s",enableTranslate:!0,onMediaClick:Ee,onStatusLinkClick:Me,showActionsBar:!!xe}),D&&Re>1&&e("div",{class:"replies-link",children:[e(x,{icon:"comment2",alt:o({id:"N8UzTV"})})," ",e("span",{title:Re,children:Xe(Re)})]})," "]}),xe&&(ve==null?void 0:ve.length)>0&&e(uo,{instance:f,replies:ve,hasParentThread:H,level:K,accWeight:E,openAll:z.current<jl,parentLink:{to:f?`/${f}/s/${ue}`:`/s/${ue}`,onClick:()=>Sn(ue)}}),_==="loading"&&ce&&!!(F!=null&&F.repliesCount)&&!ye&&e("div",{class:"status-loading",children:e(Ue,{abrupt:F.repliesCount>=3})}),_==="error"&&ce&&!!(F!=null&&F.repliesCount)&&!ye&&e("div",{class:"status-error",children:[e(h,{id:"HQJU6W"}),e("br",{}),e("button",{type:"button",class:"plain",onClick:()=>{A.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]},ue)},[n,f,_,w,C,g,Ee,Me,ye]),Ie=_e(()=>{var N;if("navigation"in window&&(navigation!=null&&navigation.entries)){const ie=navigation.entries()[navigation.currentEntry.index-1];if(ie!=null&&ie.url)return os.test(ie.url)}return os.test((N=A.prevLocation)==null?void 0:N.pathname)},[L]),Ne=_e(()=>{if(!ae)return[];const N=[];function ie(ue){N.push(ue.id),ue.replies&&ue.replies.forEach(ie)}return k.slice(G).forEach(ie),N.map(ue=>at(ue,f))},[ae,k,G,f]),fe=_e(()=>k.slice(0,G).map(X),[k,G,X]);return ne(()=>{let N=setTimeout(()=>{if(!R.current)return;const ie=R.current.querySelector(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)");ie&&ie.click()},1e3);return()=>clearTimeout(N)},[n]),e("div",{tabIndex:"-1",ref:P,class:`status-deck deck contained ${k.length>1?"padded-bottom":""} ${Be.current==="status"&&!a.current?"slide-in":""} ${m?`deck-view-${m}`:""}`,onAnimationEnd:N=>{Be.current==="status"&&(Be.current=null)},children:[e("header",{class:`${_==="loading"?"loading":""}`,onDblClick:N=>{A.reloadStatusPage++},children:e("div",{class:"header-grid header-grid-2",children:[e("h1",{children:[Ie&&e("button",{type:"button",class:"plain deck-back",onClick:()=>{history.back()},children:e(x,{icon:"chevron-left",size:"xl",alt:o({id:"iH8pgl"})})}),!j&&F&&_!=="loading"?e(O,{children:[e("span",{class:"hero-heading",children:[e(mt,{account:F.account,instance:f,showAvatar:!0,short:!0})," ",e("span",{class:"insignificant",children:["•"," ",e(It,{datetime:F.createdAt,format:"micro"})]})]})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:N=>{N.preventDefault(),N.stopPropagation(),R.current.scrollIntoView({behavior:"smooth",block:"start"})},title:o({id:"NCy+Nw"}),children:e(x,{icon:Te==="down"?"arrow-down":"arrow-up"})})]}):e(O,{children:[e(h,{id:"post.title"})," ",e("button",{type:"button",class:"ancestors-indicator light small",onClick:N=>{N.preventDefault(),N.stopPropagation(),P.current.scrollTo({top:0,behavior:"smooth"})},hidden:!Ce.length||Pe,title:o({id:"R8CUl0",values:{0:Ce.length}}),children:[e(x,{icon:"arrow-up"}),Ce.filter((N,ie,ue)=>ue.findIndex(D=>D.accountID===N.accountID)===ie).slice(0,3).map(N=>e(ft,{url:N.account.avatar,alt:N.account.displayName},N.account.id)),Ce.length>3&&e(O,{children:[" ",e("span",{class:"insignificant",children:Xe(Ce.length)})]})]})]})]}),e("div",{class:"header-side",children:[e("button",{type:"button",class:"plain4 button-switch-view",style:{display:m==="full"?"":"none"},onClick:()=>{b(null),c.delete("media"),c.delete("media-only"),c.delete("view"),r(c)},title:o({id:"+/xYEI"}),children:e(x,{icon:"layout4",size:"l"})}),V&&e("button",{type:"button",class:"plain button-refresh",onClick:()=>{A.reloadStatusPage++,B(!1)},children:e(x,{icon:"refresh",size:"l",alt:o({id:"lCF0wC"})})}),e(rt,{align:"end",portal:{target:P.current},menuButton:e("button",{type:"button",class:"button plain4",children:e(x,{icon:"more",alt:o({id:"2FYpfJ"}),size:"xl"})}),children:[e(Se,{disabled:_==="loading",onClick:()=>{A.reloadStatusPage++},children:[e(x,{icon:"refresh"}),e("span",{children:e(h,{id:"lCF0wC"})})]}),e(Se,{className:"menu-switch-view",onClick:()=>{b(m==="full"?null:"full"),c.delete("media"),c.delete("media-only"),m==="full"?c.delete("view"):c.set("view","full"),r(c)},children:[e(x,{icon:{"":"layout5",full:"layout4"}[m||""]}),e("span",{children:o(m==="full"?{id:"+/xYEI"}:{id:"2LiWsE"})})]}),e(Se,{onClick:()=>{Array.from(P.current.querySelectorAll(".spoiler-button:not(.spoiling), .spoiler-media-button:not(.spoiling)")).forEach(ie=>{ie.click()})},children:[e(x,{icon:"eye-open"})," ",e("span",{children:e(h,{id:"8r8KmB"})})]}),e(Ze,{}),e(Ts,{className:"plain",children:e(h,{id:"Rsjgm0"})}),e(Se,{disabled:!U||Y,onClick:()=>{const N=yl(F.url);N?location.hash=N:alert(o({id:"9J6biQ"}))},children:[e(x,{icon:"transfer"}),e("small",{class:"menu-double-lines",children:o(U?{id:"tElD3e",values:{1:zt.toUnicode(U)}}:{id:"lb07+k"})})]})]}),e(be,{class:"button plain deck-close",to:i,children:e(x,{icon:"x",size:"xl",alt:o({id:"yz7wBu"})})})]})]})}),k.length&&F?e("ul",{class:`timeline flat contextual grow ${_==="loading"?"loading":""}`,children:[fe,ae>0&&e("li",{class:"descendant descendant-more",children:e("button",{type:"button",class:"plain block show-more",disabled:_==="loading",onClick:()=>te(N=>N+mn),style:{marginBlockEnd:"6em"},"data-state-post-ids":Ne.join(" "),children:[e("div",{class:"ib avatars-bunch",children:k.slice(G,G+5).map(N=>e(ft,{url:N.account.avatarStatic},N.id))})," ",e("div",{class:"ib",children:[e(h,{id:"uXRAkV"})," ",e("span",{class:"tag",children:ae>mn?`${mn}+`:ae})]})]})})]}):e(O,{children:[_==="loading"&&e("ul",{class:"timeline flat contextual grow loading",children:e("li",{children:e(je,{skeleton:!0,size:"l"})})}),_==="error"&&e("p",{class:"ui-state",children:[e(h,{id:"JWxodU"}),e("br",{}),e("br",{}),e("button",{type:"button",onClick:()=>{A.reloadStatusPage++},children:e(h,{id:"KDw4GX"})})]})]})]})}function uo({replies:n,instance:i,hasParentThread:s,level:o,accWeight:c,openAll:r,parentLink:u}){const{_:l}=de(),[d,a]=bt(),m=I=>I.reduce((R,L)=>{const{repliesCount:z,replies:P}=L,Z=(P==null?void 0:P.length)||z;return R+Z+m(P||[])},0),b=n.length+m(n),g=n.length===b,p=n.map(I=>I.account).filter((I,R,L)=>L.findIndex(z=>z.id===I.id)===R).slice(0,3),f=_e(()=>n==null?void 0:n.reduce((I,R)=>I+(R==null?void 0:R.weight),c),[c,n==null?void 0:n.length]);let v=!1;(r||f<=Vl||!s&&b===1&&nn(n[0])<2)&&(v=!0);const y=ii[n[0].id],w=st((I,R,L,z)=>{I.preventDefault(),I.stopPropagation(),a({media:R+1,mediaStatusID:z.id})},[]),C=q();wt(()=>{var R;function I(L){L.target.dataset.scrollLeft=L.target.scrollLeft}return(R=C.current)==null||R.addEventListener("scroll",I,{passive:!0}),()=>{var L;(L=C.current)==null||L.removeEventListener("scroll",I)}},[]);const[S,k]=M(y||v);ne(()=>{let I;return!y&&!v&&(I=setTimeout(()=>k(!0),100)),()=>clearTimeout(I)},[y,v]);const T=v?"div":"details",_=T==="details";return e(T,{ref:C,class:"replies",open:_?y||v:void 0,onToggle:_?I=>{const{open:R}=I.target;ii[n[0].id]=R}:void 0,style:{"--comments-level":o},"data-comments-level":o,"data-comments-level-overflow":o>4,children:[!v&&e("summary",{class:"replies-summary",hidden:v,children:[e("span",{class:"avatars",children:p.map(I=>e(ft,{url:I.avatarStatic,title:`${I.displayName} @${I.username}`,squircle:I==null?void 0:I.bot},I.id))}),e("span",{class:"replies-counts",children:[e("b",{children:e(h,{id:"DOQUen",values:{0:n.length,1:Xe(n.length)},components:{0:e("span",{title:n.length})}})}),!g&&b>1&&e(O,{children:[" ","·"," ",e("span",{children:e(h,{id:"qSQQSe",values:{0:Xe(b),totalComments:b},components:{0:e("span",{title:b})}})})]})]}),e(x,{icon:"chevron-down",class:"replies-summary-chevron"}),!!u&&e(be,{class:"replies-parent-link",to:u.to,onClick:u.onClick,title:l({id:"ZlV82A"}),children:"»"})]}),S&&e("ul",{children:n.map(I=>{var R,L;return e("li",{children:[e("div",{class:"status-focus",tabIndex:0,children:[e(je,{statusID:I.id,instance:i,withinContext:!0,size:"s",enableTranslate:!0,onMediaClick:w,showActionsBar:!0}),!((R=I.replies)!=null&&R.length)&&I.repliesCount>0&&e("div",{class:"replies-link",children:[e(x,{icon:"comment2",alt:l({id:"N8UzTV"})})," ",e("span",{title:I.repliesCount,children:Xe(I.repliesCount)})]})]}),((L=I.replies)==null?void 0:L.length)&&e(uo,{instance:i,replies:I.replies,level:I.level,accWeight:v?f:I.weight,openAll:r,parentLink:{to:i?`/${i}/s/${I.id}`:`/s/${I.id}`,onClick:()=>{Sn(I.id)}}})]},I.id)})})]})}const Wl=140,Xl=35,Jl=70,Ql=140,si=new Map;function nn(n){var p,f;const i=si.get(n.id);if(i)return i;const{spoilerText:s,content:o,mediaAttachments:c,poll:r,card:u}=n,l=xs(s+o),d=c!=null&&c.length?Wl:0,a=(((p=r==null?void 0:r.options)==null?void 0:p.length)||0)*Xl,m=u&&(c!=null&&c.length||(f=r==null?void 0:r.options)!=null&&f.length)?0:Jl,g=(l+d+a+m)/Ql;return si.set(n.id,g),g}const ed=lt(Gl);function td(){const n=Mt(),{id:i,instance:s}=n;return e(ed,{id:i,instance:s})}const nd=""+new URL("boosts-carousel-BiOaNdMT.jpg",import.meta.url).href,id=""+new URL("grouped-notifications-DFgwVVj3.jpg",import.meta.url).href,sd=""+new URL("multi-column-ROck0NVt.jpg",import.meta.url).href,od=""+new URL("multi-hashtag-timeline-DH5INVHi.jpg",import.meta.url).href,cd=""+new URL("nested-comments-thread-hv59kZLc.jpg",import.meta.url).href,ad="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20fill-rule='evenodd'%20stroke-linejoin='round'%20stroke-miterlimit='2'%20clip-rule='evenodd'%20viewBox='0%200%20102%2028'%3e%3cpath%20fill='none'%20d='M0%200h101.5v27.5H0z'/%3e%3cg%20fill-rule='nonzero'%3e%3cpath%20fill='url(%23a)'%20d='M2.32%2021.85c1.4%200%202.21-.85%202.21-2.3v-4.64H8.5c4.45%200%207.54-2.9%207.54-7.24%200-4.35-2.98-7.24-7.32-7.24h-6.4C.93.43.11%201.28.11%202.73v16.82c0%201.45.82%202.3%202.21%202.3Zm2.21-10.4V3.94h3c2.54%200%204%201.34%204%203.75s-1.47%203.76-4%203.76h-3Z'/%3e%3cpath%20fill='url(%23b)'%20d='M20.52%2021.88c1.25%200%202.13-.76%202.13-2.23v-7.04c0-2.07%201.2-3.49%203.21-3.49%201.95%200%202.95%201.23%202.95%203.25v7.28c0%201.47.89%202.23%202.13%202.23%201.26%200%202.14-.76%202.14-2.23v-8.18c0-3.64-1.99-5.9-5.48-5.9-2.38%200-4.1%201.12-4.93%203.1h-.09V2.3c0-1.38-.78-2.2-2.1-2.2-1.31%200-2.1.82-2.1%202.2v17.34c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23c)'%20d='M40.45%2021.82c1.96%200%203.93-.98%204.8-2.65h.1v.8c.08%201.27.89%201.91%202.05%201.91%201.21%200%202.08-.73%202.08-2.15v-8.95c0-3.17-2.63-5.25-6.65-5.25-3.26%200-5.78%201.16-6.5%203.04-.15.32-.23.63-.23.96%200%20.97.75%201.64%201.79%201.64.69%200%201.23-.26%201.7-.79.95-1.23%201.74-1.65%203.04-1.65%201.62%200%202.64.85%202.64%202.31v1.04l-3.95.24c-3.93.23-6.13%201.88-6.13%204.74%200%202.83%202.27%204.76%205.26%204.76Zm1.4-3.09c-1.43%200-2.4-.73-2.4-1.9%200-1.12.91-1.83%202.51-1.95l3.31-.2v1.14c0%201.7-1.54%202.91-3.41%202.91Z'/%3e%3cpath%20fill='url(%23d)'%20d='M54.37%2021.88c1.26%200%202.14-.76%202.14-2.23v-7.09c0-2.03%201.21-3.44%203.13-3.44s2.89%201.17%202.89%203.22v7.31c0%201.47.88%202.23%202.14%202.23%201.24%200%202.13-.76%202.13-2.23v-8.2c0-3.68-1.96-5.87-5.45-5.87-2.41%200-4%201.07-4.83%203.01h-.09v-.87c0-1.35-.85-2.17-2.14-2.17-1.28%200-2.06.82-2.06%202.15v11.95c0%201.47.9%202.23%202.14%202.23Z'/%3e%3cpath%20fill='url(%23e)'%20d='M71.65%2027.17c1.26%200%202.14-.76%202.14-2.23v-6h.09a5.15%205.15%200%200%200%204.88%202.88c3.92%200%206.35-3.05%206.35-8.1%200-5.07-2.44-8.1-6.43-8.1a5.12%205.12%200%200%200-4.86%202.99h-.09v-.85c0-1.45-.88-2.21-2.1-2.21-1.24%200-2.11.76-2.11%202.2v17.2c0%201.46.89%202.22%202.13%202.22Zm5.6-8.8c-2.1%200-3.47-1.8-3.47-4.65%200-2.81%201.37-4.67%203.47-4.67%202.14%200%203.49%201.83%203.49%204.67%200%202.86-1.35%204.66-3.5%204.66Z'/%3e%3cpath%20fill='url(%23f)'%20d='M89.61%2027.39c3.44%200%205.26-1.5%206.73-5.55l4.81-13.1a4%204%200%200%200%20.24-1.26c0-1.13-.85-1.93-2.08-1.93-1.1%200-1.71.51-2.07%201.7l-3.4%2010.9h-.08L90.35%207.28c-.36-1.25-.94-1.73-2.07-1.73-1.26%200-2.21.83-2.21%201.99%200%20.35.09.82.25%201.26l5%2013.21-.21.56c-.52%201.1-1.32%201.42-2.07%201.42l-.75-.01c-.96%200-1.56.54-1.56%201.4%200%201.29%201%202%202.88%202Z'/%3e%3c/g%3e%3cdefs%3e%3cradialGradient%20id='a'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='b'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='c'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='d'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='e'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='f'%20cx='0'%20cy='0'%20r='1'%20gradientTransform='rotate(28.51%20.06%20.22)%20scale(57.6252)'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23a4bff7'/%3e%3cstop%20offset='1'%20stop-color='%236081e6'/%3e%3c/radialGradient%3e%3c/defs%3e%3c/svg%3e",rd={BASE_URL:"./",DEV:!1,MODE:"production",PHANPY_CLIENT_NAME:"Phanpy",PHANPY_GIPHY_API_KEY:"udRxrlYtMZ9MrbaB6rNbjzfI9oGRVMnB",PHANPY_PRIVACY_POLICY_URL:"https://github.com/cheeaun/phanpy/blob/main/PRIVACY.MD",PHANPY_WEBSITE:"https://halo.mookiesplace.com",PROD:!0,SSR:!1,VITE_APP_ENV:"production"},{PHANPY_DEFAULT_INSTANCE:en,PHANPY_WEBSITE:as,PHANPY_PRIVACY_POLICY_URL:ld,PHANPY_DEFAULT_INSTANCE_REGISTRATION_URL:rs}=rd,ls=as?as.replace(/https?:\/\//g,"").replace(/\/$/,""):null,ds=`${"2025-05-03T17:27:52.567Z".slice(0,10).replace(/-/g,".")}.649de8ca`;function ho(){const{_:n}=de();return Qe(null,["/","/welcome"]),e("main",{id:"welcome",children:[e("div",{class:"hero-container",children:[e("div",{class:"hero-content",children:[e("h1",{children:[e("img",{src:bi,alt:"",width:"160",height:"160",style:{aspectRatio:"1/1",marginBlockEnd:-16}}),e("img",{src:ad,alt:"Phanpy",width:"200"})]}),e("p",{class:"desc",children:e(h,{id:"Ogtv0V"})}),e("p",{children:e(be,{to:en?`/login?instance=${en}&submit=1`:"/login",class:"button",children:n(en?{id:"sQia9P"}:{id:"ZLoGls"})})}),en&&rs&&e("p",{children:e("a",{href:rs,class:"button plain5",children:e(h,{id:"e+RpCP"})})}),!en&&e("p",{class:"insignificant",children:e("small",{children:e(h,{id:"fvAsUK",components:{0:e("br",{})}})})})]}),(ls||ds)&&e("p",{class:"app-site-version",children:e("small",{children:[ls," ",ds]})}),e("p",{children:e(h,{id:"BskFI2",components:{0:e("a",{href:"https://github.com/cheeaun/phanpy",target:"_blank"}),1:e("a",{href:"https://mastodon.social/@cheeaun",target:"_blank",onClick:i=>{i.preventDefault(),A.showAccount="cheeaun@mastodon.social"}}),2:e("a",{href:ld,target:"_blank"})}})}),e("div",{children:e(vi,{})})]}),e("div",{id:"why-container",children:e("div",{class:"sections",children:[e("section",{children:[e("img",{src:nd,alt:n({id:"S5cYrQ"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Tu+sCN"})}),e("p",{children:e(h,{id:"e2uVlo"})})]}),e("section",{children:[e("img",{src:cd,alt:n({id:"CGQ27z"}),loading:"lazy"}),e("h4",{children:e(h,{id:"cYE45+"})}),e("p",{children:e(h,{id:"Pc7QKh"})})]}),e("section",{children:[e("img",{src:id,alt:n({id:"rnrM7k"}),loading:"lazy"}),e("h4",{children:e(h,{id:"4RRMre"})}),e("p",{children:e(h,{id:"8GMtDr"})})]}),e("section",{children:[e("img",{src:sd,alt:n({id:"VLKtvP"}),loading:"lazy"}),e("h4",{children:e(h,{id:"pEkad9"})}),e("p",{children:e(h,{id:"t7Py5R"})})]}),e("section",{children:[e("img",{src:od,alt:n({id:"wOax6E"}),loading:"lazy"}),e("h4",{children:e(h,{id:"Wi1Ov0"})}),e("p",{children:e(h,{id:"tS2i+h"})})]})]})})]})}const dd=window.alert;window.__nativeAlert||(window.__nativeAlert=dd);window.alert=function(n){n instanceof Error&&(n!=null&&n.message)&&(n=n.message),typeof n!="string"&&(n=JSON.stringify(n));const i=Wo({text:n,className:"alert",gravity:"top",position:"center",duration:1e4,offset:{y:48},onClick:()=>{i.hideToast()}});i.showToast()};window.__STATES__=A;window.__STATES_STATS__=()=>{const n=["statuses","accounts","spoilers","unfurledLinks","statusQuotes"],i={};n.forEach(c=>{i[c]=Object.keys(A[c]).length});const{statuses:s}=A,o=[];for(const c in s)document.querySelector(`[data-state-post-id~="${c}"], [data-state-post-ids~="${c}"]`)||o.push(c)};setInterval(()=>{if(!window.__IDLE__)return;const{statuses:n,unfurledLinks:i,notifications:s}=A;let o=0;const{instance:c}=re();for(const r in n){if(!window.__IDLE__)break;try{const u=document.querySelector(`[data-state-post-id~="${r}"], [data-state-post-ids~="${r}"]`),l=s.some(d=>{var a;return r===at((a=d.status)==null?void 0:a.id,c)});if(!u&&!l){delete A.statuses[r],delete A.statusQuotes[r];for(const d in i){const a=i[d];if(at(a.id,a.instance)===r){delete A.unfurledLinks[d];break}}o++}}catch{}}},15*60*1e3);setTimeout(()=>{for(const n in Ft)setTimeout(()=>{var i,s,o,c,r,u;Array.isArray(Ft[n])?(s=(i=Ft[n])[0])==null||s.call(i):typeof Ft[n]=="object"?(c=(o=Ft[n]).module)==null||c.call(o):(u=(r=Ft)[n])==null||u.call(r)},1)},5e3);(()=>{window.__IDLE__=!0;const n=["mousemove","mousedown","resize","keydown","touchstart","pointerdown","pointermove","wheel"],i=()=>{window.__IDLE__=!0},o=As(i,3e3),c=()=>{window.__IDLE__=!1,o()};n.forEach(r=>{window.addEventListener(r,c,{passive:!0,capture:!0})}),window.addEventListener("blur",i,{passive:!0}),document.documentElement.addEventListener("mouseleave",r=>{!r.relatedTarget&&!r.toElement&&i()},{passive:!0})})();const ud=/iPad|iPhone|iPod/.test(navigator.userAgent);ud&&document.addEventListener("visibilitychange",()=>{if(document.visibilityState==="visible"){if(document.getElementsByClassName("media-modal-container").length>0)return;const i=ke.local.get("theme");let s;if(i){if(s=document.querySelector('meta[name="theme-color"][data-theme-setting="manual"]'),s){const o=s.content,c=i==="light"?s.dataset.themeLightColorTemp:s.dataset.themeDarkColorTemp;s.content=c||"",setTimeout(()=>{s.content=o},10)}}else{const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(s=document.querySelector(`meta[name="theme-color"][media*="${o}"]`),s){const c=s.dataset.content,r=s.dataset.contentTemp;s.content=r||"",setTimeout(()=>{s.content=c},10)}}}});{const n=ke.local.get("theme");if(n){document.documentElement.classList.add(`is-${n}`),document.querySelector('meta[name="color-scheme"]').setAttribute("content",n||"dark light");const s=document.querySelector('meta[data-theme-setting="manual"]');s&&(s.name="theme-color",s.content=n==="light"?s.dataset.themeLightColor:s.dataset.themeDarkColor),document.querySelectorAll('meta[data-theme-setting="auto"]').forEach(c=>{c.name=""})}const i=ke.local.get("textSize");i&&document.documentElement.style.setProperty("--text-size",`${i}px`)}fs(A,n=>{var i;for(const[s,o,c,r]of n){if(o.join(".")==="settings.shortcutsViewMode"){const u=document.getElementById("app");u&&(u.dataset.shortcutsViewMode=(i=A.shortcuts)!=null&&i.length?c:"")}o.join(".")==="settings.cloakMode"&&document.body.classList.toggle("cloak",c)}});const gn=new Map;window.__BENCH_RESULTS=new Map;window.__BENCHMARK={start(n){},end(n){}};function hd(){const[n,i]=M(!1),[s,o]=M("loading");__BENCHMARK.start("app-init"),__BENCHMARK.start("time-to-following"),__BENCHMARK.start("time-to-home"),__BENCHMARK.start("time-to-isLoggedIn"),de(),ne(()=>{const r=ke.local.get("instanceURL"),u=decodeURIComponent((window.location.search.match(/code=([^&]+)/)||[,""])[1]);if(u){window.history.replaceState({},document.title,window.location.pathname||"/");const l=ke.sessionCookie.get("clientID"),d=ke.sessionCookie.get("clientSecret"),a=ke.sessionCookie.get("vapidKey"),m=ke.sessionCookie.get("codeVerifier");(async()=>{o("loading");const{access_token:b}=await Nl({instanceURL:r,client_id:l,client_secret:d,code:u,code_verifier:m||void 0});if(b){const g=To({instance:r,accessToken:b});await Promise.allSettled([zn(g),Bn(g,r),Ao(g,r,b,a)]),Ti(),window.__IGNORE_GET_ACCOUNT_ERROR__=!0,i(!0),o("default")}else o("error");__BENCHMARK.end("app-init")})()}else{window.__IGNORE_GET_ACCOUNT_ERROR__=!0;const l=decodeURIComponent((window.location.search.match(/account=([^&]+)/)||[,""])[1]);let d;if(l&&(d=Ro(l),d&&(Cn(d.info.id),window.history.replaceState({},document.title,window.location.pathname||"/"))),d||(d=oi()),d){Cn(d.info.id);const{client:a}=re({account:d}),{instance:m}=a;Ti(),o("loading"),(async()=>{try{Eo()&&Mo(m)?(zn(a),Bn(a,m)):await Promise.allSettled([zn(a),Bn(a,m)])}catch{}finally{i(!0),o("default"),__BENCHMARK.end("app-init")}})()}else o("default"),__BENCHMARK.end("app-init")}ke.sessionCookie.del("clientID"),ke.sessionCookie.del("clientSecret"),ke.sessionCookie.del("codeVerifier")},[]);let c=Wt();return A.currentLocation=c.pathname,ne(Jn,[c,n]),/\/https?:/.test(c.pathname)?e(wl,{}):s==="loading"?e(Ue,{id:"loader-root"}):e(O,{children:[e(pd,{isLoggedIn:n}),e(md,{isLoggedIn:n}),e(ai,{children:e(Ke,{path:"/:instance?/s/:id",element:e(td,{})})}),n&&e(tc,{}),n&&e(Ya,{}),e(Oa,{}),n&&e(Fa,{}),e(Qo,{isLoggedIn:n}),e(Ha,{onClose:Jn}),e(nc,{})]})}function fd({isLoggedIn:n}){return n&&__BENCHMARK.end("time-to-isLoggedIn"),n?e(bl,{}):e(ho,{})}const pd=lt(({isLoggedIn:n})=>{const i=Wt(),s=_e(()=>{const{pathname:o}=i;return!/^\/(login|welcome)/i.test(o)},[i]);return e(ai,{location:s||i,children:[e(Ke,{path:"/",element:e(fd,{isLoggedIn:n})}),e(Ke,{path:"/login",element:e(Bl,{})}),e(Ke,{path:"/welcome",element:e(ho,{})})]})});function us(){return A.prevLocation||null}function md({isLoggedIn:n}){const i=Wt(),s=q(us());return _e(()=>sn("/:instance/s/:id",i.pathname)||sn("/s/:id",i.pathname),[i.pathname,sn])?s.current||(s.current=us()):s.current=null,e(ai,{location:s.current||i,children:[n&&e(O,{children:[e(Ke,{path:"/notifications",element:e(so,{})}),e(Ke,{path:"/mentions",element:e(to,{})}),e(Ke,{path:"/following",element:e(_i,{})}),e(Ke,{path:"/b",element:e(Gs,{})}),e(Ke,{path:"/f",element:e(Ks,{})}),e(Ke,{path:"/l",children:[e(Ke,{index:!0,element:e(kl,{})}),e(Ke,{path:":id",element:e(Xs,{})})]}),e(Ke,{path:"/fh",element:e(Dr,{})}),e(Ke,{path:"/sp",element:e(Fl,{})}),e(Ke,{path:"/ft",element:e(Mr,{})}),e(Ke,{path:"/catchup",element:e(yr,{})}),e(Ke,{path:"/annual_report/:year",element:e(ur,{})})]}),e(Ke,{path:"/:instance?/t/:hashtag",element:e(Ws,{})}),e(Ke,{path:"/:instance?/a/:id",element:e(ar,{})}),e(Ke,{path:"/:instance?/p",children:[e(Ke,{index:!0,element:e(ni,{})}),e(Ke,{path:"l",element:e(ni,{local:!0})})]}),e(Ke,{path:"/:instance?/trending",element:e(ao,{})}),e(Ke,{path:"/:instance?/search",element:e(oo,{})})]})}Lo();$o(e(Po,{i18n:pe,children:e(Do,{children:e(hd,{})})}),document.getElementById("app"));setTimeout(()=>{try{Object.keys(localStorage).forEach(n=>{n.startsWith("iconify")&&localStorage.removeItem(n)}),Object.keys(sessionStorage).forEach(n=>{n.startsWith("iconify")&&sessionStorage.removeItem(n)}),localStorage.removeItem("settings:boostsCarousel")}catch{}},5e3);if("serviceWorker"in navigator&&typeof caches<"u"){const i=["icons"];let s=!1;const o=1e4,c=60*60*1e3;async function r(){if(window.__IDLE__)try{const u=await caches.keys();for(const l of u){if(i.includes(l))continue;const d=await caches.open(l),a=await d.keys();if(a.length>50){const m=a.slice(50);for(const b of m)await d.delete(b)}}s=!0}catch{}setTimeout(r,s?c:o)}setTimeout(r,o)}window.__CLOAK__=()=>{document.body.classList.toggle("cloak")};
//# sourceMappingURL=main-BmXPCydF.js.map
