{"version":3,"mappings":";;;;;;8HAYA,MAAMA,EAAUC,EAAK,UAAM,OAAO,uBAAsB,EAAC,6CAErDC,OAAOC,SACTC,QAAUF,OAAOC,OAAOC,SAG1B,SAASC,GAAM,SACb,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAS,SAAS,EAE1C,CAAEC,aAAYC,gBAAeC,eAAgBT,OAAOU,aAAe,GAsBzE,OAnBEH,IACI,wBACAC,EACC,kBACCA,IAAcG,UAAdH,cAAuBI,SAAQJ,IAAcG,UAAdH,cAAuBK,SACvD,GACD,SACN,EAEAC,EAAU,IAAM,CACd,GAAIV,IAAY,SAAU,CACpB,IAEFJ,OAAOC,OAAOc,aACJ,CAAC,CACbf,OAAOgB,MAAM,CACf,GACC,CAACZ,CAAO,CAAC,EAERA,IAAY,SAEZa,EAAA,OAAKC,MAAM,MAAKC,UACdC,EAAA,KAAAD,SAAG,+BAA+B,EAClCC,EAAA,KAAAD,SACEC,EAAA,UACEC,QAASA,IAAM,CACbrB,OAAOgB,MAAM,CACf,EAAEG,SACH,eAEO,EACP,CAAC,EACD,EAITjB,IAA4B,CAE5B,SACGoB,EAAqBxB,EAAA,CAAAqB,aAElBZ,gBACAC,cACAC,cACAc,UAAU,cACVC,WAAkBvB,OAEV,UAAAwB,EAAEA,WAAsB,EAACC,GAAA,GAAE,GAAIA,CACjCD,GACF,OAAe,qCAEfE,IACGtB,EAAA,SACHA,QACW,EACf,GACD,CAGPuB,EAAAR,EAAAjB,EAAA","names":["Compose","lazy","window","opener","console","App","uiState","setUIState","useState","editStatus","replyToStatus","draftStatus","__COMPOSE__","account","acct","username","useEffect","focus","close","_jsxs","class","children","_jsx","onClick","IntlSegmenterSuspense","standalone","hasOpener","newStatus","results","fn","render"],"ignoreList":[],"sources":["../../src/compose.jsx"],"sourcesContent":["import './index.css';\n\nimport './app.css';\n\nimport { render } from 'preact';\nimport { lazy } from 'preact/compat';\nimport { useEffect, useState } from 'preact/hooks';\n\nimport IntlSegmenterSuspense from './components/intl-segmenter-suspense';\n// import Compose from './components/compose';\nimport useTitle from './utils/useTitle';\n\nconst Compose = lazy(() => import('./components/compose'));\n\nif (window.opener) {\n  console = window.opener.console;\n}\n\nfunction App() {\n  const [uiState, setUIState] = useState('default');\n\n  const { editStatus, replyToStatus, draftStatus } = window.__COMPOSE__ || {};\n\n  useTitle(\n    editStatus\n      ? 'Editing source status'\n      : replyToStatus\n      ? `Replying to @${\n          replyToStatus.account?.acct || replyToStatus.account?.username\n        }`\n      : 'Compose',\n  );\n\n  useEffect(() => {\n    if (uiState === 'closed') {\n      try {\n        // Focus parent window\n        window.opener.focus();\n      } catch (e) {}\n      window.close();\n    }\n  }, [uiState]);\n\n  if (uiState === 'closed') {\n    return (\n      <div class=\"box\">\n        <p>You may close this page now.</p>\n        <p>\n          <button\n            onClick={() => {\n              window.close();\n            }}\n          >\n            Close window\n          </button>\n        </p>\n      </div>\n    );\n  }\n\n  console.debug('OPEN COMPOSE');\n\n  return (\n    <IntlSegmenterSuspense>\n      <Compose\n        editStatus={editStatus}\n        replyToStatus={replyToStatus}\n        draftStatus={draftStatus}\n        standalone\n        hasOpener={window.opener}\n        onClose={(results) => {\n          const { newStatus, fn = () => {} } = results || {};\n          try {\n            if (newStatus) {\n              window.opener.__STATES__.reloadStatusPage++;\n            }\n            fn();\n            setUIState('closed');\n          } catch (e) {}\n        }}\n      />\n    </IntlSegmenterSuspense>\n  );\n}\n\nrender(<App />, document.getElementById('app-standalone'));\n"],"file":"assets/compose-EQQIosFw.js"}